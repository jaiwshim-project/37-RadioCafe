<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>라디오카페 | 대한민국 실시간 라디오</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.6.15"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    /* ============================================
       7 RADIO DESIGN THEMES
       ============================================ */

    /* 1. Wood Classic (우드 클래식) */
    :root, [data-theme="wood"] {
      --bg: #1a1a2e;
      --body-out1: #3a2a1a; --body-out2: #2a1c0e;
      --body-in1: #2c1e10; --body-in2: #1e140a;
      --texture-color: rgba(255,200,100,0.015);
      --accent: #d4a862;
      --accent-glow: rgba(212,168,98,0.5);
      --btn-bg1: #3a2a1a; --btn-bg2: #2a1c10;
      --btn-hi1: #4a3a28; --btn-hi2: #2a1c10;
      --btn-active1: #5a4020; --btn-active2: #3a2a1a;
      --btn-border: #1a120a;
      --speaker-bg: #1a120a; --speaker-border: #0e0a06;
      --mesh-color: rgba(200,180,140,0.12);
      --lcd-bg: #0a1a0a;
      --lcd-text: #55ff55; --lcd-dim: #3abf3a; --lcd-idle: #2a8a2a;
      --lcd-glow: rgba(85,255,85,0.6);
      --screw1: #5a4a38; --screw2: #3a2a1a; --screw-line: #1a120a;
      --label-color: #c8b8a0; --freq-mark: #a08868;
      --tick-color: #8a7a60;
      --needle: #ff3333; --needle-glow: rgba(255,51,51,0.6);
      --led-on: #00ff88; --led-glow: rgba(0,255,136,0.3);
      --knob-ind: #d4a862;
      --footer-color: #a09080; --footer-link: #c8b8a0;
      --antenna1: #8a7a6a; --antenna2: #c0b0a0;
      --preset-num: #c8b8a0; --preset-name: #b0a088;
      --power-icon: #c8b8a0;
      --neon-border: #ff9933; --neon-glow: rgba(255,153,51,0.6);
      --neon-light: rgba(255,180,100,0.35); --neon-light-glow: rgba(255,180,100,0.15);
    }

    /* 2. Retro Cream (레트로 크림) */
    [data-theme="cream"] {
      --bg: #d4c5a9;
      --body-out1: #f5e6c8; --body-out2: #e8d5b0;
      --body-in1: #ede0c8; --body-in2: #e2d1b0;
      --texture-color: rgba(180,140,80,0.03);
      --accent: #8b4513;
      --accent-glow: rgba(139,69,19,0.4);
      --btn-bg1: #e8d5b0; --btn-bg2: #d4c09a;
      --btn-hi1: #f0e0c0; --btn-hi2: #d4c09a;
      --btn-active1: #c9a96e; --btn-active2: #b89858;
      --btn-border: #b89858;
      --speaker-bg: #c9a96e; --speaker-border: #a88640;
      --mesh-color: rgba(100,60,20,0.08);
      --lcd-bg: #2a1a0a;
      --lcd-text: #ffcc55; --lcd-dim: #cc8833; --lcd-idle: #aa6600;
      --lcd-glow: rgba(255,204,85,0.6);
      --screw1: #c9a96e; --screw2: #a88640; --screw-line: #8a6a30;
      --label-color: #5a3e20; --freq-mark: #6a4e30;
      --tick-color: #7a5e40;
      --needle: #cc0000; --needle-glow: rgba(204,0,0,0.5);
      --led-on: #ff6600; --led-glow: rgba(255,102,0,0.3);
      --knob-ind: #8b4513;
      --footer-color: #6a4e30; --footer-link: #5a3e20;
      --antenna1: #a88640; --antenna2: #c9a96e;
      --preset-num: #5a3820; --preset-name: #6a4e30;
      --power-icon: #5a3e20;
      --neon-border: #ff6600; --neon-glow: rgba(255,102,0,0.5);
      --neon-light: rgba(255,140,60,0.3); --neon-light-glow: rgba(255,140,60,0.12);
    }

    /* 3. Midnight Black (미드나잇 블랙) */
    [data-theme="black"] {
      --bg: #0a0a0a;
      --body-out1: #222222; --body-out2: #111111;
      --body-in1: #1a1a1a; --body-in2: #0e0e0e;
      --texture-color: rgba(255,255,255,0.008);
      --accent: #ffffff;
      --accent-glow: rgba(255,255,255,0.3);
      --btn-bg1: #1e1e1e; --btn-bg2: #0e0e0e;
      --btn-hi1: #2a2a2a; --btn-hi2: #151515;
      --btn-active1: #333333; --btn-active2: #1a1a1a;
      --btn-border: #080808;
      --speaker-bg: #0a0a0a; --speaker-border: #050505;
      --mesh-color: rgba(255,255,255,0.04);
      --lcd-bg: #000000;
      --lcd-text: #ffffff; --lcd-dim: #999999; --lcd-idle: #666666;
      --lcd-glow: rgba(255,255,255,0.4);
      --screw1: #2a2a2a; --screw2: #1a1a1a; --screw-line: #080808;
      --label-color: #aaaaaa; --freq-mark: #888888;
      --tick-color: #777777;
      --needle: #ff0044; --needle-glow: rgba(255,0,68,0.6);
      --led-on: #ff0044; --led-glow: rgba(255,0,68,0.3);
      --knob-ind: #ffffff;
      --footer-color: #888888; --footer-link: #aaaaaa;
      --antenna1: #444444; --antenna2: #666666;
      --preset-num: #bbbbbb; --preset-name: #999999;
      --power-icon: #aaaaaa;
      --neon-border: #ff0044; --neon-glow: rgba(255,0,68,0.6);
      --neon-light: rgba(255,80,120,0.3); --neon-light-glow: rgba(255,80,120,0.12);
    }

    /* 4. Military (밀리터리) */
    [data-theme="military"] {
      --bg: #1a2016;
      --body-out1: #4a5540; --body-out2: #354030;
      --body-in1: #3d4a34; --body-in2: #2e3828;
      --texture-color: rgba(100,120,80,0.02);
      --accent: #c8b400;
      --accent-glow: rgba(200,180,0,0.4);
      --btn-bg1: #3d4a34; --btn-bg2: #2e3828;
      --btn-hi1: #4a5a40; --btn-hi2: #354530;
      --btn-active1: #556840; --btn-active2: #3d4a34;
      --btn-border: #1e2818;
      --speaker-bg: #222c1e; --speaker-border: #1a2216;
      --mesh-color: rgba(150,170,120,0.08);
      --lcd-bg: #0a120a;
      --lcd-text: #55ff55; --lcd-dim: #33cc33; --lcd-idle: #22aa22;
      --lcd-glow: rgba(85,255,85,0.6);
      --screw1: #5a6a4a; --screw2: #3d4a34; --screw-line: #1e2818;
      --label-color: #b0c090; --freq-mark: #90a870;
      --tick-color: #80986a;
      --needle: #ff3300; --needle-glow: rgba(255,51,0,0.6);
      --led-on: #33ff33; --led-glow: rgba(51,255,51,0.3);
      --knob-ind: #c8b400;
      --footer-color: #90a870; --footer-link: #b0c090;
      --antenna1: #5a6a4a; --antenna2: #8a9a7a;
      --preset-num: #b8d098; --preset-name: #a0b880;
      --power-icon: #b0c090;
      --neon-border: #39ff14; --neon-glow: rgba(57,255,20,0.5);
      --neon-light: rgba(120,255,80,0.3); --neon-light-glow: rgba(120,255,80,0.12);
    }

    /* 5. Chrome Silver (크롬 실버) */
    [data-theme="silver"] {
      --bg: #2a2a3a;
      --body-out1: #c0c0cc; --body-out2: #9a9aaa;
      --body-in1: #b0b0be; --body-in2: #8a8a9a;
      --texture-color: rgba(255,255,255,0.02);
      --accent: #1a1a2a;
      --accent-glow: rgba(26,26,42,0.3);
      --btn-bg1: #a0a0b0; --btn-bg2: #808090;
      --btn-hi1: #b8b8c8; --btn-hi2: #909098;
      --btn-active1: #7070a0; --btn-active2: #5a5a80;
      --btn-border: #6a6a7a;
      --speaker-bg: #5a5a6a; --speaker-border: #4a4a5a;
      --mesh-color: rgba(200,200,220,0.1);
      --lcd-bg: #0a0a1a;
      --lcd-text: #66ccff; --lcd-dim: #4499dd; --lcd-idle: #2277bb;
      --lcd-glow: rgba(102,204,255,0.6);
      --screw1: #c8c8d8; --screw2: #a0a0b0; --screw-line: #6a6a7a;
      --label-color: #b0b0c0; --freq-mark: #9090a0;
      --tick-color: #8888a0;
      --needle: #ff2222; --needle-glow: rgba(255,34,34,0.6);
      --led-on: #44aaff; --led-glow: rgba(68,170,255,0.3);
      --knob-ind: #1a1a2a;
      --footer-color: #9090a0; --footer-link: #b0b0c0;
      --antenna1: #9a9aaa; --antenna2: #d0d0dd;
      --preset-num: #c0c0d0; --preset-name: #a8a8b8;
      --power-icon: #b0b0c0;
      --neon-border: #4488ff; --neon-glow: rgba(68,136,255,0.5);
      --neon-light: rgba(120,170,255,0.3); --neon-light-glow: rgba(120,170,255,0.12);
    }

    /* 6. Neon Cyber (네온 사이버) */
    [data-theme="cyber"] {
      --bg: #05050f;
      --body-out1: #15152a; --body-out2: #0a0a18;
      --body-in1: #101025; --body-in2: #08081a;
      --texture-color: rgba(0,200,255,0.008);
      --accent: #00e5ff;
      --accent-glow: rgba(0,229,255,0.5);
      --btn-bg1: #12122a; --btn-bg2: #0a0a1a;
      --btn-hi1: #1a1a38; --btn-hi2: #0e0e22;
      --btn-active1: #1a1a48; --btn-active2: #101030;
      --btn-border: #0a0a18;
      --speaker-bg: #08081a; --speaker-border: #050510;
      --mesh-color: rgba(0,229,255,0.06);
      --lcd-bg: #020210;
      --lcd-text: #00ffff; --lcd-dim: #00aacc; --lcd-idle: #0088aa;
      --lcd-glow: rgba(0,255,255,0.7);
      --screw1: #1a1a38; --screw2: #101025; --screw-line: #050510;
      --label-color: #00bbdd; --freq-mark: #0099bb;
      --tick-color: #0088aa;
      --needle: #ff00aa; --needle-glow: rgba(255,0,170,0.7);
      --led-on: #ff00aa; --led-glow: rgba(255,0,170,0.4);
      --knob-ind: #00e5ff;
      --footer-color: #0099bb; --footer-link: #00bbdd;
      --antenna1: #006688; --antenna2: #00aacc;
      --preset-num: #00ccee; --preset-name: #00aacc;
      --power-icon: #00bbdd;
      --neon-border: #00e5ff; --neon-glow: rgba(0,229,255,0.6);
      --neon-light: rgba(80,230,255,0.3); --neon-light-glow: rgba(80,230,255,0.12);
    }

    /* 7. Rose Gold (로즈 골드) */
    [data-theme="rose"] {
      --bg: #1a1018;
      --body-out1: #8a6070; --body-out2: #6a4050;
      --body-in1: #7a5565; --body-in2: #5a3545;
      --texture-color: rgba(255,180,200,0.015);
      --accent: #ffc8d0;
      --accent-glow: rgba(255,200,208,0.4);
      --btn-bg1: #6a4858; --btn-bg2: #5a3545;
      --btn-hi1: #7a5565; --btn-hi2: #5a3a4a;
      --btn-active1: #8a5a6a; --btn-active2: #6a4858;
      --btn-border: #3a2030;
      --speaker-bg: #3a2030; --speaker-border: #2a1520;
      --mesh-color: rgba(255,200,208,0.06);
      --lcd-bg: #120810;
      --lcd-text: #ffaacc; --lcd-dim: #cc6699; --lcd-idle: #aa4477;
      --lcd-glow: rgba(255,170,204,0.6);
      --screw1: #8a6878; --screw2: #6a4858; --screw-line: #3a2030;
      --label-color: #d0a8b8; --freq-mark: #bb88a0;
      --tick-color: #aa7890;
      --needle: #ff4488; --needle-glow: rgba(255,68,136,0.6);
      --led-on: #ff88aa; --led-glow: rgba(255,136,170,0.3);
      --knob-ind: #ffc8d0;
      --footer-color: #bb88a0; --footer-link: #d0a8b8;
      --antenna1: #8a6878; --antenna2: #bb99aa;
      --preset-num: #d8b0c0; --preset-name: #c098a8;
      --power-icon: #d0a8b8;
      --neon-border: #ff44aa; --neon-glow: rgba(255,68,170,0.6);
      --neon-light: rgba(255,130,200,0.3); --neon-light-glow: rgba(255,130,200,0.12);
    }

    /* 8. Maltese (말티즈) */
    [data-theme="maltese"] {
      --bg: #f0ebe5;
      --body-out1: #faf8f5; --body-out2: #f0ece6;
      --body-in1: #f8f5f0; --body-in2: #efe8e0;
      --texture-color: rgba(180,160,140,0.02);
      --accent: #8B5E3C;
      --accent-glow: rgba(139,94,60,0.4);
      --btn-bg1: #f0ebe5; --btn-bg2: #e5ddd5;
      --btn-hi1: #f8f4ee; --btn-hi2: #eae2da;
      --btn-active1: #ddd0c0; --btn-active2: #c8b8a5;
      --btn-border: #c8b8a5;
      --speaker-bg: #d8ccc0; --speaker-border: #bfb0a0;
      --mesh-color: rgba(120,90,60,0.06);
      --lcd-bg: #1a120a;
      --lcd-text: #ffdd88; --lcd-dim: #ccaa55; --lcd-idle: #aa8833;
      --lcd-glow: rgba(255,221,136,0.6);
      --screw1: #d8ccc0; --screw2: #bfb0a0; --screw-line: #a09080;
      --label-color: #6a5040; --freq-mark: #7a6050;
      --tick-color: #8a7060;
      --needle: #cc4422; --needle-glow: rgba(204,68,34,0.5);
      --led-on: #8B5E3C; --led-glow: rgba(139,94,60,0.3);
      --knob-ind: #8B5E3C;
      --footer-color: #7a6050; --footer-link: #5a3e20;
      --antenna1: #c0b0a0; --antenna2: #e0d5ca;
      --preset-num: #5a4030; --preset-name: #6a5040;
      --power-icon: #6a5040;
      --neon-border: #DEB887; --neon-glow: rgba(222,184,135,0.5);
      --neon-light: rgba(222,184,135,0.3); --neon-light-glow: rgba(222,184,135,0.12);
    }

    /* ============================================
       MATERIAL TEXTURES per theme
       ============================================ */

    /* 1. Wood - 나무결 (Woodgrain) */
    [data-theme="wood"] .radio-inner::before {
      background:
        /* knot */
        radial-gradient(ellipse 18px 30px at 25% 40%, rgba(180,120,50,0.06) 0%, transparent 70%),
        radial-gradient(ellipse 14px 22px at 72% 65%, rgba(180,120,50,0.05) 0%, transparent 70%),
        /* grain lines */
        repeating-linear-gradient(92deg, transparent, transparent 2px, rgba(255,200,100,0.025) 2px, rgba(255,200,100,0.025) 4px),
        repeating-linear-gradient(88deg, transparent, transparent 5px, rgba(200,150,60,0.018) 5px, rgba(200,150,60,0.018) 7px),
        repeating-linear-gradient(90deg, transparent, transparent 11px, rgba(160,100,30,0.02) 11px, rgba(160,100,30,0.02) 12px);
    }
    [data-theme="wood"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(200,180,140,0.14) 1px, transparent 1px);
      background-size: 6px 6px;
    }
    [data-theme="wood"] .radio {
      border-radius: 24px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.6),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }

    /* 2. Cream - 가죽 (Leather) */
    [data-theme="cream"] .radio-inner::before {
      background:
        /* leather pebble bumps */
        radial-gradient(circle 2px at 30% 30%, rgba(120,70,20,0.06), transparent 50%),
        radial-gradient(circle 3px at 70% 60%, rgba(120,70,20,0.05), transparent 50%),
        radial-gradient(circle 2px at 50% 80%, rgba(120,70,20,0.04), transparent 50%),
        /* pebble pattern */
        radial-gradient(ellipse 4px 3px at 20% 20%, rgba(100,50,10,0.04), transparent 70%),
        radial-gradient(ellipse 3px 4px at 60% 40%, rgba(100,50,10,0.035), transparent 70%),
        radial-gradient(ellipse 4px 3px at 80% 70%, rgba(100,50,10,0.04), transparent 70%),
        radial-gradient(ellipse 3px 4px at 40% 90%, rgba(100,50,10,0.03), transparent 70%),
        /* fine grain */
        repeating-linear-gradient(45deg, transparent, transparent 1px, rgba(80,40,10,0.012) 1px, rgba(80,40,10,0.012) 2px),
        repeating-linear-gradient(-45deg, transparent, transparent 1px, rgba(80,40,10,0.01) 1px, rgba(80,40,10,0.01) 2px);
    }
    [data-theme="cream"] .radio {
      border-radius: 28px;
      box-shadow:
        0 30px 60px rgba(80,50,20,0.3),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    /* Stitching effect */
    [data-theme="cream"] .radio-inner {
      border: 2px solid rgba(139,69,19,0.15);
      outline: 2px dashed rgba(139,69,19,0.12);
      outline-offset: 4px;
    }
    [data-theme="cream"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(100,60,20,0.06) 3px, rgba(100,60,20,0.06) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(100,60,20,0.06) 3px, rgba(100,60,20,0.06) 4px);
      background-size: 4px 4px;
    }

    /* 3. Black - 카본 파이버 (Carbon Fiber) */
    [data-theme="black"] .radio-inner::before {
      background:
        /* carbon weave */
        repeating-linear-gradient(
          45deg,
          transparent, transparent 4px,
          rgba(255,255,255,0.02) 4px, rgba(255,255,255,0.02) 5px
        ),
        repeating-linear-gradient(
          -45deg,
          transparent, transparent 4px,
          rgba(255,255,255,0.015) 4px, rgba(255,255,255,0.015) 5px
        ),
        /* cross-fiber shimmer */
        repeating-linear-gradient(
          45deg,
          rgba(255,255,255,0.01) 0px, transparent 1px,
          transparent 3px, rgba(255,255,255,0.008) 4px
        ),
        repeating-linear-gradient(
          -45deg,
          rgba(255,255,255,0.01) 0px, transparent 1px,
          transparent 3px, rgba(255,255,255,0.008) 4px
        );
      background-size: 8px 8px, 8px 8px, 8px 8px, 8px 8px;
    }
    [data-theme="black"] .radio {
      border-radius: 18px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.8),
        0 0 10px var(--neon-glow),
        0 0 25px var(--neon-glow),
        inset 0 0 10px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.04);
    }
    [data-theme="black"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(255,255,255,0.06) 0.5px, transparent 0.5px);
      background-size: 4px 4px;
    }
    [data-theme="black"] .screw {
      background: linear-gradient(145deg, #333, #111);
      border-color: #080808;
    }
    [data-theme="black"] .screw::after { background: #050505; }

    /* 4. Military - 캔버스 (Canvas Fabric) */
    [data-theme="military"] .radio-inner::before {
      background:
        /* canvas weave horizontal */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 2px,
          rgba(150,170,120,0.025) 2px, rgba(150,170,120,0.025) 3px,
          transparent 3px, transparent 5px
        ),
        /* canvas weave vertical */
        repeating-linear-gradient(
          90deg,
          transparent, transparent 2px,
          rgba(140,160,110,0.02) 2px, rgba(140,160,110,0.02) 3px,
          transparent 3px, transparent 5px
        ),
        /* coarser fabric overlay */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 8px,
          rgba(100,130,70,0.015) 8px, rgba(100,130,70,0.015) 9px
        ),
        repeating-linear-gradient(
          90deg,
          transparent, transparent 8px,
          rgba(100,130,70,0.012) 8px, rgba(100,130,70,0.012) 9px
        );
    }
    [data-theme="military"] .radio {
      border-radius: 12px;
      box-shadow:
        0 25px 50px rgba(0,0,0,0.5),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.05);
    }
    [data-theme="military"] .radio-inner { border-radius: 10px; }
    [data-theme="military"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(150,170,120,0.07) 2px, rgba(150,170,120,0.07) 3px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(150,170,120,0.07) 2px, rgba(150,170,120,0.07) 3px);
      background-size: 5px 5px;
    }
    [data-theme="military"] .speaker-grille { border-radius: 6px; }
    [data-theme="military"] .lcd-display { border-radius: 4px; }
    [data-theme="military"] .preset-btn { border-radius: 4px; }

    /* 5. Silver - 브러시드 메탈 (Brushed Aluminum) */
    [data-theme="silver"] .radio-inner::before {
      background:
        /* fine brush strokes horizontal */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 1px,
          rgba(255,255,255,0.015) 1px, rgba(255,255,255,0.015) 2px
        ),
        /* slightly thicker brush strokes */
        repeating-linear-gradient(
          2deg,
          transparent, transparent 3px,
          rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 4px
        ),
        /* highlight sheen */
        linear-gradient(
          180deg,
          rgba(255,255,255,0.06) 0%,
          transparent 15%,
          transparent 60%,
          rgba(255,255,255,0.03) 100%
        ),
        /* subtle color variation */
        radial-gradient(ellipse at 30% 0%, rgba(255,255,255,0.04), transparent 50%);
    }
    [data-theme="silver"] .radio {
      border-radius: 20px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.4),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    [data-theme="silver"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.15);
    }
    [data-theme="silver"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(200,200,220,0.12) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="silver"] .knob {
      background: linear-gradient(145deg, #c0c0d0, #808090) !important;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.2), inset 0 -2px 4px rgba(0,0,0,0.2);
    }

    /* 6. Cyber - 회로기판 (Circuit Board) */
    [data-theme="cyber"] .radio-inner::before {
      background:
        /* circuit grid */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 19px,
          rgba(0,229,255,0.03) 19px, rgba(0,229,255,0.03) 20px
        ),
        repeating-linear-gradient(
          90deg,
          transparent, transparent 19px,
          rgba(0,229,255,0.03) 19px, rgba(0,229,255,0.03) 20px
        ),
        /* circuit traces */
        linear-gradient(0deg, transparent 48%, rgba(0,229,255,0.015) 49%, rgba(0,229,255,0.015) 51%, transparent 52%),
        linear-gradient(90deg, transparent 28%, rgba(0,229,255,0.01) 29%, rgba(0,229,255,0.01) 31%, transparent 32%),
        linear-gradient(90deg, transparent 68%, rgba(0,229,255,0.012) 69%, rgba(0,229,255,0.012) 71%, transparent 72%),
        /* solder point dots */
        radial-gradient(circle 1px at 20px 20px, rgba(0,229,255,0.04), transparent 2px),
        radial-gradient(circle 1px at 40px 40px, rgba(0,229,255,0.03), transparent 2px);
      background-size: 20px 20px, 20px 20px, 100% 100%, 100% 100%, 100% 100%, 60px 60px, 60px 60px;
    }
    [data-theme="cyber"] .radio {
      border-radius: 16px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.7),
        0 0 12px var(--neon-glow),
        0 0 30px var(--neon-glow),
        0 0 60px rgba(0,229,255,0.15),
        inset 0 0 12px var(--neon-glow);
    }
    [data-theme="cyber"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,229,255,0.04) 3px, rgba(0,229,255,0.04) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(0,229,255,0.04) 3px, rgba(0,229,255,0.04) 4px);
      background-size: 4px 4px;
    }
    [data-theme="cyber"] .speaker-grille {
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.6), 0 0 8px rgba(0,229,255,0.08);
    }
    /* Neon border glow */
    [data-theme="cyber"] .radio-inner::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      border-radius: inherit;
      border: 1px solid rgba(0,229,255,0.06);
      pointer-events: none;
      z-index: 0;
    }

    /* 7. Rose - 대리석 (Marble) */
    [data-theme="rose"] .radio-inner::before {
      background:
        /* marble veins - primary */
        linear-gradient(
          137deg,
          transparent 20%,
          rgba(255,220,230,0.04) 22%, rgba(255,220,230,0.04) 23%,
          transparent 25%,
          transparent 45%,
          rgba(255,200,210,0.035) 47%, rgba(255,200,210,0.035) 48%,
          transparent 50%,
          transparent 70%,
          rgba(255,210,220,0.03) 72%, rgba(255,210,220,0.03) 73%,
          transparent 75%
        ),
        /* marble veins - secondary */
        linear-gradient(
          52deg,
          transparent 10%,
          rgba(255,180,200,0.025) 12%, rgba(255,180,200,0.025) 13%,
          transparent 15%,
          transparent 35%,
          rgba(255,190,210,0.03) 37%, rgba(255,190,210,0.03) 38%,
          transparent 40%,
          transparent 55%,
          rgba(255,200,220,0.02) 57%, rgba(255,200,220,0.02) 58%,
          transparent 60%,
          transparent 80%,
          rgba(255,180,200,0.025) 82%, rgba(255,180,200,0.025) 83%,
          transparent 85%
        ),
        /* fine veins */
        linear-gradient(
          165deg,
          transparent 30%,
          rgba(255,220,230,0.02) 31%, rgba(255,220,230,0.02) 31.5%,
          transparent 32%,
          transparent 60%,
          rgba(255,220,230,0.018) 61%, rgba(255,220,230,0.018) 61.5%,
          transparent 62%
        ),
        /* polished sheen */
        radial-gradient(ellipse at 30% 20%, rgba(255,255,255,0.04), transparent 50%),
        radial-gradient(ellipse at 70% 80%, rgba(255,255,255,0.03), transparent 40%);
    }
    [data-theme="rose"] .radio {
      border-radius: 26px;
      box-shadow:
        0 30px 60px rgba(40,10,20,0.5),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.12);
    }
    /* Polished marble sheen overlay */
    [data-theme="rose"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }
    [data-theme="rose"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(255,200,208,0.08) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="rose"] .speaker-grille {
      border-radius: 16px;
    }

    /* 8. Maltese - 부드러운 털 결 (Soft Fur Texture) */
    [data-theme="maltese"] .radio-inner::before {
      background:
        /* soft wavy fur lines */
        repeating-linear-gradient(
          170deg,
          transparent, transparent 4px,
          rgba(200,180,160,0.025) 4px, rgba(200,180,160,0.025) 5px
        ),
        repeating-linear-gradient(
          175deg,
          transparent, transparent 6px,
          rgba(220,200,180,0.02) 6px, rgba(220,200,180,0.02) 7px
        ),
        repeating-linear-gradient(
          168deg,
          transparent, transparent 8px,
          rgba(180,160,140,0.018) 8px, rgba(180,160,140,0.018) 9px
        ),
        /* fluffy dot highlights */
        radial-gradient(circle 2px at 10px 12px, rgba(255,255,255,0.04), transparent 3px),
        radial-gradient(circle 2px at 30px 25px, rgba(255,255,255,0.03), transparent 3px),
        radial-gradient(circle 2px at 50px 8px, rgba(255,255,255,0.035), transparent 3px);
      background-size: 10px 10px, 14px 14px, 18px 18px, 60px 40px, 60px 40px, 60px 40px;
    }
    [data-theme="maltese"] .radio {
      border-radius: 30px;
      box-shadow:
        0 30px 60px rgba(80,60,40,0.2),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.5);
    }
    [data-theme="maltese"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
    }
    [data-theme="maltese"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(139,94,60,0.05) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="maltese"] .speaker-grille {
      border-radius: 20px;
    }
    [data-theme="maltese"] .screw {
      background: linear-gradient(145deg, #e8ddd0, #c8b8a5);
      border-color: #b0a090;
    }
    /* Maltese face silhouette background */
    [data-theme="maltese"] .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cg fill='none' stroke='rgba(139,94,60,0.05)' stroke-width='1.5'%3E%3C!-- fluffy head outline --%3E%3Cpath d='M60 95 Q50 70 60 55 Q70 40 85 45 Q95 35 105 35 Q115 35 125 45 Q140 40 150 55 Q160 70 150 95' fill='rgba(139,94,60,0.02)'/%3E%3C!-- face --%3E%3Cellipse cx='105' cy='110' rx='42' ry='38' fill='rgba(139,94,60,0.015)'/%3E%3C!-- fluffy cheeks --%3E%3Cpath d='M63 100 Q50 110 55 125 Q60 135 75 130' stroke='rgba(139,94,60,0.04)' fill='rgba(139,94,60,0.015)'/%3E%3Cpath d='M147 100 Q160 110 155 125 Q150 135 135 130' stroke='rgba(139,94,60,0.04)' fill='rgba(139,94,60,0.015)'/%3E%3C!-- floppy ears --%3E%3Cpath d='M65 85 Q40 90 35 115 Q32 140 50 155 Q60 145 68 125' fill='rgba(139,94,60,0.025)' stroke='rgba(139,94,60,0.04)'/%3E%3Cpath d='M145 85 Q170 90 175 115 Q178 140 160 155 Q150 145 142 125' fill='rgba(139,94,60,0.025)' stroke='rgba(139,94,60,0.04)'/%3E%3C!-- eyes --%3E%3Ccircle cx='88' cy='105' r='6' fill='rgba(60,35,15,0.06)'/%3E%3Ccircle cx='122' cy='105' r='6' fill='rgba(60,35,15,0.06)'/%3E%3C!-- eye highlights --%3E%3Ccircle cx='90' cy='103' r='2.5' fill='rgba(255,255,255,0.04)'/%3E%3Ccircle cx='124' cy='103' r='2.5' fill='rgba(255,255,255,0.04)'/%3E%3C!-- nose --%3E%3Cellipse cx='105' cy='118' rx='6' ry='5' fill='rgba(60,35,15,0.06)'/%3E%3C!-- nose highlight --%3E%3Cellipse cx='104' cy='116' rx='2' ry='1.5' fill='rgba(255,255,255,0.03)'/%3E%3C!-- mouth --%3E%3Cpath d='M105 123 Q100 130 93 127' stroke='rgba(139,94,60,0.04)'/%3E%3Cpath d='M105 123 Q110 130 117 127' stroke='rgba(139,94,60,0.04)'/%3E%3C!-- tongue --%3E%3Cellipse cx='105' cy='132' rx='5' ry='6' fill='rgba(255,120,120,0.04)' stroke='rgba(200,80,80,0.04)'/%3E%3C!-- fluffy body tuft --%3E%3Cpath d='M75 145 Q80 160 90 168 Q100 172 110 172 Q120 168 130 160 Q135 145 130 140' stroke='rgba(139,94,60,0.03)' fill='rgba(139,94,60,0.01)'/%3E%3C!-- fur texture lines --%3E%3Cpath d='M70 60 Q68 50 72 48' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M90 42 Q92 34 95 36' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M115 38 Q118 30 120 34' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M140 55 Q143 47 140 45' stroke='rgba(139,94,60,0.03)'/%3E%3C/g%3E%3C/svg%3E") no-repeat center center,
        radial-gradient(ellipse at 50% 0%, rgba(255,255,255,0.05) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.08) 100%);
      background-size: 65% auto, 100% 100%, 100% 100%;
      pointer-events: none; z-index: 0; border-radius: inherit;
    }

    /* ============================================
       TEXT READABILITY & VIVID COLORS
       ============================================ */
    :root, [data-theme="wood"] {
      --label-color: #e8d0a8; --freq-mark: #d4b888; --tick-color: #b89868;
      --preset-num: #f0d898; --preset-name: #d8c090;
      --footer-color: #c8b088; --footer-link: #e8c880;
      --power-icon: #e8d0a8;
      --lcd-text: #55ff55; --lcd-dim: #44dd44; --lcd-idle: #33bb33;
      --lcd-glow: rgba(85,255,85,0.7);
    }
    [data-theme="cream"] {
      --label-color: #5a3518; --freq-mark: #704828; --tick-color: #8a5830;
      --preset-num: #4a2810; --preset-name: #5a3818;
      --footer-color: #704828; --footer-link: #4a2810;
      --power-icon: #5a3518;
      --lcd-text: #ffcc55; --lcd-dim: #ddaa33; --lcd-idle: #bb8800;
      --lcd-glow: rgba(255,204,85,0.7);
    }
    [data-theme="black"] {
      --label-color: #cccccc; --freq-mark: #aaaaaa; --tick-color: #888888;
      --preset-num: #dddddd; --preset-name: #bbbbbb;
      --footer-color: #999999; --footer-link: #cccccc;
      --power-icon: #cccccc;
      --lcd-text: #ffffff; --lcd-dim: #bbbbbb; --lcd-idle: #888888;
      --lcd-glow: rgba(255,255,255,0.5);
    }
    [data-theme="military"] {
      --label-color: #c8e098; --freq-mark: #a8c878; --tick-color: #88aa58;
      --preset-num: #d8ee98; --preset-name: #b8d080;
      --footer-color: #a8c878; --footer-link: #c8e098;
      --power-icon: #c8e098;
      --lcd-text: #55ff55; --lcd-dim: #44dd44; --lcd-idle: #33bb33;
      --lcd-glow: rgba(85,255,85,0.7);
    }
    [data-theme="silver"] {
      --label-color: #222238; --freq-mark: #333348; --tick-color: #444458;
      --preset-num: #1a1a30; --preset-name: #333348;
      --footer-color: #444458; --footer-link: #222238;
      --power-icon: #222238;
      --lcd-text: #77ddff; --lcd-dim: #55bbdd; --lcd-idle: #3399bb;
      --lcd-glow: rgba(119,221,255,0.7);
    }
    [data-theme="cyber"] {
      --label-color: #00ddff; --freq-mark: #00bbdd; --tick-color: #0099bb;
      --preset-num: #00eeff; --preset-name: #00ccee;
      --footer-color: #00bbdd; --footer-link: #00eeff;
      --power-icon: #00ddff;
      --lcd-text: #00ffff; --lcd-dim: #00ddee; --lcd-idle: #00bbcc;
      --lcd-glow: rgba(0,255,255,0.8);
    }
    [data-theme="rose"] {
      --label-color: #eec0d0; --freq-mark: #dda8b8; --tick-color: #cc90a0;
      --preset-num: #ffd0dd; --preset-name: #eec0d0;
      --footer-color: #dda8b8; --footer-link: #ffd0dd;
      --power-icon: #eec0d0;
      --lcd-text: #ffbbdd; --lcd-dim: #dd88aa; --lcd-idle: #cc6699;
      --lcd-glow: rgba(255,187,221,0.7);
    }
    [data-theme="maltese"] {
      --label-color: #5a4030; --freq-mark: #6a5040; --tick-color: #7a6050;
      --preset-num: #4a3020; --preset-name: #5a4030;
      --footer-color: #6a5040; --footer-link: #4a3020;
      --power-icon: #5a4030;
      --lcd-text: #ffdd88; --lcd-dim: #ddbb55; --lcd-idle: #ccaa44;
      --lcd-glow: rgba(255,221,136,0.7);
    }

    /* ============================================
       CORE STYLES (using CSS variables)
       ============================================ */
    body {
      background: var(--bg);
      min-height: 100vh;
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      justify-content: safe center;
      align-items: center;
      font-family: 'Inter', sans-serif;
      padding: 20px;
      overflow-y: auto;
      transition: background 0.6s ease;
    }

    /* === THEME SWITCHER === */
    .theme-switcher {
      display: flex;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(0,0,0,0.2);
      border-radius: 20px 20px 0 0;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.04);
      justify-content: center;
    }

    .theme-dot {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.15);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .theme-dot:hover { transform: scale(1.2); }
    .theme-dot.active {
      border-color: #fff;
      transform: scale(1.15);
      box-shadow: 0 2px 12px rgba(255,255,255,0.2);
    }
    .theme-dot.active::after {
      content: '';
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 8px; height: 8px;
      background: #fff;
      border-radius: 50%;
    }

    .theme-dot[data-t="wood"]     { background: linear-gradient(135deg, #3a2a1a, #d4a862); }
    .theme-dot[data-t="cream"]    { background: linear-gradient(135deg, #f5e6c8, #8b4513); }
    .theme-dot[data-t="black"]    { background: linear-gradient(135deg, #222, #000); }
    .theme-dot[data-t="military"] { background: linear-gradient(135deg, #4a5540, #c8b400); }
    .theme-dot[data-t="silver"]   { background: linear-gradient(135deg, #c0c0cc, #5a5a6a); }
    .theme-dot[data-t="cyber"]    { background: linear-gradient(135deg, #101025, #00e5ff); }
    .theme-dot[data-t="rose"]     { background: linear-gradient(135deg, #8a6070, #ffc8d0); }
    .theme-dot[data-t="maltese"]  { background: linear-gradient(135deg, #faf8f5, #DEB887); }

    .theme-name {
      font-size: 10px;
      color: rgba(255,255,255,0.6);
      text-align: center;
      margin-bottom: 4px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      font-family: 'Outfit', sans-serif;
      transition: color 0.3s;
      text-shadow: 0 1px 4px rgba(0,0,0,0.5);
    }

    /* === RADIO BODY === */
    .radio {
      width: 100%;
      max-width: 480px;
      background: linear-gradient(145deg, var(--body-out1), var(--body-out2));
      border-radius: 24px;
      padding: 0;
      border: 2px solid var(--neon-border);
      box-shadow:
        0 30px 60px rgba(0,0,0,0.6),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.08);
      position: relative;
      transition: all 0.6s ease;
      overflow: hidden;
    }

    .radio-inner {
      background: linear-gradient(180deg, var(--body-in1), var(--body-in2));
      border-radius: 0;
      padding: 20px 20px 16px;
      position: relative;
      overflow: hidden;
      transition: all 0.6s ease;
    }
    .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 50% 0%, rgba(255,255,255,0.04) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.15) 100%);
      pointer-events: none; z-index: 0;
      border-radius: inherit;
    }

    .radio-inner::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(
        90deg, transparent, transparent 3px,
        var(--texture-color) 3px, var(--texture-color) 6px
      );
      pointer-events: none;
    }

    /* === BRAND & POWER === */
    .radio-top {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 16px; position: relative; z-index: 1;
    }
    .brand {
      font-family: 'Outfit', sans-serif; font-size: 22px; font-weight: 800;
      color: var(--accent); letter-spacing: 3px;
      text-shadow: 0 -1px 0 rgba(0,0,0,0.6), 0 1px 0 rgba(255,255,255,0.08), 0 2px 4px rgba(0,0,0,0.4);
      transition: color 0.6s;
    }
    /* Brand Mascots - hidden by default */
    .brand-mascot {
      display: none;
      flex-shrink: 0;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      transition: all 0.4s ease;
    }
    img.brand-mascot {
      width: 34px; height: 34px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      margin-left: 3px;
    }
    .ctrl-mascot {
      display: none;
      width: 48px; height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      flex-shrink: 0;
      align-self: center;
    }

    .radio-top::after {
      content: ''; display: block; position: absolute; bottom: 0; left: 0; right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.06) 20%, rgba(255,255,255,0.06) 80%, transparent);
    }
    .power-area { display: flex; align-items: center; gap: 10px; }
    .power-led {
      width: 8px; height: 8px; border-radius: 50%;
      background: #333; border: 1px solid #111;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.5);
      transition: all 0.5s ease;
    }
    .power-led.on {
      background: var(--led-on);
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.3), 0 0 8px var(--led-on), 0 0 20px var(--led-glow);
      animation: ledPulse 2.5s ease-in-out infinite;
    }
    @keyframes ledPulse {
      0%,100%{box-shadow: inset 0 1px 2px rgba(0,0,0,0.3), 0 0 8px var(--led-on), 0 0 20px var(--led-glow);}
      50%{box-shadow: inset 0 1px 2px rgba(0,0,0,0.3), 0 0 12px var(--led-on), 0 0 30px var(--led-glow);}
    }
    .power-btn {
      width: 36px; height: 36px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--power-icon);
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow), inset 0 1px 0 rgba(255,255,255,0.08);
      transition: all 0.15s ease;
    }
    .power-btn:active {
      transform: scale(0.92);
      box-shadow: 0 1px 3px rgba(0,0,0,0.4), inset 0 1px 3px rgba(0,0,0,0.3);
    }

    /* === ANTENNA === */
    .antenna {
      position: absolute; top: -40px; right: 50px;
      width: 3px; height: 44px;
      background: linear-gradient(to top, var(--antenna1), var(--antenna2), var(--antenna1));
      border-radius: 2px; transform-origin: bottom center;
      transition: transform 0.5s ease, background 0.6s;
    }
    .antenna::after {
      content: ''; position: absolute; top: -4px; left: -2px;
      width: 7px; height: 7px;
      background: radial-gradient(circle, #ddd, #999);
      border-radius: 50%;
    }
    .antenna.active { transform: rotate(-15deg); }

    /* === SPEAKER GRILLE === */
    .speaker-grille {
      background: var(--speaker-bg); border-radius: 14px; padding: 16px;
      margin-bottom: 16px; border: 1px solid var(--neon-light);
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.6), inset 0 -2px 6px rgba(0,0,0,0.3), 0 0 6px var(--neon-light-glow), 0 1px 0 rgba(255,255,255,0.04);
      position: relative; z-index: 1; overflow: hidden;
      transition: all 0.6s;
    }
    .speaker-label {
      position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
      font-family: 'Orbitron', monospace; font-size: 6px; letter-spacing: 4px;
      color: var(--mesh-color); text-transform: uppercase; z-index: 2;
      opacity: 0.7; pointer-events: none;
    }
    .speaker-mesh {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.12) 2px, rgba(0,0,0,0.12) 3px),
        radial-gradient(circle, var(--mesh-color) 1px, transparent 1px);
      background-size: 100% 5px, 6px 6px;
      pointer-events: none;
    }
    .eq-container {
      display: flex; align-items: flex-end; justify-content: center;
      gap: 3px; height: 50px; position: relative; z-index: 1;
    }
    .eq-bar {
      width: 5px; height: 6px; background: var(--accent);
      border-radius: 2px; transition: height 0.15s ease, background 0.6s; opacity: 0.3;
    }
    .eq-bar.playing {
      opacity: 1; animation: eqBounce 0.6s ease-in-out infinite alternate;
      box-shadow: 0 0 6px var(--accent-glow);
    }
    @keyframes eqBounce { 0%{height:6px} 50%{height:40px} 100%{height:12px} }
    .eq-bar:nth-child(1).playing{animation-duration:.52s;animation-delay:0s}
    .eq-bar:nth-child(2).playing{animation-duration:.63s;animation-delay:.08s}
    .eq-bar:nth-child(3).playing{animation-duration:.48s;animation-delay:.03s}
    .eq-bar:nth-child(4).playing{animation-duration:.57s;animation-delay:.12s}
    .eq-bar:nth-child(5).playing{animation-duration:.65s;animation-delay:.05s}
    .eq-bar:nth-child(6).playing{animation-duration:.5s;animation-delay:.1s}
    .eq-bar:nth-child(7).playing{animation-duration:.6s;animation-delay:.02s}
    .eq-bar:nth-child(8).playing{animation-duration:.53s;animation-delay:.14s}
    .eq-bar:nth-child(9).playing{animation-duration:.62s;animation-delay:.07s}
    .eq-bar:nth-child(10).playing{animation-duration:.47s;animation-delay:.11s}
    .eq-bar:nth-child(11).playing{animation-duration:.58s;animation-delay:.04s}
    .eq-bar:nth-child(12).playing{animation-duration:.55s;animation-delay:.09s}
    .eq-bar:nth-child(13).playing{animation-duration:.61s;animation-delay:.01s}
    .eq-bar:nth-child(14).playing{animation-duration:.49s;animation-delay:.13s}
    .eq-bar:nth-child(15).playing{animation-duration:.56s;animation-delay:.06s}
    .eq-bar:nth-child(16).playing{animation-duration:.64s;animation-delay:.08s}

    /* === LCD DISPLAY === */
    .lcd-display {
      background: var(--lcd-bg); border-radius: 10px; padding: 14px 18px;
      margin-bottom: 16px;
      border: 1px solid var(--neon-light);
      box-shadow: inset 0 3px 10px rgba(0,0,0,0.8), inset 0 0 20px rgba(0,0,0,0.4), 0 0 6px var(--neon-light-glow), 0 1px 0 rgba(255,255,255,0.06);
      position: relative; z-index: 1; min-height: 90px;
      display: flex; flex-direction: column; justify-content: center;
      transition: all 0.6s;
    }
    .lcd-display::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, transparent 30%, transparent 80%, rgba(0,0,0,0.1) 100%);
      pointer-events: none; border-radius: 7px; z-index: 2;
    }
    .lcd-display::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(0,0,0,0.08) 1px, rgba(0,0,0,0.08) 2px);
      pointer-events: none; border-radius: 7px;
    }
    .on-air-dot {
      display: inline-block; width: 6px; height: 6px; border-radius: 50%;
      background: #ff3333; margin-right: 6px; vertical-align: middle;
      animation: onAirPulse 1s ease-in-out infinite;
      box-shadow: 0 0 4px #ff3333, 0 0 8px rgba(255,51,51,0.4);
    }
    @keyframes onAirPulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
    .lcd-idle {
      text-align: center; color: var(--lcd-idle);
      font-family: 'Orbitron', monospace; font-size: 14px;
      letter-spacing: 2px; position: relative; z-index: 1;
      transition: color 0.6s;
      text-shadow: 0 0 8px var(--lcd-glow);
    }
    .lcd-active { position: relative; z-index: 1; display: none; }
    .lcd-active.visible { display: block; }
    .lcd-idle.hidden { display: none; }
    .lcd-provider {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: var(--lcd-dim); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 4px; transition: color 0.6s;
    }
    .lcd-name {
      font-family: 'Orbitron', monospace; font-size: 16px; font-weight: 700;
      color: var(--lcd-text); text-shadow: 0 0 10px var(--lcd-glow);
      margin-bottom: 2px; white-space: nowrap; overflow: hidden; transition: color 0.6s;
    }
    .lcd-freq {
      font-family: 'Orbitron', monospace; font-size: 26px; font-weight: 900;
      color: var(--lcd-text); text-shadow: 0 0 15px var(--lcd-glow);
      letter-spacing: 2px; transition: color 0.6s;
    }
    .lcd-status {
      font-family: 'Orbitron', monospace; font-size: 8px;
      color: var(--lcd-dim); letter-spacing: 2px; margin-top: 4px;
      display: flex; justify-content: space-between; align-items: center;
      transition: color 0.6s;
    }
    .lcd-signal { display: flex; gap: 2px; align-items: flex-end; }
    .lcd-signal-bar {
      width: 3px; background: var(--lcd-dim);
      border-radius: 1px; transition: all 0.5s ease;
    }
    .lcd-signal-bar.active { background: var(--lcd-text); }

    /* === TUNING DIAL === */
    .tuning-section {
      background: linear-gradient(180deg, rgba(0,0,0,0.3), rgba(0,0,0,0.1));
      border-radius: 10px; padding: 12px 16px; margin-bottom: 16px;
      border: 1px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      position: relative; z-index: 1;
    }
    .tuning-label {
      font-size: 8px; color: var(--label-color); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 8px; font-weight: 600;
      transition: color 0.6s;
    }
    .freq-band {
      position: relative; height: 28px; background: var(--speaker-bg);
      border-radius: 4px; overflow: hidden;
      border: 1px solid var(--speaker-border);
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.5);
      transition: all 0.6s;
    }
    .freq-band::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 40%;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), transparent);
      pointer-events: none; z-index: 1;
    }
    .freq-ticks {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
    }
    .freq-tick {
      position: absolute; bottom: 0; width: 1px; background: var(--tick-color); opacity: 0.4;
    }
    .freq-tick.major { height: 10px; opacity: 0.7; }
    .freq-tick.minor { height: 5px; }
    .freq-marks {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      display: flex; justify-content: space-between; align-items: center; padding: 0 8px;
    }
    .freq-mark {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--freq-mark); position: relative; transition: color 0.6s;
    }
    .freq-mark::before {
      content: ''; position: absolute; top: -8px; left: 50%;
      width: 1px; height: 5px; background: var(--tick-color);
    }
    .tuning-needle {
      position: absolute; top: 2px; width: 2px; height: 24px;
      background: var(--needle); box-shadow: 0 0 6px var(--needle-glow), 0 0 12px var(--needle-glow);
      border-radius: 1px; left: 20%;
      transition: left 0.6s cubic-bezier(0.34,1.56,0.64,1), background 0.6s;
      z-index: 2;
    }
    .tuning-needle::after {
      content: ''; position: absolute; top: -2px; left: -2px;
      width: 6px; height: 6px; border-radius: 50%;
      background: var(--needle); box-shadow: 0 0 4px var(--needle-glow);
    }

    /* === PRESET BUTTONS === */
    .preset-section { margin-bottom: 16px; position: relative; z-index: 1; }
    .preset-label {
      font-size: 8px; color: var(--label-color); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 8px; font-weight: 600;
      transition: color 0.6s;
    }
    .preset-scroll {
      overflow-y: auto; overflow-x: hidden;
      max-height: 200px;
      scrollbar-width: thin;
      scrollbar-color: var(--btn-border) transparent;
      padding-right: 2px;
    }
    .preset-scroll::-webkit-scrollbar { width: 3px; }
    .preset-scroll::-webkit-scrollbar-track { background: transparent; }
    .preset-scroll::-webkit-scrollbar-thumb { background: var(--btn-border); border-radius: 2px; }
    .preset-buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 5px;
    }
    .preset-btn {
      background: linear-gradient(180deg, var(--btn-bg1), var(--btn-bg2));
      border: 1px solid var(--neon-light); border-radius: 8px;
      padding: 8px 6px; cursor: pointer; text-align: center;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3), 0 0 4px var(--neon-light-glow), inset 0 1px 0 rgba(255,255,255,0.06);
      transition: all 0.15s ease;
    }
    .preset-btn:active {
      transform: translateY(2px);
      box-shadow: 0 1px 2px rgba(0,0,0,0.3), inset 0 1px 3px rgba(0,0,0,0.3);
    }
    .preset-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .preset-btn.active {
      background: linear-gradient(180deg, var(--btn-active1), var(--btn-active2));
      border-color: var(--accent);
      box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 12px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);
      animation: presetPulse 2s ease-in-out infinite;
    }
    @keyframes presetPulse {
      0%,100%{box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 12px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);}
      50%{box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 20px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);}
    }
    .preset-btn.active .preset-num { color: var(--accent); }
    .preset-btn.active .preset-name { color: var(--accent); }
    .preset-num {
      font-family: 'Orbitron', monospace; font-size: 10px; font-weight: 700;
      color: var(--preset-num); display: block; margin-bottom: 1px; transition: color 0.3s;
    }
    .preset-name {
      font-size: 7px; font-weight: 600; color: var(--preset-name);
      letter-spacing: 0.3px; white-space: nowrap; overflow: hidden;
      text-overflow: ellipsis; transition: color 0.6s;
    }

    /* === CONTROL PANEL === */
    .control-panel {
      display: flex; align-items: center; justify-content: space-between;
      gap: 16px; position: relative; z-index: 1;
    }
    .knob-area { display: flex; flex-direction: column; align-items: center; gap: 4px; }
    .knob-label {
      font-size: 7px; color: var(--preset-num); letter-spacing: 2px;
      text-transform: uppercase; font-weight: 600; transition: color 0.6s;
    }
    .knob-container { position: relative; width: 56px; height: 56px; }
    .knob-marks { position: absolute; top: 0; left: 0; right: 0; bottom: 0; }
    .knob-tick {
      position: absolute; width: 1px; height: 5px;
      background: var(--tick-color); top: 2px; left: 50%;
      transform-origin: 0 26px; transition: background 0.6s;
    }
    .knob {
      width: 48px; height: 48px; border-radius: 50%;
      background:
        repeating-conic-gradient(from 0deg, rgba(255,255,255,0.03) 0deg 6deg, transparent 6deg 12deg),
        linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light);
      box-shadow: 0 4px 8px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow), inset 0 2px 0 rgba(255,255,255,0.06), inset 0 -2px 4px rgba(0,0,0,0.3);
      position: absolute; top: 4px; left: 4px;
      cursor: pointer; transition: transform 0.1s ease;
    }
    .knob-indicator {
      position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
      width: 2px; height: 10px; background: var(--knob-ind);
      border-radius: 1px; transition: background 0.6s;
    }

    /* Play Button */
    .play-btn-container { display: flex; flex-direction: column; align-items: center; gap: 6px; }
    .play-btn {
      width: 64px; height: 64px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-active1), var(--btn-bg2));
      border: 2px solid var(--neon-light);
      box-shadow: 0 6px 12px rgba(0,0,0,0.5), 0 0 8px var(--neon-light-glow), inset 0 2px 0 rgba(255,255,255,0.08), inset 0 -2px 4px rgba(0,0,0,0.3);
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: var(--accent); transition: all 0.15s ease;
    }
    .play-btn:active {
      transform: scale(0.93);
      box-shadow: 0 2px 6px rgba(0,0,0,0.5), inset 0 2px 4px rgba(0,0,0,0.3);
    }
    .play-btn.playing {
      box-shadow: 0 6px 12px rgba(0,0,0,0.5), 0 0 20px var(--accent-glow), inset 0 2px 0 rgba(255,255,255,0.08);
    }
    .play-btn svg { fill: var(--accent); transition: fill 0.6s; }

    @keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }
    .spin { animation: spin 1s linear infinite; }

    /* === EQ PANEL === */
    .eq-toggle-btn {
      width: 48px; height: 48px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--accent); font-family: 'Orbitron', monospace; font-size: 8px; font-weight: 700;
      letter-spacing: 1px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow);
      transition: all 0.2s ease;
    }
    .eq-toggle-btn:active { transform: scale(0.92); }
    .eq-toggle-btn.active {
      background: linear-gradient(145deg, var(--btn-active1), var(--btn-active2));
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 8px var(--accent-glow);
    }

    .eq-panel {
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.15));
      border: 1px solid var(--neon-light);
      border-radius: 12px; padding: 14px 16px; margin-bottom: 12px;
      position: relative; z-index: 1;
      box-shadow: 0 0 6px var(--neon-light-glow), inset 0 2px 6px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    .eq-panel-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 12px;
    }
    .eq-panel-title {
      font-family: 'Orbitron', monospace; font-size: 8px; font-weight: 700;
      color: var(--label-color); letter-spacing: 3px; text-transform: uppercase;
    }
    .eq-reset-btn {
      font-family: 'Orbitron', monospace; font-size: 7px; font-weight: 600;
      color: var(--accent); background: transparent;
      border: 1px solid var(--neon-light); border-radius: 4px;
      padding: 3px 8px; cursor: pointer; letter-spacing: 1px;
      transition: all 0.2s;
    }
    .eq-reset-btn:hover { background: rgba(255,255,255,0.05); }

    /* EQ Vertical Sliders */
    .eq-sliders {
      display: flex; justify-content: space-around; align-items: flex-end;
      gap: 4px; margin-bottom: 14px; padding: 0 8px;
    }
    .eq-slider-group {
      display: flex; flex-direction: column; align-items: center; gap: 6px;
    }
    .eq-slider-wrap {
      width: 28px; height: 100px; position: relative;
      display: flex; align-items: center; justify-content: center;
    }
    .eq-slider-wrap input[type="range"] {
      -webkit-appearance: none; appearance: none;
      width: 90px; height: 4px;
      background: linear-gradient(90deg, var(--neon-light-glow), var(--accent), var(--neon-light-glow));
      border-radius: 2px; outline: none;
      transform: rotate(-90deg);
      transform-origin: center center;
    }
    .eq-slider-wrap input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 16px; height: 16px;
      background: var(--accent); border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 6px var(--accent-glow), 0 2px 4px rgba(0,0,0,0.4);
    }
    .eq-freq-label {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--freq-mark); letter-spacing: 0.5px;
    }
    .eq-db-label {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--lcd-dim); min-width: 30px; text-align: center;
    }

    /* Horizontal Controls (Woofer, Virtualizer) */
    .eq-extra-controls {
      display: flex; flex-direction: column; gap: 10px;
    }
    .eq-control-row {
      display: flex; align-items: center; gap: 10px;
    }
    .eq-control-label {
      font-family: 'Orbitron', monospace; font-size: 7px; font-weight: 600;
      color: var(--label-color); letter-spacing: 2px;
      min-width: 72px; text-transform: uppercase;
    }
    .eq-h-slider {
      -webkit-appearance: none; appearance: none;
      flex: 1; height: 4px;
      background: linear-gradient(90deg, var(--speaker-border), var(--accent));
      border-radius: 2px; outline: none;
    }
    .eq-h-slider::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 14px; height: 14px;
      background: var(--accent); border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 6px var(--accent-glow), 0 2px 4px rgba(0,0,0,0.4);
    }
    .eq-h-value {
      font-family: 'Orbitron', monospace; font-size: 8px;
      color: var(--lcd-text); min-width: 28px; text-align: right;
      text-shadow: 0 0 4px var(--lcd-glow);
    }

    /* === PHOTO SELECTION SCREEN (Radio Style) === */
    @keyframes landingShimmer {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }
    @keyframes landingPulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }
    @keyframes landingFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }
    /* User Login Screen */
    .user-login-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, #1a1118 0%, #2a1f28 30%, #1e1520 60%, #15101a 100%);
      z-index: 10001;
      display: flex; align-items: center; justify-content: center;
      padding: 16px;
      transition: opacity 0.5s ease;
    }
    .user-login-screen::before {
      content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(212,175,105,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(212,175,105,0.04) 0%, transparent 50%);
      pointer-events: none;
    }
    .user-login-screen.hidden { display: none; }
    .login-radio-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #3a2e28, #2a201a);
      border-radius: 28px;
      padding: 3px;
      box-shadow:
        0 40px 80px rgba(0,0,0,0.5),
        0 0 40px rgba(212,175,105,0.08),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .login-radio-inner {
      background: linear-gradient(145deg, #2a2018, #1e1610);
      border-radius: 25px;
      padding: 20px;
      position: relative;
    }
    .login-box {
      text-align: center;
    }
    .login-box.hidden { display: none; }
    .login-lcd {
      background: linear-gradient(180deg, #0a1a0a, #081408);
      border-radius: 12px; padding: 16px;
      margin-bottom: 16px;
      border: 2px solid rgba(212,175,105,0.15);
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.6);
    }
    .login-lcd-title {
      font-family: 'Orbitron', monospace; font-size: 14px;
      color: #55ff55; letter-spacing: 4px; font-weight: 700;
      text-shadow: 0 0 10px rgba(85,255,85,0.6);
      margin-bottom: 6px;
    }
    .login-lcd-sub {
      font-family: 'Inter', sans-serif; font-size: 12px;
      color: #3abf3a;
    }
    .login-footer {
      margin-top: 20px; padding-top: 16px;
      border-top: 1px solid rgba(212,175,105,0.15);
      text-align: center;
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: rgba(212,175,105,0.4);
    }
    .footer-divider { margin: 0 8px; opacity: 0.5; }
    .footer-link {
      color: rgba(212,175,105,0.6); text-decoration: none;
      transition: color 0.2s;
    }
    .footer-link:hover { color: #d4af69; }

    /* About Modal */
    .about-modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 20000;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .about-modal.visible { display: flex; }
    .about-content {
      background: linear-gradient(145deg, #2a2018, #1e1610);
      border: 2px solid rgba(212,175,105,0.3);
      border-radius: 24px; padding: 30px;
      max-width: 360px; width: 100%;
      position: relative;
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
    }
    .about-close {
      position: absolute; top: 15px; right: 20px;
      background: none; border: none;
      color: rgba(212,175,105,0.5); font-size: 28px;
      cursor: pointer; transition: color 0.2s;
    }
    .about-close:hover { color: #d4af69; }
    .about-header { text-align: center; margin-bottom: 20px; }
    .about-avatar {
      width: 80px; height: 80px; margin: 0 auto 16px;
      background: linear-gradient(135deg, #d4af69, #c49a50);
      border-radius: 50%; overflow: hidden;
    }
    .about-avatar img {
      width: 100%; height: 100%;
      object-fit: cover;
    }
    .about-name {
      font-family: 'Outfit', sans-serif; font-size: 22px;
      font-weight: 700; color: #d4af69; margin-bottom: 4px;
    }
    .about-title {
      font-family: 'Inter', sans-serif; font-size: 13px;
      color: rgba(212,175,105,0.6);
    }
    .about-body { text-align: center; }
    .about-intro {
      font-family: 'Inter', sans-serif; font-size: 14px;
      color: rgba(255,255,255,0.9); margin-bottom: 12px;
    }
    .about-desc {
      font-family: 'Inter', sans-serif; font-size: 13px;
      color: rgba(255,255,255,0.6); line-height: 1.6;
      margin-bottom: 20px;
    }
    .about-links { display: flex; justify-content: center; gap: 12px; }
    .about-link-btn {
      padding: 10px 24px; border-radius: 20px;
      background: linear-gradient(135deg, #d4af69, #c49a50);
      color: #1a1410; text-decoration: none;
      font-family: 'Outfit', sans-serif; font-size: 13px;
      font-weight: 600; transition: all 0.2s;
    }
    .about-link-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212,175,105,0.3);
    }
    .about-footer {
      margin-top: 20px; padding-top: 16px;
      border-top: 1px solid rgba(212,175,105,0.15);
      text-align: center;
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: rgba(212,175,105,0.4);
    }
    .username-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(212,175,105,0.3);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 16px;
      text-align: center; outline: none;
      transition: border-color 0.3s;
    }
    .username-input:focus { border-color: rgba(212,175,105,0.6); }
    .username-input::placeholder { color: rgba(255,255,255,0.3); }
    .password-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(212,175,105,0.3);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 24px;
      text-align: center; outline: none; letter-spacing: 8px;
      transition: border-color 0.3s; margin-top: 12px;
    }
    .password-input:focus { border-color: rgba(212,175,105,0.6); }
    .password-input::placeholder { color: rgba(255,255,255,0.3); font-size: 14px; letter-spacing: 0; }
    .login-btn {
      margin-top: 20px; width: 100%; padding: 14px;
      background: linear-gradient(135deg, #d4af69, #c49a50);
      border: none; border-radius: 16px;
      color: #1a1410; font-family: 'Outfit', sans-serif;
      font-size: 16px; font-weight: 700; letter-spacing: 2px;
      cursor: pointer; transition: all 0.3s;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(212,175,105,0.3);
    }
    .login-box.hidden { display: none; }
    .user-search-input {
      width: 100%; padding: 12px 16px; border-radius: 12px;
      border: 2px solid rgba(212,175,105,0.2);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 14px;
      outline: none; transition: border-color 0.2s;
      margin-bottom: 12px;
    }
    .user-search-input:focus { border-color: rgba(212,175,105,0.5); }
    .user-search-input::placeholder { color: rgba(255,255,255,0.3); }
    .user-list {
      max-height: 200px; overflow-y: auto;
      margin-bottom: 16px;
    }
    .user-list::-webkit-scrollbar { width: 6px; }
    .user-list::-webkit-scrollbar-thumb { background: rgba(212,175,105,0.3); border-radius: 3px; }
    .user-item {
      padding: 14px 20px; margin: 8px 0;
      background: rgba(0,0,0,0.3); border-radius: 12px;
      border: 2px solid rgba(212,175,105,0.2);
      color: #fff; font-family: 'Inter', sans-serif; font-size: 15px;
      cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; gap: 10px;
    }
    .user-item:hover {
      border-color: rgba(212,175,105,0.5);
      background: rgba(212,175,105,0.1);
    }
    .user-item-icon { font-size: 20px; }
    .user-item-name { flex: 1; }
    .new-user-btn {
      width: 100%; padding: 12px;
      background: transparent; border: 2px dashed rgba(212,175,105,0.4);
      border-radius: 12px; color: rgba(212,175,105,0.7);
      font-family: 'Inter', sans-serif; font-size: 14px;
      cursor: pointer; transition: all 0.2s;
    }
    .new-user-btn:hover {
      border-color: rgba(212,175,105,0.7);
      color: #d4af69;
    }
    .back-btn {
      margin-top: 12px; width: 100%; padding: 10px;
      background: transparent; border: none;
      color: rgba(212,175,105,0.6); font-family: 'Inter', sans-serif;
      font-size: 13px; cursor: pointer; transition: color 0.2s;
    }
    .back-btn:hover { color: #d4af69; }
    .no-users {
      padding: 30px; text-align: center;
      color: rgba(212,175,105,0.5); font-size: 13px;
      font-family: 'Inter', sans-serif;
    }
    .user-badge {
      position: absolute; top: 10px; right: 10px;
      background: rgba(212,175,105,0.2); padding: 6px 12px;
      border-radius: 12px; font-size: 11px; color: #d4af69;
      font-family: 'Inter', sans-serif;
    }

    .photo-select-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, #1a1118 0%, #2a1f28 30%, #1e1520 60%, #15101a 100%);
      z-index: 10000;
      display: flex; align-items: center; justify-content: center;
      padding: 16px;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .photo-select-screen::before {
      content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(212,175,105,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(212,175,105,0.04) 0%, transparent 50%);
      pointer-events: none;
    }
    .photo-select-screen.hiding {
      opacity: 0; transform: scale(1.05); pointer-events: none;
    }
    .photo-select-screen.hidden { display: none; }
    .photo-radio-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #3a2e28, #2a201a);
      border-radius: 28px;
      padding: 3px;
      box-shadow:
        0 40px 80px rgba(0,0,0,0.5),
        0 0 40px rgba(212,175,105,0.08),
        0 0 80px rgba(212,175,105,0.04),
        inset 0 1px 0 rgba(255,255,255,0.08);
      border: 2px solid rgba(212,175,105,0.6);
      position: relative;
    }
    .photo-radio-body::before {
      content: ''; position: absolute; top: -2px; left: 15%; right: 15%; height: 2px;
      background: linear-gradient(90deg, transparent, rgba(212,175,105,0.8), transparent);
      z-index: 3;
    }
    .photo-radio-inner {
      background: linear-gradient(160deg, #2e2420 0%, #241c18 50%, #1e1614 100%);
      border-radius: 25px;
      padding: 24px 18px;
      position: relative;
      overflow: hidden;
    }
    .photo-radio-inner::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        repeating-linear-gradient(90deg, rgba(212,175,105,0.01) 0px, transparent 1px, transparent 3px),
        repeating-linear-gradient(0deg, rgba(212,175,105,0.008) 0px, transparent 1px, transparent 3px);
      pointer-events: none; border-radius: inherit;
    }
    /* Gold trim line */
    .photo-radio-inner::after {
      content: ''; position: absolute; top: 12px; left: 12px; right: 12px; bottom: 12px;
      border: 1px solid rgba(212,175,105,0.2);
      border-radius: 16px; pointer-events: none;
    }
    /* Speaker grille top */
    .photo-speaker {
      background: linear-gradient(180deg, #1e1814, #2a221c);
      border-radius: 14px;
      padding: 10px 12px;
      margin-bottom: 16px;
      border: 2px solid rgba(212,175,105,0.45);
      position: relative;
      overflow: hidden;
    }
    .photo-speaker::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        radial-gradient(circle, rgba(212,175,105,0.08) 0.8px, transparent 0.8px),
        radial-gradient(circle, rgba(212,175,105,0.04) 0.8px, transparent 0.8px);
      background-size: 5px 5px, 5px 5px;
      background-position: 0 0, 2.5px 2.5px;
    }
    .photo-speaker-label {
      text-align: center;
      font-family: 'Orbitron', monospace;
      font-size: 9px; letter-spacing: 5px;
      font-weight: 900;
      color: #d4af69;
      text-shadow: 0 0 10px rgba(212,175,105,0.5), 0 0 4px rgba(212,175,105,0.3);
      position: relative; z-index: 1;
    }
    /* Brand */
    .photo-brand {
      text-align: center; margin-bottom: 16px; position: relative; z-index: 1;
    }
    .photo-brand-text {
      font-family: 'Outfit', sans-serif;
      font-size: 22px; font-weight: 800;
      background: linear-gradient(135deg, #d4af69, #f0d890, #d4af69, #c49a50);
      background-size: 200% auto;
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: landingShimmer 4s linear infinite;
      letter-spacing: 2px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
    }
    .photo-brand-sub {
      display: block;
      font-family: 'Outfit', sans-serif;
      font-size: 12px; font-weight: 500;
      color: rgba(212,175,105,0.8);
      margin-top: 6px;
      letter-spacing: 1.5px;
    }
    /* Decorative divider */
    .photo-brand::after {
      content: ''; display: block;
      width: 80px; height: 1px; margin: 12px auto 0;
      background: linear-gradient(90deg, transparent, rgba(212,175,105,0.6), transparent);
    }
    /* LCD area - instructions */
    .photo-lcd {
      background: linear-gradient(180deg, #0a0806, #12100c);
      border-radius: 14px;
      padding: 16px 18px;
      margin-bottom: 16px;
      border: 2px solid rgba(212,175,105,0.4);
      text-align: center;
      position: relative; z-index: 1;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.8), 0 0 8px rgba(212,175,105,0.1);
    }
    .photo-lcd::before {
      content: ''; position: absolute; top: -1px; left: 10%; right: 10%; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(212,175,105,0.6), transparent);
    }
    .photo-lcd-title {
      font-family: 'Orbitron', monospace;
      font-size: 14px; color: #f0d890; letter-spacing: 3px;
      text-shadow: 0 0 16px rgba(240,216,144,0.7), 0 0 6px rgba(240,216,144,0.4);
      margin-bottom: 8px; font-weight: 700;
    }
    .photo-lcd-sub {
      font-family: 'Inter', sans-serif;
      font-size: 13px; color: rgba(212,175,105,0.8); line-height: 1.7; font-weight: 500;
      letter-spacing: 0.5px;
    }
    .photo-lcd-count {
      font-family: 'Orbitron', monospace;
      font-size: 24px; font-weight: 900;
      color: #f0d890; margin-top: 10px;
      text-shadow: 0 0 20px rgba(240,216,144,0.8), 0 0 8px rgba(240,216,144,0.5);
      animation: landingPulse 2s ease-in-out infinite;
    }
    /* Photo grid */
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      width: 100%;
      margin-bottom: 16px;
      position: relative; z-index: 1;
    }
    .photo-slot {
      position: relative;
      aspect-ratio: 1;
      border-radius: 12px;
      border: 2px dashed rgba(212,175,105,0.5);
      background: rgba(255,255,255,0.03);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.3);
    }
    .photo-slot:hover {
      border-color: rgba(212,175,105,0.8);
      background: rgba(212,175,105,0.05);
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.3), 0 0 16px rgba(212,175,105,0.15);
    }
    .photo-slot.filled {
      border: 2px solid rgba(212,175,105,0.7);
      box-shadow: 0 4px 16px rgba(0,0,0,0.3), 0 0 12px rgba(212,175,105,0.15);
    }
    .photo-slot.filled img {
      width: 100%; height: 100%; object-fit: cover;
      border-radius: 10px;
    }
    .photo-slot .slot-label {
      position: absolute; bottom: 4px; left: 0; right: 0;
      text-align: center; font-size: 9px;
      color: rgba(212,175,105,0.7);
      font-family: 'Orbitron', monospace;
      font-weight: 700; letter-spacing: 0.5px;
    }
    .photo-slot.filled .slot-label {
      background: linear-gradient(transparent, rgba(0,0,0,0.7));
      color: rgba(255,255,255,0.85);
      border-radius: 0 0 10px 10px;
      padding: 8px 0 4px; bottom: 0;
    }
    .photo-slot .slot-icon {
      font-size: 26px; color: rgba(212,175,105,0.4); transition: all 0.3s;
    }
    .photo-slot:hover .slot-icon { color: rgba(212,175,105,0.8); }
    .photo-slot .remove-photo {
      position: absolute; top: 4px; right: 4px;
      width: 22px; height: 22px; border-radius: 50%;
      background: rgba(180,60,60,0.85); color: #fff;
      border: 1px solid rgba(255,255,255,0.15);
      font-size: 13px; font-weight: 700; line-height: 1;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      z-index: 2; box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      backdrop-filter: blur(4px);
    }
    /* Control area */
    .photo-controls {
      display: flex; flex-direction: column; align-items: center; gap: 10px;
      position: relative; z-index: 1;
    }
    .photo-batch-btn {
      background: linear-gradient(135deg, rgba(212,175,105,0.15), rgba(212,175,105,0.08));
      color: rgba(212,175,105,0.9); border: 2px solid rgba(212,175,105,0.5);
      padding: 12px 28px; border-radius: 24px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 0.5px;
      transition: all 0.3s ease;
      backdrop-filter: blur(4px);
    }
    .photo-batch-btn:hover {
      background: linear-gradient(135deg, rgba(212,175,105,0.25), rgba(212,175,105,0.12));
      border-color: rgba(212,175,105,0.7);
      color: #d4af69;
      box-shadow: 0 4px 20px rgba(212,175,105,0.2);
    }
    .photo-batch-btn:active { transform: scale(0.97); }
    .photo-batch-row {
      display: flex; gap: 10px; align-items: center; justify-content: center;
    }
    .photo-select-or {
      font-size: 10px; color: rgba(212,175,105,0.45);
      font-family: 'Orbitron', monospace; letter-spacing: 3px; font-weight: 600;
    }
    .photo-save-load-row {
      display: flex; gap: 12px; margin-bottom: 8px;
    }
    .photo-save-btn, .photo-load-btn {
      background: linear-gradient(135deg, #4a90d9, #357abd);
      color: #fff; border: 2px solid rgba(100,160,220,0.6);
      padding: 10px 24px; border-radius: 20px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 1px;
      box-shadow: 0 4px 16px rgba(74,144,217,0.3);
      transition: all 0.3s ease;
    }
    .photo-save-btn {
      opacity: 0.3; pointer-events: none;
    }
    .photo-save-btn.ready {
      opacity: 1; pointer-events: auto;
    }
    .photo-load-btn {
      background: linear-gradient(135deg, #50b87a, #3a9d62);
      border-color: rgba(80,184,122,0.6);
      box-shadow: 0 4px 16px rgba(80,184,122,0.3);
    }
    .photo-save-btn.ready:hover, .photo-load-btn:hover {
      transform: translateY(-2px);
    }
    .photo-save-btn.ready:hover {
      background: linear-gradient(135deg, #5a9fe8, #4a90d9);
      box-shadow: 0 6px 24px rgba(74,144,217,0.4);
    }
    .photo-load-btn:hover {
      background: linear-gradient(135deg, #5fc888, #50b87a);
      box-shadow: 0 6px 24px rgba(80,184,122,0.4);
    }
    .photo-save-btn.ready:active, .photo-load-btn:active { transform: scale(0.97); }
    .photo-reset-btn {
      background: linear-gradient(135deg, #888, #666);
      color: #fff; border: 2px solid rgba(150,150,150,0.6);
      padding: 8px 20px; border-radius: 16px;
      font-size: 12px; font-weight: 600; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 1px;
      box-shadow: 0 3px 12px rgba(100,100,100,0.3);
      transition: all 0.3s ease;
    }
    .photo-reset-btn:hover {
      background: linear-gradient(135deg, #999, #777);
      transform: translateY(-2px);
      box-shadow: 0 5px 18px rgba(100,100,100,0.4);
    }
    .photo-reset-btn:active { transform: scale(0.97); }
    .album-list-popup {
      display: none; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(145deg, #2a2018, #1a1410);
      border: 2px solid rgba(212,175,105,0.4);
      border-radius: 16px; padding: 0; min-width: 280px; max-width: 320px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.8);
      z-index: 1000;
    }
    .album-list-popup.visible { display: block; }
    .album-list-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 16px; border-bottom: 1px solid rgba(212,175,105,0.2);
      color: #d4af69; font-family: 'Outfit', sans-serif; font-weight: 600;
    }
    .album-list-close {
      background: none; border: none; color: rgba(212,175,105,0.6);
      font-size: 20px; cursor: pointer; padding: 0 4px;
    }
    .album-list-close:hover { color: #d4af69; }
    .album-list-content {
      max-height: 250px; overflow-y: auto; padding: 8px;
    }
    .album-list-content::-webkit-scrollbar { width: 6px; }
    .album-list-content::-webkit-scrollbar-thumb {
      background: rgba(212,175,105,0.3); border-radius: 3px;
    }
    .album-item {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; margin: 4px 0; border-radius: 10px;
      background: rgba(0,0,0,0.2); cursor: pointer;
      transition: all 0.2s; border: 1px solid transparent;
    }
    .album-item:hover {
      background: rgba(212,175,105,0.1);
      border-color: rgba(212,175,105,0.3);
    }
    .album-item-icon { font-size: 20px; }
    .album-item-name {
      flex: 1; color: rgba(255,255,255,0.85);
      font-family: 'Inter', sans-serif; font-size: 13px;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .album-item-count {
      color: rgba(212,175,105,0.6); font-size: 11px;
      font-family: 'Inter', sans-serif;
    }
    .album-list-empty {
      text-align: center; padding: 30px 20px;
      color: rgba(212,175,105,0.5); font-size: 13px;
      font-family: 'Inter', sans-serif;
    }
    .photo-done-btn {
      background: linear-gradient(135deg, #d4af69, #c49a50);
      color: #1a1410; border: 2px solid rgba(240,216,144,0.6);
      padding: 14px 50px; border-radius: 28px;
      font-size: 16px; font-weight: 900; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 3px;
      box-shadow: 0 6px 24px rgba(212,175,105,0.3);
      transition: all 0.3s ease;
      opacity: 0.2; pointer-events: none;
    }
    .photo-done-btn.ready {
      opacity: 1; pointer-events: auto;
      animation: landingFloat 3s ease-in-out infinite;
    }
    .photo-done-btn.ready:hover {
      transform: translateY(-2px);
      background: linear-gradient(135deg, #e0c080, #d4af69);
      box-shadow: 0 8px 32px rgba(212,175,105,0.4), 0 0 20px rgba(212,175,105,0.15);
    }
    .photo-done-btn.ready:active { transform: scale(0.97); animation: none; }
    .photo-select-skip {
      margin-top: 4px; background: none; border: none;
      color: rgba(212,175,105,0.55); font-size: 11px; cursor: pointer;
      font-family: 'Inter', sans-serif;
      text-decoration: none; font-weight: 500; letter-spacing: 0.5px;
      transition: color 0.3s;
    }
    .photo-select-skip:hover { color: rgba(212,175,105,0.8); }
    /* Screws */
    .photo-screw {
      position: absolute; width: 8px; height: 8px;
      background: linear-gradient(145deg, #3a3028, #2a2018);
      border-radius: 50%; border: 1px solid rgba(212,175,105,0.15);
      z-index: 2;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.4);
    }
    .photo-screw::after {
      content: ''; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%,-50%) rotate(35deg);
      width: 4px; height: 0.5px; background: rgba(212,175,105,0.3);
    }
    .photo-screw-tl { top: 10px; left: 10px; }
    .photo-screw-tr { top: 10px; right: 10px; }
    .photo-screw-bl { bottom: 10px; left: 10px; }
    .photo-screw-br { bottom: 10px; right: 10px; }

    /* === PHOTO UPLOAD (in-radio) === */
    .photo-upload-btn {
      display: none;
      width: 30px; height: 30px;
      border-radius: 50%;
      background: var(--accent-muted);
      border: 2px dashed var(--neon-light);
      color: var(--text-dim);
      font-size: 18px; line-height: 1;
      cursor: pointer;
      flex-shrink: 0;
      align-self: center;
      margin-left: 3px;
      transition: all 0.3s ease;
    }
    .photo-upload-btn:hover {
      background: var(--neon-light);
      color: var(--player-bg);
      box-shadow: 0 0 8px var(--neon-light-glow);
    }
    .photo-upload-btn.has-photos { display: flex; align-items: center; justify-content: center; }
    .brand-photos { display: contents; }
    .ctrl-photos { display: contents; }

    /* === PHOTO LIGHTBOX === */
    .photo-lightbox {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
      z-index: 9999; align-items: center; justify-content: center;
      cursor: pointer;
    }
    .photo-lightbox.visible { display: flex; }
    .photo-lightbox img {
      max-width: 85%; max-height: 85%;
      border-radius: 16px; object-fit: contain;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 12px var(--neon-glow);
      border: 2px solid var(--neon-border);
      animation: lightboxIn 0.3s ease;
    }
    @keyframes lightboxIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    /* === SCREWS === */
    .screw {
      position: absolute; width: 10px; height: 10px; border-radius: 50%;
      background: linear-gradient(145deg, var(--screw1), var(--screw2));
      border: 1px solid var(--btn-border);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.1); z-index: 2;
      transition: all 0.6s;
    }
    .screw::after {
      content: ''; position: absolute; top: 4px; left: 1px;
      width: 8px; height: 1px; background: var(--screw-line);
      transition: background 0.6s;
    }
    .screw-tl{top:12px;left:12px} .screw-tr{top:12px;right:12px}
    .screw-bl{bottom:12px;left:12px} .screw-br{bottom:12px;right:12px}

    /* === FOOTER === */
    .radio-footer {
      text-align: center; margin-top: 10px; padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.05);
      position: relative; z-index: 1;
    }
    .footer-text {
      font-size: 9px; color: var(--footer-color);
      letter-spacing: 1px; transition: color 0.6s;
      font-weight: 500;
    }
    .footer-text a { color: var(--footer-link); text-decoration: none; transition: color 0.6s; }
    .footer-text a:hover { color: var(--accent); }

    /* === ERROR === */
    .error-msg {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: #ff4b4b; text-align: center; margin-top: 8px;
      display: none; position: relative; z-index: 1;
    }
    .error-msg.visible { display: block; }

    /* ============================================
       RESPONSIVE - MOBILE FIRST
       ============================================ */

    /* Desktop: 라디오 body 둥글게 */
    @media (min-width: 481px) {
      .radio { padding: 6px; border-radius: 24px; }
      .radio-inner { border-radius: 20px; padding: 24px 20px 20px; }
      .radio-inner::before { border-radius: 20px; }
      .theme-switcher { border-radius: 20px 20px 0 0; }
      .theme-name { margin-bottom: 6px; }
    }

    /* Tablet */
    @media (max-width: 540px) {
      body { padding: 10px; }
      .radio { max-width: 100%; }
    }

    /* === Mobile (phones) === */
    @media (max-width: 480px) {
      body {
        padding: 0;
        justify-content: flex-start;
        min-height: 100vh;
        min-height: 100dvh;
      }

      /* Theme switcher: 라디오 안에 붙이기 */
      .theme-name { font-size: 0; height: 0; margin: 0; overflow: hidden; }
      .theme-switcher {
        margin: 0;
        padding: 8px 12px;
        border-radius: 0;
        background: rgba(0,0,0,0.25);
        border: none;
        border-bottom: 1px solid rgba(255,255,255,0.04);
        justify-content: center;
        gap: 10px;
        width: 100%;
      }
      .theme-dot {
        width: 32px; height: 32px;
        flex-shrink: 0;
      }

      /* Radio body: 풀 화면 */
      .radio {
        max-width: 100%;
        border-radius: 0;
        padding: 0;
        border-width: 2px 0;
        box-shadow:
          0 0 8px var(--neon-glow),
          inset 0 0 8px var(--neon-glow);
        min-height: 100vh;
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
      }
      .radio-inner {
        border-radius: 0;
        padding: 14px 16px 16px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .radio-inner::before { border-radius: 0; }

      /* Antenna 숨김 */
      .antenna { display: none; }

      /* Screws 숨김 */
      .screw { display: none; }

      /* Brand */
      .radio-top { margin-bottom: 10px; }
      .brand { font-size: 18px; letter-spacing: 2px; }
      .power-btn { width: 38px; height: 38px; }

      /* Speaker: 컴팩트 */
      .speaker-grille {
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 10px;
      }
      .eq-container { height: 36px; gap: 2px; }
      .eq-bar { width: 4px; }

      /* LCD: 컴팩트 */
      .lcd-display {
        padding: 10px 14px;
        margin-bottom: 10px;
        min-height: 74px;
        border-radius: 8px;
      }
      .lcd-name { font-size: 13px; }
      .lcd-freq { font-size: 22px; }
      .lcd-provider { font-size: 8px; margin-bottom: 2px; }
      .lcd-status { font-size: 7px; margin-top: 3px; }

      /* Tuning: 컴팩트 */
      .tuning-section {
        padding: 8px 14px;
        margin-bottom: 10px;
        border-radius: 8px;
      }
      .tuning-label { margin-bottom: 6px; }
      .freq-band { height: 22px; }
      .tuning-needle { height: 18px; top: 2px; }
      .freq-mark { font-size: 6px; }

      /* Preset: flex-grow로 남은 공간 활용 */
      .preset-section {
        margin-bottom: 10px;
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
      }
      .preset-label { margin-bottom: 6px; }
      .preset-scroll { flex: 1; min-height: 0; }
      .preset-buttons {
        gap: 4px;
        grid-template-columns: repeat(5, 1fr);
      }
      .preset-btn {
        padding: 7px 4px;
        border-radius: 6px;
        min-width: auto;
      }
      .eq-panel { padding: 10px 12px; margin-bottom: 8px; }
      .eq-slider-wrap { height: 80px; }
      .eq-slider-wrap input[type="range"] { width: 70px; }
      .preset-num { font-size: 10px; }
      .preset-name { font-size: 6.5px; }

      /* Controls: 컴팩트 */
      .control-panel { gap: 8px; }
      .knob-container { width: 50px; height: 50px; }
      .knob { width: 42px; height: 42px; top: 4px; left: 4px; }
      .knob-indicator { top: 5px; height: 9px; }
      .knob-tick { height: 4px; }
      .knob-label { font-size: 6px; }
      .play-btn { width: 58px; height: 58px; border-width: 2px; }
      .play-btn svg { width: 24px; height: 24px; }

      /* Footer: 컴팩트 */
      .radio-footer { margin-top: 8px; padding-top: 8px; }
      .footer-text { font-size: 8px; }
    }

    /* === Small phones (SE, mini 등) === */
    @media (max-width: 380px) {
      .radio-inner { padding: 10px 12px 12px; }
      .brand { font-size: 16px; }
      .speaker-grille { padding: 8px; margin-bottom: 8px; }
      .eq-container { height: 30px; }
      .lcd-display { padding: 8px 12px; margin-bottom: 8px; min-height: 66px; }
      .lcd-freq { font-size: 19px; }
      .lcd-name { font-size: 11px; }
      .tuning-section { padding: 6px 12px; margin-bottom: 8px; }
      .freq-band { height: 20px; }
      .tuning-needle { height: 16px; }
      .preset-section { margin-bottom: 8px; }
      .preset-buttons { gap: 3px; grid-template-columns: repeat(5, 1fr); }
      .preset-btn { padding: 5px 3px; min-width: auto; }
      .preset-num { font-size: 9px; }
      .preset-name { font-size: 5.5px; }
      .control-panel { gap: 6px; }
      .knob-container { width: 44px; height: 44px; }
      .knob { width: 38px; height: 38px; top: 3px; left: 3px; }
      .play-btn { width: 52px; height: 52px; }
      .theme-dot { width: 28px; height: 28px; }
      .theme-switcher { gap: 6px; padding: 6px 8px; }
    }

    /* === Very small phones === */
    @media (max-width: 340px) {
      .theme-dot { width: 24px; height: 24px; }
      .theme-switcher { gap: 5px; }
      .brand { font-size: 14px; }
      .lcd-freq { font-size: 17px; }
      .play-btn { width: 48px; height: 48px; }
      .knob-container { width: 40px; height: 40px; }
      .knob { width: 34px; height: 34px; top: 3px; left: 3px; }
      .preset-buttons { grid-template-columns: repeat(5, 1fr); }
      .preset-btn { min-width: auto; padding: 4px 2px; }
    }

    /* Landscape phone */
    @media (max-height: 500px) and (orientation: landscape) {
      body { justify-content: flex-start; }
      .radio { min-height: auto; }
      .radio-inner { min-height: auto; flex: none; }
      .speaker-grille { padding: 6px; margin-bottom: 6px; }
      .eq-container { height: 24px; }
      .lcd-display { min-height: 58px; padding: 6px 12px; margin-bottom: 6px; }
      .lcd-freq { font-size: 18px; }
      .tuning-section { padding: 4px 12px; margin-bottom: 6px; }
      .preset-section { margin-bottom: 6px; }
      .eq-panel { padding: 8px 10px; margin-bottom: 4px; }
      .eq-slider-wrap { height: 60px; }
      .eq-slider-wrap input[type="range"] { width: 50px; }
      .eq-extra-controls { gap: 4px; }
      .control-panel { gap: 6px; }
      .knob-container { width: 40px; height: 40px; }
      .knob { width: 34px; height: 34px; top: 3px; left: 3px; }
      .play-btn { width: 48px; height: 48px; }
      .radio-footer { display: none; }
    }

    /* Touch: 터치 타겟 최소 크기 보장 */
    @media (pointer: coarse) {
      .preset-btn { min-height: 40px; }
      .power-btn { width: 40px; height: 40px; }
      .play-btn { min-width: 52px; min-height: 52px; }
      .theme-dot { min-width: 28px; min-height: 28px; }
    }
  </style>
</head>
<body>

<!-- User Login Screen -->
<div class="user-login-screen" id="userLoginScreen">
  <div class="login-radio-body">
    <div class="login-radio-inner">
      <div class="photo-screw photo-screw-tl"></div>
      <div class="photo-screw photo-screw-tr"></div>
      <div class="photo-screw photo-screw-bl"></div>
      <div class="photo-screw photo-screw-br"></div>

      <div class="photo-speaker">
        <div class="photo-speaker-label">STEREO RADIO</div>
      </div>

      <div class="photo-brand">
        <span class="photo-brand-text">라디오카페</span>
        <span class="photo-brand-sub">나만의 추억 사진을 보면서 라디오 방송을 들으세요!</span>
      </div>

      <!-- 사용자 선택 화면 -->
      <div class="login-box" id="userSelectBox">
        <div class="login-lcd">
          <div class="login-lcd-title">USER SELECT</div>
          <div class="login-lcd-sub">사용자를 선택(또는 검색)하거나, 새 사용자 등록하세요.</div>
        </div>
        <input type="text" id="userSearchInput" class="user-search-input" placeholder="사용자 검색..." oninput="filterUsers()">
        <div class="user-list" id="userList"></div>
        <button class="new-user-btn" onclick="showNewUserForm()">+ 새 사용자 등록</button>
      </div>

      <!-- 비밀번호 입력 화면 -->
      <div class="login-box hidden" id="passwordBox">
        <div class="login-lcd">
          <div class="login-lcd-title">PASSWORD</div>
          <div class="login-lcd-sub"><span id="selectedUserName"></span>님, 비밀번호를 입력하세요</div>
        </div>
        <input type="password" id="passwordInput" class="password-input" placeholder="●●●●" maxlength="4" inputmode="numeric" pattern="[0-9]*">
        <button class="login-btn" onclick="submitPassword()">확인</button>
        <button class="back-btn" onclick="showUserSelect()">← 돌아가기</button>
      </div>

      <!-- 새 사용자 등록 화면 -->
      <div class="login-box hidden" id="newUserBox">
        <div class="login-lcd">
          <div class="login-lcd-title">NEW USER</div>
          <div class="login-lcd-sub">이름과 비밀번호를 입력하세요</div>
        </div>
        <input type="text" id="newUsernameInput" class="username-input" placeholder="이름 입력..." maxlength="20">
        <input type="password" id="newPasswordInput" class="password-input" placeholder="●●●●" maxlength="4" inputmode="numeric" pattern="[0-9]*">
        <button class="login-btn" onclick="registerNewUser()">등록하기</button>
        <button class="back-btn" onclick="showUserSelect()">← 돌아가기</button>
      </div>

      <!-- 푸터 -->
      <div class="login-footer">
        <span>© 2026 라디오카페</span>
        <span class="footer-divider">|</span>
        <a href="manual.html" class="footer-link" style="color: #ff69b4; font-weight: 700;">사용법</a>
        <span class="footer-divider">|</span>
        <a href="admin.html" class="footer-link">관리자</a>
        <span class="footer-divider">|</span>
        <a href="about.html" class="footer-link">Hyein Cho</a>
      </div>
    </div>
  </div>
</div>

<!-- About Modal -->
<div class="about-modal" id="aboutModal" onclick="hideAbout(event)">
  <div class="about-content" onclick="event.stopPropagation()">
    <button class="about-close" onclick="hideAbout()">&times;</button>
    <div class="about-header">
      <div class="about-avatar"><img src="profile.jpg" alt="Hyein Cho"></div>
      <div class="about-name">조혜인 (Hyein Cho)</div>
      <div class="about-title">마이펫태일 대표 · 인셀랩 대표 · 서양화가</div>
    </div>
    <div class="about-body">
      <p class="about-intro">안녕하세요! 라디오카페를 만든 심재우입니다.</p>
      <p class="about-desc">음악과 추억을 함께 즐길 수 있는 공간을 만들고 싶었습니다. 나만의 사진을 보면서 라디오를 들으며 편안한 시간을 보내세요.</p>
      <div class="about-links">
        <a href="https://github.com/jaiwshim-project" target="_blank" class="about-link-btn">GitHub</a>
      </div>
    </div>
    <div class="about-footer">
      <span>라디오카페 v1.0</span>
    </div>
  </div>
</div>

<!-- Photo Selection Screen -->
<div class="photo-select-screen hidden" id="photoSelectScreen">
  <div class="photo-radio-body">
    <div class="photo-radio-inner">
      <div class="photo-screw photo-screw-tl"></div>
      <div class="photo-screw photo-screw-tr"></div>
      <div class="photo-screw photo-screw-bl"></div>
      <div class="photo-screw photo-screw-br"></div>

      <div class="photo-speaker">
        <div class="photo-speaker-label">STEREO RADIO</div>
      </div>

      <div class="photo-brand">
        <span class="photo-brand-text">라디오카페 - 15개 방송듣기</span>
        <span class="photo-brand-sub">나만의 추억 사진을 보면서 라디오 방송을 들으세요!</span>
      </div>

      <div class="photo-lcd">
        <div class="photo-lcd-title">PHOTO SELECT</div>
        <div class="photo-lcd-sub">갤러리에서 사진을 선택하세요<br>상단 4장 + 하단 2장</div>
        <div class="photo-lcd-count" id="photoCount">0 / 6</div>
      </div>

      <div class="photo-grid" id="photoGrid">
        <div class="photo-slot" data-idx="0" onclick="pickSlotPhoto(0)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 1</div>
        </div>
        <div class="photo-slot" data-idx="1" onclick="pickSlotPhoto(1)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 2</div>
        </div>
        <div class="photo-slot" data-idx="2" onclick="pickSlotPhoto(2)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 3</div>
        </div>
        <div class="photo-slot" data-idx="3" onclick="pickSlotPhoto(3)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 4</div>
        </div>
        <div class="photo-slot" data-idx="4" onclick="pickSlotPhoto(4)">
          <span class="slot-icon">+</span>
          <div class="slot-label">하단 좌</div>
        </div>
        <div class="photo-slot" data-idx="5" onclick="pickSlotPhoto(5)">
          <span class="slot-icon">+</span>
          <div class="slot-label">하단 우</div>
        </div>
      </div>

      <div class="photo-controls">
        <div class="photo-batch-row">
          <button class="photo-batch-btn" onclick="pickAllPhotos()">갤러리에서 6장 한번에 선택</button>
          <button class="photo-reset-btn" onclick="resetPhotos()">사진선택 초기화</button>
        </div>
        <input type="file" id="batchFileInput" accept="image/*" multiple style="display:none">
        <div class="photo-select-or">- OR -</div>
        <div class="photo-save-load-row">
          <button class="photo-save-btn" id="photoSaveBtn" onclick="savePhotosToAlbum()">새 사진첩 저장</button>
          <button class="photo-load-btn" id="photoLoadBtn" onclick="showAlbumList()">사진첩 불러오기</button>
        </div>
        <div class="album-list-popup" id="albumListPopup">
          <div class="album-list-header">
            <span>📚 사진첩 목록</span>
            <button class="album-list-close" onclick="hideAlbumList()">&times;</button>
          </div>
          <div class="album-list-content" id="albumListContent"></div>
        </div>
        <button class="photo-done-btn" id="photoDoneBtn" onclick="completePhotoSelect()">PLAY</button>
        <button class="photo-select-skip" onclick="skipPhotoSelect()">기본 사진으로 시작</button>
      </div>

      <input type="file" id="slotFileInput" accept="image/*" style="display:none">
    </div>
  </div>
</div>

<!-- Theme Name (desktop only) -->
<div class="theme-name" id="themeName">WOOD CLASSIC</div>

<div class="radio" id="radioBody">
  <div class="antenna" id="antenna"></div>

  <!-- Theme Switcher: 라디오 본체 안 상단 -->
  <div class="theme-switcher" id="themeSwitcher">
    <div class="theme-dot active" data-t="wood" title="우드 클래식 · 나무결" onclick="setTheme('wood')"></div>
    <div class="theme-dot" data-t="cream" title="레트로 크림 · 가죽" onclick="setTheme('cream')"></div>
    <div class="theme-dot" data-t="black" title="미드나잇 블랙 · 카본파이버" onclick="setTheme('black')"></div>
    <div class="theme-dot" data-t="military" title="밀리터리 · 캔버스" onclick="setTheme('military')"></div>
    <div class="theme-dot" data-t="silver" title="크롬 실버 · 브러시드메탈" onclick="setTheme('silver')"></div>
    <div class="theme-dot" data-t="cyber" title="네온 사이버 · 회로기판" onclick="setTheme('cyber')"></div>
    <div class="theme-dot" data-t="rose" title="로즈 골드 · 대리석" onclick="setTheme('rose')"></div>
    <div class="theme-dot" data-t="maltese" title="말티즈 · 털 결" onclick="setTheme('maltese')"></div>
  </div>

  <div class="radio-inner">
    <div class="screw screw-tl"></div>
    <div class="screw screw-tr"></div>
    <div class="screw screw-bl"></div>
    <div class="screw screw-br"></div>

    <!-- Brand & Power -->
    <div class="radio-top">
      <div class="brand">라디오카페</div>
      <!-- Maltese photos (동적) -->
      <span class="brand-photos" id="brandPhotos"></span>
      <button class="photo-upload-btn" id="photoUploadBtn" onclick="reopenPhotoSelect()" title="사진 변경">+</button>
      <div class="power-area">
        <div class="power-led" id="powerLed"></div>
        <button class="power-btn" id="powerBtn" title="전원">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M12 2v10"/><path d="M18.4 6.6a9 9 0 1 1-12.8 0"/></svg>
        </button>
      </div>
    </div>

    <!-- Speaker Grille -->
    <div class="speaker-grille">
      <div class="speaker-label">STEREO</div>
      <div class="speaker-mesh"></div>
      <div class="eq-container" id="equalizer"></div>
    </div>

    <!-- LCD Display -->
    <div class="lcd-display">
      <div class="lcd-idle" id="lcdIdle"><span id="lcdClock" style="font-size:22px;font-weight:700;display:block;margin-bottom:4px"></span><span style="font-size:9px;opacity:0.6;letter-spacing:3px">SELECT STATION</span></div>
      <div class="lcd-active" id="lcdActive">
        <div class="lcd-provider" id="lcdProvider"></div>
        <div class="lcd-name" id="lcdName"></div>
        <div class="lcd-freq" id="lcdFreq"></div>
        <div class="lcd-status">
          <span id="lcdStatusText"><span class="on-air-dot" id="onAirDot" style="display:none"></span>PLAYING</span>
          <div class="lcd-signal" id="lcdSignal">
            <div class="lcd-signal-bar" style="height:4px"></div>
            <div class="lcd-signal-bar" style="height:7px"></div>
            <div class="lcd-signal-bar" style="height:10px"></div>
            <div class="lcd-signal-bar" style="height:13px"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tuning Dial -->
    <div class="tuning-section">
      <div class="tuning-label">FM TUNING</div>
      <div class="freq-band">
        <div class="freq-ticks" id="freqTicks"></div>
        <div class="freq-marks">
          <span class="freq-mark">88</span><span class="freq-mark">92</span>
          <span class="freq-mark">96</span><span class="freq-mark">100</span>
          <span class="freq-mark">104</span><span class="freq-mark">108</span>
        </div>
        <div class="tuning-needle" id="tuningNeedle"></div>
      </div>
    </div>

    <!-- Preset Station Buttons -->
    <div class="preset-section">
      <div class="preset-label">PRESET STATIONS</div>
      <div class="preset-scroll">
        <div class="preset-buttons" id="presetButtons"></div>
      </div>
    </div>

    <!-- EQ Panel -->
    <div class="eq-panel" id="eqPanel" style="display:none">
      <div class="eq-panel-header">
        <span class="eq-panel-title">EQUALIZER</span>
        <button class="eq-reset-btn" onclick="resetEQ()">RESET</button>
      </div>
      <div class="eq-sliders">
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb0">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="0" oninput="updateEQ(0,this.value)"></div>
          <span class="eq-freq-label">60</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb1">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="1" oninput="updateEQ(1,this.value)"></div>
          <span class="eq-freq-label">230</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb2">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="2" oninput="updateEQ(2,this.value)"></div>
          <span class="eq-freq-label">910</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb3">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="3" oninput="updateEQ(3,this.value)"></div>
          <span class="eq-freq-label">3.6k</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb4">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="4" oninput="updateEQ(4,this.value)"></div>
          <span class="eq-freq-label">14k</span>
        </div>
      </div>
      <div class="eq-extra-controls">
        <div class="eq-control-row">
          <span class="eq-control-label">BASS BOOST</span>
          <input type="range" class="eq-h-slider" id="wooferSlider" min="0" max="12" value="0" step="0.5" oninput="updateWoofer(this.value)">
          <span class="eq-h-value" id="wooferValue">0</span>
        </div>
        <div class="eq-control-row">
          <span class="eq-control-label">VIRTUAL</span>
          <input type="range" class="eq-h-slider" id="virtualizerSlider" min="0" max="100" value="0" oninput="updateVirtualizer(this.value)">
          <span class="eq-h-value" id="virtualizerValue">0</span>
        </div>
      </div>
    </div>

    <!-- Control Panel -->
    <div class="control-panel">
      <div class="knob-area">
        <div class="knob-container" id="knobContainer">
          <div class="knob-marks" id="knobMarks"></div>
          <div class="knob" id="volumeKnob" title="볼륨 조절"><div class="knob-indicator"></div></div>
        </div>
        <div class="knob-label">VOLUME</div>
      </div>
      <span class="ctrl-photos" id="ctrlPhotoLeft"></span>
      <div class="play-btn-container">
        <button class="play-btn" id="playBtn" onclick="togglePlay()">
          <svg id="playIcon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="7,3 21,12 7,21"/></svg>
          <svg id="pauseIcon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" stroke="none" style="display:none"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
          <svg id="loaderIcon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" style="display:none" class="spin"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
        </button>
      </div>
      <span class="ctrl-photos" id="ctrlPhotoRight"></span>
      <div class="knob-area">
        <button class="eq-toggle-btn" id="eqToggleBtn" onclick="toggleEqPanel()" title="이퀄라이저">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
        </button>
        <div class="knob-label">EQ</div>
      </div>
    </div>

    <div class="error-msg" id="errorMsg"></div>

    <!-- Photo Lightbox -->
    <div class="photo-lightbox" id="photoLightbox" onclick="closeLightbox()">
      <img id="lightboxImg" src="" alt="">
    </div>

    <div class="radio-footer">
      <div class="footer-text">&copy; 2026 <a href="about.html"><strong>Hyein Cho</strong></a></div>
    </div>
  </div>
</div>

<script>
  // === Station Data ===
  var STATIONS = [
    // === 공영방송 ===
    {id:'kbs-1fm',name:'KBS 클래식FM',url:'https://1fm.gscdn.kbs.co.kr/1fm_192_2.m3u8?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly8xZm0uZ3NjZG4ua2JzLmNvLmtyLyoiLCJDb25kaXRpb24iOnsiRGF0ZUxlc3NUaGFuIjp7IkFXUzpFcG9jaFRpbWUiOjE3Njc4Mjc3NjB9fX1dfQ__&Key-Pair-Id=APKAICDSGT3Y7IXGJ3TA&Signature=mXsMdZtv5pVJjKsZawW0ms8KkzrfYXBgWpi4HtpZO9TKLhUg22n6XIZkLrz2C4HftzhtPbG1vyByHlwHMzMlwXeXwjaxMkU4PNj2Wy-ubyRr8uP2zw41~8ZSCCGF5EV2OFhG1XH-88dD0nWrbSaUsij0SgZREDvrofiA6ip4xha4ZUAwH4vhP7GenNaJXu99DlZYuMfx5o7errctTKY-U6gppCruRl00NCpaOwJTVrwKVc5RnZSs2goGc~uqY8OQZuRwcp1cFTkqCt83FMlIiMKXItPvj8S8x2knhY4cXv1uAyTdKbmHEKTU-lfZVXzmq~NNf5Z0XUC7kLSe90dY3Q__',freq:'93.1 MHz',freqNum:93.1,logoText:'1FM',provider:'KBS'},
    {id:'ebs-fm',name:'EBS FM',url:'https://ebsonair.ebs.co.kr/fmradiofamilypc/familypc1m/playlist.m3u8',freq:'104.5 MHz',freqNum:104.5,logoText:'EBS',provider:'EBS'},
    // === 지상파 ===
    {id:'gwangju-mbc-fm',name:'광주MBC FM',url:'https://media.kjmbc.co.kr/hls/fmlive/GWANGJU-MBC-FM/playlist.m3u8',freq:'93.9 MHz',freqNum:93.9,logoText:'MBC',provider:'MBC'},
    {id:'sbs-powerfm',name:'SBS 파워FM',url:'https://radiolive.sbs.co.kr/powerpc/powerfm.stream/playlist.m3u8?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3Njc2OTc5ODksInBhdGgiOiIvcG93ZXJmbS5zdHJlYW0iLCJkdXJhdGlvbiI6LTEsInVubyI6IjNlZjRmZDA1LTZiYWQtNGYwOC1hMzYzLTBjNjkxMjUyZTEyNiIsImlhdCI6MTc2NzY1NDc4OX0.R-HyadR3JwB4rXJwXBqP33GX4RslvtM0dHb92hBHjo4',freq:'107.7 MHz',freqNum:107.7,logoText:'SBS',provider:'SBS'},
    // === 보도/뉴스 ===
    {id:'ytn-radio',name:'YTN 라디오',url:'https://radiolive.ytn.co.kr/radio/_definst_/20211118_fmlive/playlist.m3u8',freq:'94.5 MHz',freqNum:94.5,logoText:'YTN',provider:'YTN'},
    {id:'tbs-fm',name:'TBS FM',url:'https://cdnfm.tbs.seoul.kr/tbs/_definst_/tbs_fm_web_360.smil/playlist.m3u8',freq:'95.1 MHz',freqNum:95.1,logoText:'TBS',provider:'TBS'},
    // === 종교방송 ===
    {id:'cbs-music',name:'CBS 음악FM',url:'https://m-aac.cbs.co.kr/mweb_cbs939/_definst_/cbs939.stream/playlist.m3u8',freq:'93.9 MHz',freqNum:93.9,logoText:'M',provider:'CBS'},
    {id:'cbs-std',name:'CBS 표준FM',url:'https://aac.cbs.co.kr/cbs981/_definst_/cbs981.stream/playlist.m3u8',freq:'98.1 MHz',freqNum:98.1,logoText:'CBS',provider:'CBS'},
    {id:'febc',name:'극동방송',url:'http://mlive2.febc.net:1935/live/seoulfm/playlist.m3u8',freq:'106.9 MHz',freqNum:106.9,logoText:'극동',provider:'FEBC'},
    {id:'bbs',name:'BBS 불교방송',url:'https://bbslive.clouducs.com/bbsradio-live/livestream/playlist.m3u8',freq:'101.9 MHz',freqNum:101.9,logoText:'BBS',provider:'BBS'},
    {id:'cpbc',name:'CPBC 평화방송',url:'https://stream.cpbc.co.kr/cpbc_live/live/playlist.m3u8',freq:'105.3 MHz',freqNum:105.3,logoText:'평화',provider:'CPBC'},
    // === 교통/지역 ===
    {id:'tbn',name:'TBN 교통방송',url:'http://radio2.tbn.or.kr:1935/gyeongin/myStream/playlist.m3u8',freq:'95.1 MHz',freqNum:95.1,logoText:'TBN',provider:'TBN'},
    {id:'obs',name:'OBS 라디오',url:'https://vod3.obs.co.kr:444/live/obsstream1/radio.stream/playlist.m3u8',freq:'90.3 MHz',freqNum:90.3,logoText:'OBS',provider:'OBS'},
    {id:'knn',name:'KNN 러브FM',url:'https://stream1.knn.co.kr/hls/b3y26uu6471k8tes9w7h_lfm/index.m3u8',freq:'99.9 MHz',freqNum:99.9,logoText:'KNN',provider:'KNN'},
    // === 국제 ===
    {id:'arirang',name:'Arirang Radio',url:'http://amdlive-ch01.ctnd.com.edgesuite.net/arirang_3ch/smil:arirang_3ch.smil/playlist.m3u8',freq:'101.3 MHz',freqNum:101.3,logoText:'ARI',provider:'아리랑'}
  ];

  // === Theme Names ===
  var THEME_NAMES = {
    wood: 'WOOD CLASSIC \u00b7 \ub098\ubb34\uacb0',
    cream: 'RETRO CREAM \u00b7 \uac00\uc8fd',
    black: 'MIDNIGHT BLACK \u00b7 \uce74\ubcf8\ud30c\uc774\ubc84',
    military: 'MILITARY \u00b7 \uce94\ubc84\uc2a4',
    silver: 'CHROME SILVER \u00b7 \ube0c\ub7ec\uc2dc\ub4dc\uba54\ud0c8',
    cyber: 'NEON CYBER \u00b7 \ud68c\ub85c\uae30\ud310',
    rose: 'ROSE GOLD \u00b7 \ub300\ub9ac\uc11d',
    maltese: 'MALTESE \u00b7 \ud138 \uacb0'
  };

  // === State ===
  var currentStation = null;
  var audio = null;
  var hlsInstance = null;
  var isPlaying = false;
  var isLoading = false;
  var volume = 0.8;
  var knobAngle = -135 + (0.8 * 270);
  var isPowered = false;
  var currentTheme = 'wood';

  // === Theme ===
  function setTheme(name) {
    currentTheme = name;
    document.getElementById('radioBody').setAttribute('data-theme', name);
    document.body.setAttribute('data-theme', name);
    document.getElementById('themeName').textContent = THEME_NAMES[name] || name.toUpperCase();
    document.querySelectorAll('.theme-dot').forEach(function(d) {
      d.classList.toggle('active', d.getAttribute('data-t') === name);
    });
    try { localStorage.setItem('k-radio-theme', name); } catch(e) {}
  }

  // === Init ===
  async function init() {
    // Restore saved theme
    try {
      var saved = localStorage.getItem('k-radio-theme');
      if (saved && THEME_NAMES[saved]) setTheme(saved);
    } catch(e) {}

    // 클라우드에서 방송국 데이터 로드 시도
    try {
      var r = await supabase.storage.from(BUCKET_NAME).download('_system/stations.json');
      if (r.data) {
        var text = await r.data.text();
        var cloudStations = JSON.parse(text);
        if (cloudStations && cloudStations.length > 0) {
          STATIONS = cloudStations;
        }
      }
    } catch(e) { /* 기본 하드코딩 방송국 사용 */ }

    renderPresets();
    renderEqualizer();
    renderKnobMarks();
    renderFreqTicks();
    updateKnobVisual();
    setupKnobDrag();
    updateClock();
    setInterval(updateClock, 1000);
    loadSavedPhotos();
  }

  // === Render ===
  function renderPresets() {
    var c = document.getElementById('presetButtons');
    c.innerHTML = STATIONS.map(function(s,i) {
      return '<button class="preset-btn" data-id="'+s.id+'" onclick="selectStation(\''+s.id+'\')">' +
        '<span class="preset-num">'+s.logoText+'</span>' +
        '<span class="preset-name">'+s.name.replace(/\s+/g,' ').split(' ')[0]+'</span></button>';
    }).join('');
  }
  function renderEqualizer() {
    var h=''; for(var i=0;i<16;i++) h+='<div class="eq-bar"></div>';
    document.getElementById('equalizer').innerHTML=h;
  }
  function renderKnobMarks() {
    var h=''; for(var i=0;i<11;i++){var a=-135+(i*27);
    h+='<div class="knob-tick" style="transform:rotate('+a+'deg)"></div>';}
    document.getElementById('knobMarks').innerHTML=h;
  }

  // === Freq Ticks ===
  function renderFreqTicks(){
    var el=document.getElementById('freqTicks');if(!el)return;
    var h='';
    for(var f=88;f<=108;f+=0.5){
      var pct=((f-88)/20)*90+5;
      var cls=f%2===0?'freq-tick major':'freq-tick minor';
      h+='<div class="'+cls+'" style="left:'+pct+'%"></div>';
    }
    el.innerHTML=h;
  }

  // === Clock ===
  function updateClock(){
    var now=new Date();
    var h=String(now.getHours()).padStart(2,'0');
    var m=String(now.getMinutes()).padStart(2,'0');
    var s=String(now.getSeconds()).padStart(2,'0');
    var el=document.getElementById('lcdClock');
    if(el) el.textContent=h+':'+m+':'+s;
  }

  // === Power ===
  document.getElementById('powerBtn').addEventListener('click',function(){
    isPowered=!isPowered;
    document.getElementById('powerLed').classList.toggle('on',isPowered);
    if(!isPowered&&audio){
      audio.pause(); setPlayState(false); currentStation=null;
      document.getElementById('lcdIdle').classList.remove('hidden');
      document.getElementById('lcdActive').classList.remove('visible');
      document.getElementById('antenna').classList.remove('active');
      document.querySelectorAll('.preset-btn').forEach(function(b){b.classList.remove('active');});
      updateSignalBars(false);
    }
  });

  // === Select Station ===
  function selectStation(id){
    if(!isPowered){isPowered=true;document.getElementById('powerLed').classList.add('on');}
    var station=STATIONS.find(function(s){return s.id===id;});
    if(!station)return;
    currentStation=station;
    document.querySelectorAll('.preset-btn').forEach(function(b){b.classList.toggle('active',b.dataset.id===id);});
    document.getElementById('lcdIdle').classList.add('hidden');
    document.getElementById('lcdActive').classList.add('visible');
    document.getElementById('lcdProvider').textContent=station.provider;
    document.getElementById('lcdName').textContent=station.name;
    document.getElementById('lcdFreq').textContent=station.freq;
    document.getElementById('lcdStatusText').innerHTML='LOADING...';
    document.getElementById('antenna').classList.add('active');
    var pos=((station.freqNum-88)/20)*90+5;
    document.getElementById('tuningNeedle').style.left=pos+'%';
    updateSignalBars(true);
    loadStream(station.url);
  }

  function updateSignalBars(active){
    document.querySelectorAll('.lcd-signal-bar').forEach(function(bar,i){
      if(active) setTimeout(function(){bar.classList.add('active');},i*150);
      else bar.classList.remove('active');
    });
  }

  // === Audio ===
  function loadStream(url){
    setError(null); setLoadingState(true);
    if(hlsInstance){hlsInstance.destroy();hlsInstance=null;}
    if(!audio) audio=new Audio();
    initAudioContext();
    connectAudioSource();
    if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
    audio.pause(); audio.src=''; audio.volume=volume;
    if(Hls.isSupported()&&url.includes('.m3u8')){
      hlsInstance=new Hls(); hlsInstance.loadSource(url); hlsInstance.attachMedia(audio);
      hlsInstance.on(Hls.Events.MANIFEST_PARSED,function(){
        audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
        setPlayState(true);setLoadingState(false);
        document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
      });
      hlsInstance.on(Hls.Events.ERROR,function(_,data){
        if(data.fatal){setError('방송을 불러올 수 없습니다');setLoadingState(false);setPlayState(false);
        document.getElementById('lcdStatusText').innerHTML='ERROR';updateSignalBars(false);}
      });
    } else if(audio.canPlayType&&audio.canPlayType('application/vnd.apple.mpegurl')){
      audio.src=url;
      audio.addEventListener('loadedmetadata',function h(){audio.removeEventListener('loadedmetadata',h);
        audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
        setPlayState(true);setLoadingState(false);
        document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
      });
    } else {
      audio.src=url;audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
      setPlayState(true);setLoadingState(false);
      document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
    }
  }

  function togglePlay(){
    if(!audio||!currentStation)return;
    if(isPlaying){audio.pause();setPlayState(false);document.getElementById('lcdStatusText').innerHTML='PAUSED';}
    else{audio.play().catch(console.error);setPlayState(true);document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';}
  }

  function setPlayState(playing){
    isPlaying=playing;
    document.getElementById('playIcon').style.display=(!playing&&!isLoading)?'block':'none';
    document.getElementById('pauseIcon').style.display=(playing&&!isLoading)?'block':'none';
    document.getElementById('loaderIcon').style.display=isLoading?'block':'none';
    document.getElementById('playBtn').classList.toggle('playing',playing);
    document.querySelectorAll('.eq-bar').forEach(function(b){b.classList.toggle('playing',playing);});
  }

  function setLoadingState(loading){
    isLoading=loading;
    document.getElementById('playIcon').style.display=(!isPlaying&&!loading)?'block':'none';
    document.getElementById('pauseIcon').style.display=(isPlaying&&!loading)?'block':'none';
    document.getElementById('loaderIcon').style.display=loading?'block':'none';
    document.getElementById('playBtn').disabled=loading;
  }

  function setError(msg){
    var el=document.getElementById('errorMsg');
    if(msg){el.textContent=msg;el.classList.add('visible');}
    else{el.textContent='';el.classList.remove('visible');}
  }

  // === Web Audio API - EQ / Woofer / Virtualizer ===
  var audioCtx = null;
  var sourceNode = null;
  var eqFilters = [];
  var bassBoostFilter = null;
  var virtualizerGain = null;
  var virtualizerDelay = null;
  var masterGain = null;
  var EQ_FREQS = [60, 230, 910, 3600, 14000];
  var eqValues = [0,0,0,0,0];
  var wooferValue = 0;
  var virtualizerValue = 0;

  function initAudioContext(){
    if(audioCtx) return;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // Create 5-band EQ filters
    EQ_FREQS.forEach(function(freq, i){
      var filter = audioCtx.createBiquadFilter();
      filter.type = 'peaking';
      filter.frequency.value = freq;
      filter.Q.value = 1.4;
      filter.gain.value = 0;
      eqFilters.push(filter);
    });

    // Bass boost (lowshelf)
    bassBoostFilter = audioCtx.createBiquadFilter();
    bassBoostFilter.type = 'lowshelf';
    bassBoostFilter.frequency.value = 100;
    bassBoostFilter.gain.value = 0;

    // Virtualizer (delay-based stereo widening)
    virtualizerDelay = audioCtx.createDelay(0.05);
    virtualizerDelay.delayTime.value = 0;
    virtualizerGain = audioCtx.createGain();
    virtualizerGain.gain.value = 0;

    // Master gain
    masterGain = audioCtx.createGain();
    masterGain.gain.value = 1;

    // Chain: EQ[0] → EQ[1] → ... → EQ[4] → bassBoost → masterGain → destination
    for(var i=0; i<eqFilters.length-1; i++){
      eqFilters[i].connect(eqFilters[i+1]);
    }
    eqFilters[eqFilters.length-1].connect(bassBoostFilter);
    bassBoostFilter.connect(masterGain);

    // Virtualizer: parallel path with delay
    bassBoostFilter.connect(virtualizerDelay);
    virtualizerDelay.connect(virtualizerGain);
    virtualizerGain.connect(masterGain);

    masterGain.connect(audioCtx.destination);

    // Restore saved settings
    restoreEQSettings();
  }

  function connectAudioSource(){
    if(!audio || !audioCtx || sourceNode) return;
    try {
      sourceNode = audioCtx.createMediaElementSource(audio);
      sourceNode.connect(eqFilters[0]);
    } catch(e) { console.log('Audio source already connected'); }
  }

  function updateEQ(band, val){
    val = parseFloat(val);
    eqValues[band] = val;
    if(eqFilters[band]) eqFilters[band].gain.value = val;
    var label = document.getElementById('eqDb'+band);
    if(label) label.textContent = (val>0?'+':'')+val;
    saveEQSettings();
  }

  function updateWoofer(val){
    wooferValue = parseFloat(val);
    if(bassBoostFilter) bassBoostFilter.gain.value = wooferValue;
    document.getElementById('wooferValue').textContent = val;
    saveEQSettings();
  }

  function updateVirtualizer(val){
    virtualizerValue = parseFloat(val);
    if(virtualizerDelay) virtualizerDelay.delayTime.value = (virtualizerValue / 100) * 0.025;
    if(virtualizerGain) virtualizerGain.gain.value = virtualizerValue / 100 * 0.6;
    document.getElementById('virtualizerValue').textContent = val;
    saveEQSettings();
  }

  function resetEQ(){
    eqValues = [0,0,0,0,0];
    wooferValue = 0; virtualizerValue = 0;
    eqFilters.forEach(function(f,i){ f.gain.value = 0; });
    if(bassBoostFilter) bassBoostFilter.gain.value = 0;
    if(virtualizerDelay) virtualizerDelay.delayTime.value = 0;
    if(virtualizerGain) virtualizerGain.gain.value = 0;
    // Reset UI
    document.querySelectorAll('.eq-slider-wrap input').forEach(function(s){ s.value = 0; });
    for(var i=0;i<5;i++){ var l=document.getElementById('eqDb'+i); if(l) l.textContent='0'; }
    document.getElementById('wooferSlider').value = 0;
    document.getElementById('wooferValue').textContent = '0';
    document.getElementById('virtualizerSlider').value = 0;
    document.getElementById('virtualizerValue').textContent = '0';
    saveEQSettings();
  }

  function toggleEqPanel(){
    var panel = document.getElementById('eqPanel');
    var btn = document.getElementById('eqToggleBtn');
    var visible = panel.style.display !== 'none';
    panel.style.display = visible ? 'none' : 'block';
    btn.classList.toggle('active', !visible);
  }

  function saveEQSettings(){
    try {
      localStorage.setItem('radio-eq', JSON.stringify({
        eq: eqValues, woofer: wooferValue, virtualizer: virtualizerValue
      }));
    } catch(e){}
  }

  function restoreEQSettings(){
    try {
      var saved = JSON.parse(localStorage.getItem('radio-eq'));
      if(!saved) return;
      if(saved.eq){
        saved.eq.forEach(function(v,i){
          eqValues[i] = v;
          if(eqFilters[i]) eqFilters[i].gain.value = v;
          var slider = document.querySelector('.eq-slider-wrap input[data-eq="'+i+'"]');
          if(slider) slider.value = v;
          var label = document.getElementById('eqDb'+i);
          if(label) label.textContent = (v>0?'+':'')+v;
        });
      }
      if(saved.woofer !== undefined){
        wooferValue = saved.woofer;
        if(bassBoostFilter) bassBoostFilter.gain.value = wooferValue;
        document.getElementById('wooferSlider').value = wooferValue;
        document.getElementById('wooferValue').textContent = wooferValue;
      }
      if(saved.virtualizer !== undefined){
        virtualizerValue = saved.virtualizer;
        updateVirtualizer(virtualizerValue);
        document.getElementById('virtualizerSlider').value = virtualizerValue;
      }
    } catch(e){}
  }

  // === Photo Selection Screen & Placement ===
  var DEFAULT_PHOTOS = ['maltese.jpg','photo1.jpg','photo2.jpg','photo5.jpg','photo3.jpg','photo4.jpg'];
  var slotPhotos = [null,null,null,null,null,null];
  var activeSlotIdx = -1;

  function pickSlotPhoto(idx){
    activeSlotIdx = idx;
    var inp = document.getElementById('slotFileInput');
    inp.value = '';
    inp.onchange = function(){
      if(!this.files||!this.files[0]) return;
      var reader = new FileReader();
      reader.onload = function(e){
        slotPhotos[activeSlotIdx] = e.target.result;
        updateSlotUI(activeSlotIdx);
        updatePhotoCount();
      };
      reader.readAsDataURL(this.files[0]);
    };
    inp.click();
  }

  function removeSlotPhoto(idx, evt){
    evt.stopPropagation();
    slotPhotos[idx] = null;
    updateSlotUI(idx);
    updatePhotoCount();
  }

  function updateSlotUI(idx){
    var slot = document.querySelectorAll('.photo-slot')[idx];
    if(!slot) return;
    if(slotPhotos[idx]){
      slot.classList.add('filled');
      var labels = ['상단 1','상단 2','상단 3','상단 4','하단 좌','하단 우'];
      slot.innerHTML = '<img src="'+slotPhotos[idx]+'" alt="사진'+(idx+1)+'">' +
        '<button class="remove-photo" onclick="removeSlotPhoto('+idx+',event)">&times;</button>' +
        '<div class="slot-label">'+labels[idx]+'</div>';
    } else {
      slot.classList.remove('filled');
      var labels = ['상단 1','상단 2','상단 3','상단 4','하단 좌','하단 우'];
      slot.innerHTML = '<span class="slot-icon">+</span><div class="slot-label">'+labels[idx]+'</div>';
    }
  }

  function pickAllPhotos(){
    var inp = document.getElementById('batchFileInput');
    inp.value = '';
    inp.onchange = function(){
      if(!this.files||this.files.length===0) return;
      var files = Array.from(this.files).slice(0,6);
      var loaded = 0;
      files.forEach(function(file, i){
        var reader = new FileReader();
        reader.onload = function(e){
          slotPhotos[i] = e.target.result;
          updateSlotUI(i);
          loaded++;
          if(loaded === files.length){
            // 6장 미만이면 나머지 슬롯 비움
            for(var j=files.length; j<6; j++){
              slotPhotos[j] = null;
              updateSlotUI(j);
            }
            updatePhotoCount();
          }
        };
        reader.readAsDataURL(file);
      });
    };
    inp.click();
  }

  function resetPhotos(){
    for(var i=0; i<6; i++){
      slotPhotos[i] = null;
      updateSlotUI(i);
    }
    updatePhotoCount();
  }

  function updatePhotoCount(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    document.getElementById('photoCount').textContent = count + ' / 6';
    var btn = document.getElementById('photoDoneBtn');
    var saveBtn = document.getElementById('photoSaveBtn');
    if(count === 6) {
      btn.classList.add('ready');
      saveBtn.classList.add('ready');
    } else {
      btn.classList.remove('ready');
      saveBtn.classList.remove('ready');
    }
  }

  // === 사용자 로그인 ===
  var currentUsername = '';
  var selectedUser = '';

  // === About Modal ===
  function showAbout(e){
    if(e) e.preventDefault();
    document.getElementById('aboutModal').classList.add('visible');
  }
  function hideAbout(e){
    if(e && e.target !== document.getElementById('aboutModal')) return;
    document.getElementById('aboutModal').classList.remove('visible');
  }

  var cachedUsers = null;

  function getUsers(){
    if(cachedUsers) return cachedUsers;
    return JSON.parse(localStorage.getItem('radioUsers') || '{}');
  }

  async function loadUsersFromCloud(){
    try {
      var { data, error } = await supabase.storage.from(BUCKET_NAME).download('_system/users.json');
      if(data){
        var text = await data.text();
        var users = JSON.parse(text);
        cachedUsers = users;
        localStorage.setItem('radioUsers', JSON.stringify(users));
        return users;
      }
    } catch(e){ console.log('클라우드 사용자 로드 실패:', e); }
    return getUsers();
  }

  async function saveUsersToCloud(users){
    try {
      var blob = new Blob([JSON.stringify(users)], {type: 'application/json'});
      await supabase.storage.from(BUCKET_NAME).upload('_system/users.json', blob, { upsert: true });
    } catch(e){ console.log('클라우드 사용자 저장 실패:', e); }
  }

  function renderUserList(filter){
    var users = getUsers();
    var userNames = Object.keys(users);
    var listEl = document.getElementById('userList');

    // 필터 적용
    if(filter && filter.trim()){
      var keyword = filter.trim().toLowerCase();
      userNames = userNames.filter(function(name){
        return name.toLowerCase().indexOf(keyword) !== -1;
      });
    }

    if(userNames.length === 0){
      var msg = filter ? '검색 결과가 없습니다' : '등록된 사용자가 없습니다';
      listEl.innerHTML = '<div class="no-users">' + msg + '</div>';
    } else {
      listEl.innerHTML = '';
      userNames.forEach(function(name){
        var item = document.createElement('div');
        item.className = 'user-item';
        item.innerHTML = '<span class="user-item-icon">👤</span><span class="user-item-name">' + name + '</span>';
        item.onclick = function(){ selectUser(name); };
        listEl.appendChild(item);
      });
    }
  }

  function filterUsers(){
    var searchInput = document.getElementById('userSearchInput');
    renderUserList(searchInput.value);
  }

  function selectUser(name){
    selectedUser = name;
    document.getElementById('selectedUserName').textContent = name;
    document.getElementById('userSelectBox').classList.add('hidden');
    document.getElementById('passwordBox').classList.remove('hidden');
    document.getElementById('passwordInput').value = '';
    document.getElementById('passwordInput').focus();
  }

  function showUserSelect(){
    document.getElementById('userSelectBox').classList.remove('hidden');
    document.getElementById('passwordBox').classList.add('hidden');
    document.getElementById('newUserBox').classList.add('hidden');
    document.getElementById('userSearchInput').value = '';
    renderUserList();
  }

  function showNewUserForm(){
    document.getElementById('userSelectBox').classList.add('hidden');
    document.getElementById('newUserBox').classList.remove('hidden');
    document.getElementById('newUsernameInput').value = '';
    document.getElementById('newPasswordInput').value = '';
    document.getElementById('newUsernameInput').focus();
  }

  function submitPassword(){
    var passInput = document.getElementById('passwordInput');
    var pass = passInput.value.trim();

    if(!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)){
      alert('비밀번호 4자리 숫자를 입력해주세요.');
      passInput.focus();
      return;
    }

    var users = getUsers();
    if(users[selectedUser] !== pass){
      alert('비밀번호가 일치하지 않습니다.');
      passInput.value = '';
      passInput.focus();
      return;
    }

    currentUsername = selectedUser;
    localStorage.setItem('radioUsername', selectedUser);
    document.getElementById('userLoginScreen').classList.add('hidden');
    document.getElementById('photoSelectScreen').classList.remove('hidden');
  }

  async function registerNewUser(){
    var nameInput = document.getElementById('newUsernameInput');
    var passInput = document.getElementById('newPasswordInput');
    var name = nameInput.value.trim();
    var pass = passInput.value.trim();

    if(!name){
      alert('이름을 입력해주세요.');
      nameInput.focus();
      return;
    }
    if(!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)){
      alert('비밀번호 4자리 숫자를 입력해주세요.');
      passInput.focus();
      return;
    }

    var users = getUsers();
    if(users[name]){
      alert('이미 등록된 사용자입니다.');
      return;
    }

    users[name] = pass;
    cachedUsers = users;
    localStorage.setItem('radioUsers', JSON.stringify(users));
    await saveUsersToCloud(users);

    currentUsername = name;
    localStorage.setItem('radioUsername', name);
    document.getElementById('userLoginScreen').classList.add('hidden');
    document.getElementById('photoSelectScreen').classList.remove('hidden');
  }

  // Enter 키로 제출 및 숫자만 입력
  document.addEventListener('DOMContentLoaded', function(){
    var passInput = document.getElementById('passwordInput');
    var newPassInput = document.getElementById('newPasswordInput');

    [passInput, newPassInput].forEach(function(input){
      if(input){
        input.addEventListener('input', function(){
          this.value = this.value.replace(/[^0-9]/g, '');
        });
      }
    });

    if(passInput){
      passInput.addEventListener('keypress', function(e){
        if(e.key === 'Enter') submitPassword();
      });
    }
    if(newPassInput){
      newPassInput.addEventListener('keypress', function(e){
        if(e.key === 'Enter') registerNewUser();
      });
    }

    // 클라우드에서 사용자 목록 로드 후 렌더링
    loadUsersFromCloud().then(function(){
      renderUserList();
    });
  });

  // === 한글을 안전한 경로로 변환 ===
  function toSafePath(str){
    return str.split('').map(function(c){
      var code = c.charCodeAt(0);
      if((code >= 48 && code <= 57) || (code >= 65 && code <= 90) || (code >= 97 && code <= 122) || c === '-' || c === '_'){
        return c;
      }
      return '_' + code.toString(16) + '_';
    }).join('');
  }
  function fromSafePath(str){
    return str.replace(/_([0-9a-f]+)_/gi, function(m, hex){
      return String.fromCharCode(parseInt(hex, 16));
    });
  }

  // === Supabase 설정 ===
  var SUPABASE_URL = 'https://haxcktfnuudlqciyljtp.supabase.co';
  var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhheGNrdGZudXVkbHFjaXlsanRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDUwNDAsImV4cCI6MjA4NDg4MTA0MH0.suN7BeaHx3MjaNlMDQa0940P-rMl2XPyk4ksoQEU3YM';
  var supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
  var BUCKET_NAME = 'photo-albums';

  // base64를 Blob으로 변환
  function dataURLtoBlob(dataURL) {
    var arr = dataURL.split(',');
    var mime = arr[0].match(/:(.*?);/)[1];
    var bstr = atob(arr[1]);
    var n = bstr.length;
    var u8arr = new Uint8Array(n);
    while(n--) u8arr[n] = bstr.charCodeAt(n);
    return new Blob([u8arr], {type: mime});
  }

  // === 사진첩 API (Supabase) ===
  async function savePhotosToAlbum(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    if(count < 6) {
      alert('6장의 사진을 모두 선택해주세요.');
      return;
    }

    var albumName = prompt('사진첩 이름을 입력하세요:', '');
    if(!albumName || !albumName.trim()) return;
    albumName = albumName.trim();

    try {
      for(var i = 0; i < 6; i++){
        var dataUrl = slotPhotos[i];
        var mimeMatch = dataUrl.match(/data:(image\/\w+);/);
        var ext = 'jpg';
        if(mimeMatch && mimeMatch[1]){
          var mime = mimeMatch[1];
          if(mime === 'image/png') ext = 'png';
          else if(mime === 'image/gif') ext = 'gif';
          else if(mime === 'image/webp') ext = 'webp';
        }
        var fileName = toSafePath(currentUsername) + '/' + toSafePath(albumName) + '/photo_' + (i + 1) + '.' + ext;
        var blob = dataURLtoBlob(dataUrl);

        var { error } = await supabase.storage
          .from(BUCKET_NAME)
          .upload(fileName, blob, { upsert: true });

        if(error) throw error;
      }

      alert('사진첩 "' + albumName + '"에 6장의 사진이 저장되었습니다!');
    } catch(e) {
      console.error(e);
      alert('저장 중 오류가 발생했습니다: ' + e.message);
    }
  }

  async function showAlbumList(){
    try {
      // 현재 사용자의 폴더에서 사진첩 목록 가져오기
      var encodedUser = toSafePath(currentUsername);
      var { data, error } = await supabase.storage
        .from(BUCKET_NAME)
        .list(encodedUser, { limit: 100 });

      if(error) throw error;

      // 폴더(사진첩) 목록 추출
      var albumMap = {};
      for(var i = 0; i < data.length; i++){
        var item = data[i];
        if(item.name && !item.id) {
          // 폴더인 경우 - 디코딩해서 표시
          var decodedName = fromSafePath(item.name);
          albumMap[item.name] = { name: item.name, displayName: decodedName, count: 0 };
        }
      }

      // 각 폴더의 파일 개수 확인
      var albumNames = Object.keys(albumMap);
      for(var j = 0; j < albumNames.length; j++){
        var name = albumNames[j];
        var { data: files } = await supabase.storage
          .from(BUCKET_NAME)
          .list(encodedUser + '/' + name, { limit: 10 });
        if(files) albumMap[name].count = files.length;
      }

      var albums = Object.values(albumMap).filter(function(a){ return a.count > 0; });

      var popup = document.getElementById('albumListPopup');
      var content = document.getElementById('albumListContent');

      if(albums.length === 0){
        content.innerHTML = '<div class="album-list-empty">저장된 사진첩이 없습니다.<br>먼저 사진을 저장해주세요.</div>';
      } else {
        content.innerHTML = '';
        albums.forEach(function(album){
          var item = document.createElement('div');
          item.className = 'album-item';
          item.innerHTML = '<span class="album-item-icon">📁</span>' +
            '<span class="album-item-name">' + album.displayName + '</span>' +
            '<span class="album-item-count">' + album.count + '장</span>';
          item.onclick = function(){ loadAlbum(album.name); };
          content.appendChild(item);
        });
      }

      popup.classList.add('visible');
    } catch(e) {
      console.error(e);
      alert('사진첩 목록을 불러오는 중 오류가 발생했습니다: ' + e.message);
    }
  }

  function hideAlbumList(){
    document.getElementById('albumListPopup').classList.remove('visible');
  }

  async function loadAlbum(albumName){
    try {
      var userAlbumPath = toSafePath(currentUsername) + '/' + albumName;
      var { data: files, error } = await supabase.storage
        .from(BUCKET_NAME)
        .list(userAlbumPath, { limit: 10 });

      if(error) throw error;

      // photo_1, photo_2 순으로 정렬
      files.sort(function(a, b){
        var matchA = a.name.match(/photo_(\d+)/i);
        var matchB = b.name.match(/photo_(\d+)/i);
        if(matchA && matchB) return parseInt(matchA[1]) - parseInt(matchB[1]);
        return a.name.localeCompare(b.name);
      });

      var imageFiles = files.filter(function(f){
        return /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name);
      }).slice(0, 6);

      if(imageFiles.length === 0){
        alert('사진첩에 이미지 파일이 없습니다.');
        return;
      }

      // 슬롯 초기화
      slotPhotos = [null, null, null, null, null, null];

      // 파일 로드
      for(var i = 0; i < imageFiles.length; i++){
        var filePath = userAlbumPath + '/' + imageFiles[i].name;
        var { data } = supabase.storage
          .from(BUCKET_NAME)
          .getPublicUrl(filePath);

        // 이미지를 dataURL로 변환
        var response = await fetch(data.publicUrl);
        var blob = await response.blob();
        var dataUrl = await new Promise(function(resolve){
          var reader = new FileReader();
          reader.onload = function(e){ resolve(e.target.result); };
          reader.readAsDataURL(blob);
        });

        slotPhotos[i] = dataUrl;
        updateSlotUI(i);
      }

      // 나머지 슬롯 초기화
      for(var j = imageFiles.length; j < 6; j++){
        updateSlotUI(j);
      }

      updatePhotoCount();
      hideAlbumList();
      alert('사진첩 "' + albumName + '"에서 ' + imageFiles.length + '장을 불러왔습니다!');
    } catch(e) {
      console.error(e);
      alert('불러오기 중 오류가 발생했습니다: ' + e.message);
    }
  }

  function completePhotoSelect(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    if(count < 6) return;
    try{ localStorage.setItem('radioUserPhotos', JSON.stringify(slotPhotos)); }catch(e){}
    showRadioScreen(slotPhotos);
  }

  function skipPhotoSelect(){
    showRadioScreen(DEFAULT_PHOTOS);
  }

  function showRadioScreen(photos){
    var screen = document.getElementById('photoSelectScreen');
    screen.classList.add('hiding');
    setTimeout(function(){
      screen.classList.add('hidden');
    }, 500);
    renderUserPhotos(photos);
    // [+] 버튼 표시
    document.getElementById('photoUploadBtn').classList.add('has-photos');
  }

  function reopenPhotoSelect(){
    // 사진 선택 화면 다시 열기
    slotPhotos = [null,null,null,null,null,null];
    var screen = document.getElementById('photoSelectScreen');
    screen.classList.remove('hidden','hiding');
    // 슬롯 UI 초기화
    for(var i=0;i<6;i++) updateSlotUI(i);
    updatePhotoCount();
  }

  function renderUserPhotos(photos){
    var bp=document.getElementById('brandPhotos');
    bp.innerHTML='';
    for(var i=0;i<4&&i<photos.length;i++){
      var img=document.createElement('img');
      img.className='brand-mascot';
      img.style.display='block';
      img.src=photos[i]; img.alt='사진'+(i+1);
      img.width=34; img.height=34;
      img.style.cursor='pointer';
      img.onclick=(function(s){return function(){openLightbox(s)}})(photos[i]);
      bp.appendChild(img);
    }
    var cl=document.getElementById('ctrlPhotoLeft');
    cl.innerHTML='';
    if(photos.length>4){
      var il=document.createElement('img');
      il.className='ctrl-mascot';
      il.style.display='block';
      il.src=photos[4]; il.alt='사진5';
      il.style.cursor='pointer';
      il.onclick=(function(s){return function(){openLightbox(s)}})(photos[4]);
      cl.appendChild(il);
    }
    var cr=document.getElementById('ctrlPhotoRight');
    cr.innerHTML='';
    if(photos.length>5){
      var ir=document.createElement('img');
      ir.className='ctrl-mascot';
      ir.style.display='block';
      ir.src=photos[5]; ir.alt='사진6';
      ir.style.cursor='pointer';
      ir.onclick=(function(s){return function(){openLightbox(s)}})(photos[5]);
      cr.appendChild(ir);
    }
  }

  function loadSavedPhotos(){
    // 항상 사진 선택 화면을 먼저 표시
    // 저장된 사진이 있으면 슬롯에 미리 채워둠
    try{
      var saved=localStorage.getItem('radioUserPhotos');
      if(saved){
        var photos = JSON.parse(saved);
        slotPhotos = photos.slice();
        for(var i=0;i<6;i++) updateSlotUI(i);
        updatePhotoCount();
      }
    }catch(e){}
    renderUserPhotos(DEFAULT_PHOTOS);
    document.getElementById('photoUploadBtn').classList.add('has-photos');
  }

  // === Photo Lightbox ===
  function openLightbox(src){
    var lb=document.getElementById('photoLightbox');
    document.getElementById('lightboxImg').src=src;
    lb.classList.add('visible');
  }
  function closeLightbox(){
    document.getElementById('photoLightbox').classList.remove('visible');
  }

  // === Volume Knob ===
  function setupKnobDrag(){
    var knob=document.getElementById('volumeKnob');
    var container=document.getElementById('knobContainer');
    var isDragging=false;
    function getAngle(e){
      var r=container.getBoundingClientRect();
      var cx=r.left+r.width/2, cy=r.top+r.height/2;
      var x=e.touches?e.touches[0].clientX:e.clientX;
      var y=e.touches?e.touches[0].clientY:e.clientY;
      return Math.atan2(y-cy,x-cx)*(180/Math.PI)+90;
    }
    function handleMove(e){
      if(!isDragging)return; e.preventDefault();
      var a=getAngle(e); if(a>180)a-=360;
      knobAngle=Math.max(-135,Math.min(135,a));
      volume=(knobAngle+135)/270;
      if(audio)audio.volume=volume;
      updateKnobVisual();
    }
    knob.addEventListener('mousedown',function(e){isDragging=true;e.preventDefault();});
    knob.addEventListener('touchstart',function(){isDragging=true;},{passive:true});
    document.addEventListener('mousemove',handleMove);
    document.addEventListener('touchmove',handleMove,{passive:false});
    document.addEventListener('mouseup',function(){isDragging=false;});
    document.addEventListener('touchend',function(){isDragging=false;});
    container.addEventListener('wheel',function(e){
      e.preventDefault();
      volume=Math.max(0,Math.min(1,volume+(e.deltaY>0?-0.05:0.05)));
      knobAngle=-135+(volume*270);
      if(audio)audio.volume=volume;
      updateKnobVisual();
    },{passive:false});
  }

  function updateKnobVisual(){
    document.getElementById('volumeKnob').style.transform='rotate('+knobAngle+'deg)';
  }

  document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
