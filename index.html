<!DOCTYPE html>
<html lang="ko" style="background:#1a1a2e">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>클라라 라디오카페 | 대한민국 실시간 라디오</title>
  <meta property="og:type" content="website" />
  <meta property="og:title" content="클라라 라디오카페" />
  <meta property="og:description" content="대한민국 실시간 라디오를 디지털 & 아날로그로 즐기세요. 타로, 오늘의 운세, 같이듣기까지!" />
  <meta property="og:image" content="https://jaiwshim-project.github.io/37-RadioCafe/og-image.jpg" />
  <meta property="og:url" content="https://jaiwshim-project.github.io/37-RadioCafe/" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap"></noscript>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    /* ============================================
       7 RADIO DESIGN THEMES
       ============================================ */

    /* 1. Wood Classic (우드 클래식) */
    :root, [data-theme="wood"] {
      --bg: #1a1a2e;
      --body-out1: #3a2a1a; --body-out2: #2a1c0e;
      --body-in1: #2c1e10; --body-in2: #1e140a;
      --texture-color: rgba(255,200,100,0.015);
      --accent: #d4a862;
      --accent-glow: rgba(212,168,98,0.5);
      --btn-bg1: #3a2a1a; --btn-bg2: #2a1c10;
      --btn-hi1: #4a3a28; --btn-hi2: #2a1c10;
      --btn-active1: #5a4020; --btn-active2: #3a2a1a;
      --btn-border: #1a120a;
      --speaker-bg: #1a120a; --speaker-border: #0e0a06;
      --mesh-color: rgba(200,180,140,0.12);
      --lcd-bg: #0a1a0a;
      --lcd-text: #55ff55; --lcd-dim: #3abf3a; --lcd-idle: #2a8a2a;
      --lcd-glow: rgba(85,255,85,0.6);
      --screw1: #5a4a38; --screw2: #3a2a1a; --screw-line: #1a120a;
      --label-color: #c8b8a0; --freq-mark: #a08868;
      --tick-color: #8a7a60;
      --needle: #ff3333; --needle-glow: rgba(255,51,51,0.6);
      --led-on: #00ff88; --led-glow: rgba(0,255,136,0.3);
      --knob-ind: #d4a862;
      --footer-color: #a09080; --footer-link: #c8b8a0;
      --antenna1: #8a7a6a; --antenna2: #c0b0a0;
      --preset-num: #c8b8a0; --preset-name: #b0a088;
      --power-icon: #c8b8a0;
      --neon-border: #ff9933; --neon-glow: rgba(255,153,51,0.6);
      --neon-light: rgba(255,180,100,0.35); --neon-light-glow: rgba(255,180,100,0.15);
    }

    /* 2. Retro Cream (레트로 크림) */
    [data-theme="cream"] {
      --bg: #d4c5a9;
      --body-out1: #f5e6c8; --body-out2: #e8d5b0;
      --body-in1: #ede0c8; --body-in2: #e2d1b0;
      --texture-color: rgba(180,140,80,0.03);
      --accent: #8b4513;
      --accent-glow: rgba(139,69,19,0.4);
      --btn-bg1: #e8d5b0; --btn-bg2: #d4c09a;
      --btn-hi1: #f0e0c0; --btn-hi2: #d4c09a;
      --btn-active1: #c9a96e; --btn-active2: #b89858;
      --btn-border: #b89858;
      --speaker-bg: #c9a96e; --speaker-border: #a88640;
      --mesh-color: rgba(100,60,20,0.08);
      --lcd-bg: #2a1a0a;
      --lcd-text: #ffcc55; --lcd-dim: #cc8833; --lcd-idle: #aa6600;
      --lcd-glow: rgba(255,204,85,0.6);
      --screw1: #c9a96e; --screw2: #a88640; --screw-line: #8a6a30;
      --label-color: #5a3e20; --freq-mark: #6a4e30;
      --tick-color: #7a5e40;
      --needle: #cc0000; --needle-glow: rgba(204,0,0,0.5);
      --led-on: #ff6600; --led-glow: rgba(255,102,0,0.3);
      --knob-ind: #8b4513;
      --footer-color: #6a4e30; --footer-link: #5a3e20;
      --antenna1: #a88640; --antenna2: #c9a96e;
      --preset-num: #5a3820; --preset-name: #6a4e30;
      --power-icon: #5a3e20;
      --neon-border: #ff6600; --neon-glow: rgba(255,102,0,0.5);
      --neon-light: rgba(255,140,60,0.3); --neon-light-glow: rgba(255,140,60,0.12);
    }

    /* 3. Midnight Black (미드나잇 블랙) */
    [data-theme="black"] {
      --bg: #0a0a0a;
      --body-out1: #222222; --body-out2: #111111;
      --body-in1: #1a1a1a; --body-in2: #0e0e0e;
      --texture-color: rgba(255,255,255,0.008);
      --accent: #ffffff;
      --accent-glow: rgba(255,255,255,0.3);
      --btn-bg1: #1e1e1e; --btn-bg2: #0e0e0e;
      --btn-hi1: #2a2a2a; --btn-hi2: #151515;
      --btn-active1: #333333; --btn-active2: #1a1a1a;
      --btn-border: #080808;
      --speaker-bg: #0a0a0a; --speaker-border: #050505;
      --mesh-color: rgba(255,255,255,0.04);
      --lcd-bg: #000000;
      --lcd-text: #ffffff; --lcd-dim: #999999; --lcd-idle: #666666;
      --lcd-glow: rgba(255,255,255,0.4);
      --screw1: #2a2a2a; --screw2: #1a1a1a; --screw-line: #080808;
      --label-color: #aaaaaa; --freq-mark: #888888;
      --tick-color: #777777;
      --needle: #ff0044; --needle-glow: rgba(255,0,68,0.6);
      --led-on: #ff0044; --led-glow: rgba(255,0,68,0.3);
      --knob-ind: #ffffff;
      --footer-color: #888888; --footer-link: #aaaaaa;
      --antenna1: #444444; --antenna2: #666666;
      --preset-num: #bbbbbb; --preset-name: #999999;
      --power-icon: #aaaaaa;
      --neon-border: #ff0044; --neon-glow: rgba(255,0,68,0.6);
      --neon-light: rgba(255,80,120,0.3); --neon-light-glow: rgba(255,80,120,0.12);
    }

    /* 4. Military (밀리터리) */
    [data-theme="military"] {
      --bg: #1a2016;
      --body-out1: #4a5540; --body-out2: #354030;
      --body-in1: #3d4a34; --body-in2: #2e3828;
      --texture-color: rgba(100,120,80,0.02);
      --accent: #c8b400;
      --accent-glow: rgba(200,180,0,0.4);
      --btn-bg1: #3d4a34; --btn-bg2: #2e3828;
      --btn-hi1: #4a5a40; --btn-hi2: #354530;
      --btn-active1: #556840; --btn-active2: #3d4a34;
      --btn-border: #1e2818;
      --speaker-bg: #222c1e; --speaker-border: #1a2216;
      --mesh-color: rgba(150,170,120,0.08);
      --lcd-bg: #0a120a;
      --lcd-text: #55ff55; --lcd-dim: #33cc33; --lcd-idle: #22aa22;
      --lcd-glow: rgba(85,255,85,0.6);
      --screw1: #5a6a4a; --screw2: #3d4a34; --screw-line: #1e2818;
      --label-color: #b0c090; --freq-mark: #90a870;
      --tick-color: #80986a;
      --needle: #ff3300; --needle-glow: rgba(255,51,0,0.6);
      --led-on: #33ff33; --led-glow: rgba(51,255,51,0.3);
      --knob-ind: #c8b400;
      --footer-color: #90a870; --footer-link: #b0c090;
      --antenna1: #5a6a4a; --antenna2: #8a9a7a;
      --preset-num: #b8d098; --preset-name: #a0b880;
      --power-icon: #b0c090;
      --neon-border: #39ff14; --neon-glow: rgba(57,255,20,0.5);
      --neon-light: rgba(120,255,80,0.3); --neon-light-glow: rgba(120,255,80,0.12);
    }

    /* 5. Chrome Silver (크롬 실버) */
    [data-theme="silver"] {
      --bg: #2a2a3a;
      --body-out1: #c0c0cc; --body-out2: #9a9aaa;
      --body-in1: #b0b0be; --body-in2: #8a8a9a;
      --texture-color: rgba(255,255,255,0.02);
      --accent: #1a1a2a;
      --accent-glow: rgba(26,26,42,0.3);
      --btn-bg1: #a0a0b0; --btn-bg2: #808090;
      --btn-hi1: #b8b8c8; --btn-hi2: #909098;
      --btn-active1: #7070a0; --btn-active2: #5a5a80;
      --btn-border: #6a6a7a;
      --speaker-bg: #5a5a6a; --speaker-border: #4a4a5a;
      --mesh-color: rgba(200,200,220,0.1);
      --lcd-bg: #0a0a1a;
      --lcd-text: #66ccff; --lcd-dim: #4499dd; --lcd-idle: #2277bb;
      --lcd-glow: rgba(102,204,255,0.6);
      --screw1: #c8c8d8; --screw2: #a0a0b0; --screw-line: #6a6a7a;
      --label-color: #b0b0c0; --freq-mark: #9090a0;
      --tick-color: #8888a0;
      --needle: #ff2222; --needle-glow: rgba(255,34,34,0.6);
      --led-on: #44aaff; --led-glow: rgba(68,170,255,0.3);
      --knob-ind: #1a1a2a;
      --footer-color: #9090a0; --footer-link: #b0b0c0;
      --antenna1: #9a9aaa; --antenna2: #d0d0dd;
      --preset-num: #c0c0d0; --preset-name: #a8a8b8;
      --power-icon: #b0b0c0;
      --neon-border: #4488ff; --neon-glow: rgba(68,136,255,0.5);
      --neon-light: rgba(120,170,255,0.3); --neon-light-glow: rgba(120,170,255,0.12);
    }

    /* 6. Neon Cyber (네온 사이버) */
    [data-theme="cyber"] {
      --bg: #05050f;
      --body-out1: #15152a; --body-out2: #0a0a18;
      --body-in1: #101025; --body-in2: #08081a;
      --texture-color: rgba(0,200,255,0.008);
      --accent: #00e5ff;
      --accent-glow: rgba(0,229,255,0.5);
      --btn-bg1: #12122a; --btn-bg2: #0a0a1a;
      --btn-hi1: #1a1a38; --btn-hi2: #0e0e22;
      --btn-active1: #1a1a48; --btn-active2: #101030;
      --btn-border: #0a0a18;
      --speaker-bg: #08081a; --speaker-border: #050510;
      --mesh-color: rgba(0,229,255,0.06);
      --lcd-bg: #020210;
      --lcd-text: #00ffff; --lcd-dim: #00aacc; --lcd-idle: #0088aa;
      --lcd-glow: rgba(0,255,255,0.7);
      --screw1: #1a1a38; --screw2: #101025; --screw-line: #050510;
      --label-color: #00bbdd; --freq-mark: #0099bb;
      --tick-color: #0088aa;
      --needle: #ff00aa; --needle-glow: rgba(255,0,170,0.7);
      --led-on: #ff00aa; --led-glow: rgba(255,0,170,0.4);
      --knob-ind: #00e5ff;
      --footer-color: #0099bb; --footer-link: #00bbdd;
      --antenna1: #006688; --antenna2: #00aacc;
      --preset-num: #00ccee; --preset-name: #00aacc;
      --power-icon: #00bbdd;
      --neon-border: #00e5ff; --neon-glow: rgba(0,229,255,0.6);
      --neon-light: rgba(80,230,255,0.3); --neon-light-glow: rgba(80,230,255,0.12);
    }

    /* 7. Rose Gold (로즈 골드) */
    [data-theme="rose"] {
      --bg: #1a1018;
      --body-out1: #8a6070; --body-out2: #6a4050;
      --body-in1: #7a5565; --body-in2: #5a3545;
      --texture-color: rgba(255,180,200,0.015);
      --accent: #ffc8d0;
      --accent-glow: rgba(255,200,208,0.4);
      --btn-bg1: #6a4858; --btn-bg2: #5a3545;
      --btn-hi1: #7a5565; --btn-hi2: #5a3a4a;
      --btn-active1: #8a5a6a; --btn-active2: #6a4858;
      --btn-border: #3a2030;
      --speaker-bg: #3a2030; --speaker-border: #2a1520;
      --mesh-color: rgba(255,200,208,0.06);
      --lcd-bg: #120810;
      --lcd-text: #ffaacc; --lcd-dim: #cc6699; --lcd-idle: #aa4477;
      --lcd-glow: rgba(255,170,204,0.6);
      --screw1: #8a6878; --screw2: #6a4858; --screw-line: #3a2030;
      --label-color: #d0a8b8; --freq-mark: #bb88a0;
      --tick-color: #aa7890;
      --needle: #ff4488; --needle-glow: rgba(255,68,136,0.6);
      --led-on: #ff88aa; --led-glow: rgba(255,136,170,0.3);
      --knob-ind: #ffc8d0;
      --footer-color: #bb88a0; --footer-link: #d0a8b8;
      --antenna1: #8a6878; --antenna2: #bb99aa;
      --preset-num: #d8b0c0; --preset-name: #c098a8;
      --power-icon: #d0a8b8;
      --neon-border: #ff44aa; --neon-glow: rgba(255,68,170,0.6);
      --neon-light: rgba(255,130,200,0.3); --neon-light-glow: rgba(255,130,200,0.12);
    }

    /* 8. Maltese (말티즈) */
    [data-theme="maltese"] {
      --bg: #f0ebe5;
      --body-out1: #faf8f5; --body-out2: #f0ece6;
      --body-in1: #f8f5f0; --body-in2: #efe8e0;
      --texture-color: rgba(180,160,140,0.02);
      --accent: #8B5E3C;
      --accent-glow: rgba(139,94,60,0.4);
      --btn-bg1: #f0ebe5; --btn-bg2: #e5ddd5;
      --btn-hi1: #f8f4ee; --btn-hi2: #eae2da;
      --btn-active1: #ddd0c0; --btn-active2: #c8b8a5;
      --btn-border: #c8b8a5;
      --speaker-bg: #d8ccc0; --speaker-border: #bfb0a0;
      --mesh-color: rgba(120,90,60,0.06);
      --lcd-bg: #1a120a;
      --lcd-text: #ffdd88; --lcd-dim: #ccaa55; --lcd-idle: #aa8833;
      --lcd-glow: rgba(255,221,136,0.6);
      --screw1: #d8ccc0; --screw2: #bfb0a0; --screw-line: #a09080;
      --label-color: #6a5040; --freq-mark: #7a6050;
      --tick-color: #8a7060;
      --needle: #cc4422; --needle-glow: rgba(204,68,34,0.5);
      --led-on: #8B5E3C; --led-glow: rgba(139,94,60,0.3);
      --knob-ind: #8B5E3C;
      --footer-color: #7a6050; --footer-link: #5a3e20;
      --antenna1: #c0b0a0; --antenna2: #e0d5ca;
      --preset-num: #5a4030; --preset-name: #6a5040;
      --power-icon: #6a5040;
      --neon-border: #DEB887; --neon-glow: rgba(222,184,135,0.5);
      --neon-light: rgba(222,184,135,0.3); --neon-light-glow: rgba(222,184,135,0.12);
    }

    /* 9. Purple (퍼플 갤럭시) */
    [data-theme="purple"] {
      --bg: #0e0a1a;
      --body-out1: #1e1040; --body-out2: #140a30;
      --body-in1: #180e38; --body-in2: #100828;
      --texture-color: rgba(140,80,220,0.015);
      --accent: #b388ff;
      --accent-glow: rgba(179,136,255,0.5);
      --btn-bg1: #2a1858; --btn-bg2: #1e1040;
      --btn-hi1: #3a2068; --btn-hi2: #2a1858;
      --btn-active1: #4a2888; --btn-active2: #3a1868;
      --btn-border: #1a0e30;
      --speaker-bg: #120a22; --speaker-border: #0a0618;
      --mesh-color: rgba(160,120,255,0.1);
      --lcd-bg: #0a0618;
      --lcd-text: #d0aaff; --lcd-dim: #a880dd; --lcd-idle: #8060bb;
      --lcd-glow: rgba(208,170,255,0.6);
      --screw1: #3a2868; --screw2: #2a1848; --screw-line: #1a0e30;
      --label-color: #c8a8f0; --freq-mark: #a888d0;
      --tick-color: #8868b0;
      --needle: #ff44cc; --needle-glow: rgba(255,68,204,0.6);
      --led-on: #b388ff; --led-glow: rgba(179,136,255,0.3);
      --knob-ind: #b388ff;
      --footer-color: #a088c8; --footer-link: #c8a8f0;
      --antenna1: #6a5888; --antenna2: #9a88b0;
      --preset-num: #5a4030; --preset-name: #6a5040;
      --power-icon: #c8a8f0;
      --neon-border: #9c4dff; --neon-glow: rgba(156,77,255,0.6);
      --neon-light: rgba(179,136,255,0.35); --neon-light-glow: rgba(179,136,255,0.15);
    }

    /* 10. Hot Pink (핫핑크 네온) */
    [data-theme="hotpink"] {
      --bg: #1a0a18;
      --body-out1: #3a1038; --body-out2: #2a0828;
      --body-in1: #2e0c2e; --body-in2: #200820;
      --texture-color: rgba(255,80,180,0.015);
      --accent: #ff69b4;
      --accent-glow: rgba(255,105,180,0.5);
      --btn-bg1: #3a1038; --btn-bg2: #2a0828;
      --btn-hi1: #4a1848; --btn-hi2: #3a1038;
      --btn-active1: #5a2058; --btn-active2: #4a1848;
      --btn-border: #1a0818;
      --speaker-bg: #140810; --speaker-border: #0e060a;
      --mesh-color: rgba(255,100,180,0.1);
      --lcd-bg: #0a0608;
      --lcd-text: #ff88cc; --lcd-dim: #dd66aa; --lcd-idle: #bb4488;
      --lcd-glow: rgba(255,136,204,0.6);
      --screw1: #4a2040; --screw2: #2a1020; --screw-line: #1a0818;
      --label-color: #f0a8d0; --freq-mark: #d888b8;
      --tick-color: #b868a0;
      --needle: #ff1493; --needle-glow: rgba(255,20,147,0.6);
      --led-on: #ff69b4; --led-glow: rgba(255,105,180,0.3);
      --knob-ind: #ff69b4;
      --footer-color: #d888b8; --footer-link: #f0a8d0;
      --antenna1: #8a5878; --antenna2: #b088a0;
      --preset-num: #5a4030; --preset-name: #6a5040;
      --power-icon: #f0a8d0;
      --neon-border: #ff1493; --neon-glow: rgba(255,20,147,0.6);
      --neon-light: rgba(255,105,180,0.35); --neon-light-glow: rgba(255,105,180,0.15);
    }

    /* 11. Sky Blue Neon (하늘색 네온) */
    [data-theme="skyblue"] {
      --bg: #060e1a;
      --body-out1: #0e1e38; --body-out2: #081428;
      --body-in1: #0c1a30; --body-in2: #081220;
      --texture-color: rgba(100,180,255,0.012);
      --accent: #66BBFF;
      --accent-glow: rgba(102,187,255,0.5);
      --btn-bg1: #0e1e38; --btn-bg2: #081428;
      --btn-hi1: #142848; --btn-hi2: #0e1e38;
      --btn-active1: #1a3058; --btn-active2: #102040;
      --btn-border: #06101e;
      --speaker-bg: #06101e; --speaker-border: #040a14;
      --mesh-color: rgba(102,187,255,0.08);
      --lcd-bg: #020a14;
      --lcd-text: #88CCFF; --lcd-dim: #5599cc; --lcd-idle: #3377aa;
      --lcd-glow: rgba(136,204,255,0.65);
      --screw1: #1a2848; --screw2: #0e1e38; --screw-line: #06101e;
      --label-color: #77bbee; --freq-mark: #5599cc;
      --tick-color: #4488bb;
      --needle: #ff6633; --needle-glow: rgba(255,102,51,0.65);
      --led-on: #66BBFF; --led-glow: rgba(102,187,255,0.35);
      --knob-ind: #66BBFF;
      --footer-color: #5599cc; --footer-link: #77bbee;
      --antenna1: #336688; --antenna2: #5599bb;
      --preset-num: #77bbee; --preset-name: #5599cc;
      --power-icon: #77bbee;
      --neon-border: #66BBFF; --neon-glow: rgba(102,187,255,0.6);
      --neon-light: rgba(102,187,255,0.3); --neon-light-glow: rgba(102,187,255,0.12);
    }

    /* ============================================
       MATERIAL TEXTURES per theme
       ============================================ */

    /* 1. Wood - 나무결 (Woodgrain) */
    [data-theme="wood"] .radio-inner::before {
      background:
        /* knot */
        radial-gradient(ellipse 18px 30px at 25% 40%, rgba(180,120,50,0.06) 0%, transparent 70%),
        radial-gradient(ellipse 14px 22px at 72% 65%, rgba(180,120,50,0.05) 0%, transparent 70%),
        /* grain lines */
        repeating-linear-gradient(92deg, transparent, transparent 2px, rgba(255,200,100,0.025) 2px, rgba(255,200,100,0.025) 4px),
        repeating-linear-gradient(88deg, transparent, transparent 5px, rgba(200,150,60,0.018) 5px, rgba(200,150,60,0.018) 7px),
        repeating-linear-gradient(90deg, transparent, transparent 11px, rgba(160,100,30,0.02) 11px, rgba(160,100,30,0.02) 12px);
    }
    [data-theme="wood"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(200,180,140,0.14) 1px, transparent 1px);
      background-size: 6px 6px;
    }
    [data-theme="wood"] .radio {
      border-radius: 24px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.6),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }

    /* 2. Cream - 가죽 (Leather) */
    [data-theme="cream"] .radio-inner::before {
      background:
        /* leather pebble bumps */
        radial-gradient(circle 2px at 30% 30%, rgba(120,70,20,0.06), transparent 50%),
        radial-gradient(circle 3px at 70% 60%, rgba(120,70,20,0.05), transparent 50%),
        radial-gradient(circle 2px at 50% 80%, rgba(120,70,20,0.04), transparent 50%),
        /* pebble pattern */
        radial-gradient(ellipse 4px 3px at 20% 20%, rgba(100,50,10,0.04), transparent 70%),
        radial-gradient(ellipse 3px 4px at 60% 40%, rgba(100,50,10,0.035), transparent 70%),
        radial-gradient(ellipse 4px 3px at 80% 70%, rgba(100,50,10,0.04), transparent 70%),
        radial-gradient(ellipse 3px 4px at 40% 90%, rgba(100,50,10,0.03), transparent 70%),
        /* fine grain */
        repeating-linear-gradient(45deg, transparent, transparent 1px, rgba(80,40,10,0.012) 1px, rgba(80,40,10,0.012) 2px),
        repeating-linear-gradient(-45deg, transparent, transparent 1px, rgba(80,40,10,0.01) 1px, rgba(80,40,10,0.01) 2px);
    }
    [data-theme="cream"] .radio {
      border-radius: 28px;
      box-shadow:
        0 30px 60px rgba(80,50,20,0.3),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    /* Stitching effect */
    [data-theme="cream"] .radio-inner {
      border: 2px solid rgba(139,69,19,0.15);
      outline: 2px dashed rgba(139,69,19,0.12);
      outline-offset: 4px;
    }
    [data-theme="cream"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(100,60,20,0.06) 3px, rgba(100,60,20,0.06) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(100,60,20,0.06) 3px, rgba(100,60,20,0.06) 4px);
      background-size: 4px 4px;
    }

    /* 3. Black - 카본 파이버 (Carbon Fiber) */
    [data-theme="black"] .radio-inner::before {
      background:
        /* carbon weave */
        repeating-linear-gradient(
          45deg,
          transparent, transparent 4px,
          rgba(255,255,255,0.02) 4px, rgba(255,255,255,0.02) 5px
        ),
        repeating-linear-gradient(
          -45deg,
          transparent, transparent 4px,
          rgba(255,255,255,0.015) 4px, rgba(255,255,255,0.015) 5px
        ),
        /* cross-fiber shimmer */
        repeating-linear-gradient(
          45deg,
          rgba(255,255,255,0.01) 0px, transparent 1px,
          transparent 3px, rgba(255,255,255,0.008) 4px
        ),
        repeating-linear-gradient(
          -45deg,
          rgba(255,255,255,0.01) 0px, transparent 1px,
          transparent 3px, rgba(255,255,255,0.008) 4px
        );
      background-size: 8px 8px, 8px 8px, 8px 8px, 8px 8px;
    }
    [data-theme="black"] .radio {
      border-radius: 18px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.8),
        0 0 10px var(--neon-glow),
        0 0 25px var(--neon-glow),
        inset 0 0 10px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.04);
    }
    [data-theme="black"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(255,255,255,0.06) 0.5px, transparent 0.5px);
      background-size: 4px 4px;
    }
    [data-theme="black"] .screw {
      background: linear-gradient(145deg, #333, #111);
      border-color: #080808;
    }
    [data-theme="black"] .screw::after { background: #050505; }

    /* 4. Military - 캔버스 (Canvas Fabric) */
    [data-theme="military"] .radio-inner::before {
      background:
        /* canvas weave horizontal */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 2px,
          rgba(150,170,120,0.025) 2px, rgba(150,170,120,0.025) 3px,
          transparent 3px, transparent 5px
        ),
        /* canvas weave vertical */
        repeating-linear-gradient(
          90deg,
          transparent, transparent 2px,
          rgba(140,160,110,0.02) 2px, rgba(140,160,110,0.02) 3px,
          transparent 3px, transparent 5px
        ),
        /* coarser fabric overlay */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 8px,
          rgba(100,130,70,0.015) 8px, rgba(100,130,70,0.015) 9px
        ),
        repeating-linear-gradient(
          90deg,
          transparent, transparent 8px,
          rgba(100,130,70,0.012) 8px, rgba(100,130,70,0.012) 9px
        );
    }
    [data-theme="military"] .radio {
      border-radius: 12px;
      box-shadow:
        0 25px 50px rgba(0,0,0,0.5),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.05);
    }
    [data-theme="military"] .radio-inner { border-radius: 10px; }
    [data-theme="military"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(150,170,120,0.07) 2px, rgba(150,170,120,0.07) 3px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(150,170,120,0.07) 2px, rgba(150,170,120,0.07) 3px);
      background-size: 5px 5px;
    }
    [data-theme="military"] .speaker-grille { border-radius: 6px; }
    [data-theme="military"] .lcd-display { border-radius: 4px; }
    [data-theme="military"] .preset-btn { border-radius: 4px; }

    /* 5. Silver - 브러시드 메탈 (Brushed Aluminum) */
    [data-theme="silver"] .radio-inner::before {
      background:
        /* fine brush strokes horizontal */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 1px,
          rgba(255,255,255,0.015) 1px, rgba(255,255,255,0.015) 2px
        ),
        /* slightly thicker brush strokes */
        repeating-linear-gradient(
          2deg,
          transparent, transparent 3px,
          rgba(255,255,255,0.02) 3px, rgba(255,255,255,0.02) 4px
        ),
        /* highlight sheen */
        linear-gradient(
          180deg,
          rgba(255,255,255,0.06) 0%,
          transparent 15%,
          transparent 60%,
          rgba(255,255,255,0.03) 100%
        ),
        /* subtle color variation */
        radial-gradient(ellipse at 30% 0%, rgba(255,255,255,0.04), transparent 50%);
    }
    [data-theme="silver"] .radio {
      border-radius: 20px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.4),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    [data-theme="silver"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.15);
    }
    [data-theme="silver"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(200,200,220,0.12) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="silver"] .knob {
      background: linear-gradient(145deg, #c0c0d0, #808090) !important;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.2), inset 0 -2px 4px rgba(0,0,0,0.2);
    }

    /* 6. Cyber - 회로기판 (Circuit Board) */
    [data-theme="cyber"] .radio-inner::before {
      background:
        /* circuit grid */
        repeating-linear-gradient(
          0deg,
          transparent, transparent 19px,
          rgba(0,229,255,0.03) 19px, rgba(0,229,255,0.03) 20px
        ),
        repeating-linear-gradient(
          90deg,
          transparent, transparent 19px,
          rgba(0,229,255,0.03) 19px, rgba(0,229,255,0.03) 20px
        ),
        /* circuit traces */
        linear-gradient(0deg, transparent 48%, rgba(0,229,255,0.015) 49%, rgba(0,229,255,0.015) 51%, transparent 52%),
        linear-gradient(90deg, transparent 28%, rgba(0,229,255,0.01) 29%, rgba(0,229,255,0.01) 31%, transparent 32%),
        linear-gradient(90deg, transparent 68%, rgba(0,229,255,0.012) 69%, rgba(0,229,255,0.012) 71%, transparent 72%),
        /* solder point dots */
        radial-gradient(circle 1px at 20px 20px, rgba(0,229,255,0.04), transparent 2px),
        radial-gradient(circle 1px at 40px 40px, rgba(0,229,255,0.03), transparent 2px);
      background-size: 20px 20px, 20px 20px, 100% 100%, 100% 100%, 100% 100%, 60px 60px, 60px 60px;
    }
    [data-theme="cyber"] .radio {
      border-radius: 16px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.7),
        0 0 12px var(--neon-glow),
        0 0 30px var(--neon-glow),
        0 0 60px rgba(0,229,255,0.15),
        inset 0 0 12px var(--neon-glow);
    }
    [data-theme="cyber"] .speaker-mesh {
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,229,255,0.04) 3px, rgba(0,229,255,0.04) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(0,229,255,0.04) 3px, rgba(0,229,255,0.04) 4px);
      background-size: 4px 4px;
    }
    [data-theme="cyber"] .speaker-grille {
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.6), 0 0 8px rgba(0,229,255,0.08);
    }
    /* Neon border glow */
    [data-theme="cyber"] .radio-inner::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      border-radius: inherit;
      border: 1px solid rgba(0,229,255,0.06);
      pointer-events: none;
      z-index: 0;
    }

    /* 7. Rose - 대리석 (Marble) */
    [data-theme="rose"] .radio-inner::before {
      background:
        /* marble veins - primary */
        linear-gradient(
          137deg,
          transparent 20%,
          rgba(255,220,230,0.04) 22%, rgba(255,220,230,0.04) 23%,
          transparent 25%,
          transparent 45%,
          rgba(255,200,210,0.035) 47%, rgba(255,200,210,0.035) 48%,
          transparent 50%,
          transparent 70%,
          rgba(255,210,220,0.03) 72%, rgba(255,210,220,0.03) 73%,
          transparent 75%
        ),
        /* marble veins - secondary */
        linear-gradient(
          52deg,
          transparent 10%,
          rgba(255,180,200,0.025) 12%, rgba(255,180,200,0.025) 13%,
          transparent 15%,
          transparent 35%,
          rgba(255,190,210,0.03) 37%, rgba(255,190,210,0.03) 38%,
          transparent 40%,
          transparent 55%,
          rgba(255,200,220,0.02) 57%, rgba(255,200,220,0.02) 58%,
          transparent 60%,
          transparent 80%,
          rgba(255,180,200,0.025) 82%, rgba(255,180,200,0.025) 83%,
          transparent 85%
        ),
        /* fine veins */
        linear-gradient(
          165deg,
          transparent 30%,
          rgba(255,220,230,0.02) 31%, rgba(255,220,230,0.02) 31.5%,
          transparent 32%,
          transparent 60%,
          rgba(255,220,230,0.018) 61%, rgba(255,220,230,0.018) 61.5%,
          transparent 62%
        ),
        /* polished sheen */
        radial-gradient(ellipse at 30% 20%, rgba(255,255,255,0.04), transparent 50%),
        radial-gradient(ellipse at 70% 80%, rgba(255,255,255,0.03), transparent 40%);
    }
    [data-theme="rose"] .radio {
      border-radius: 26px;
      box-shadow:
        0 30px 60px rgba(40,10,20,0.5),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.12);
    }
    /* Polished marble sheen overlay */
    [data-theme="rose"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }
    [data-theme="rose"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(255,200,208,0.08) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="rose"] .speaker-grille {
      border-radius: 16px;
    }

    /* 8. Maltese - 부드러운 털 결 (Soft Fur Texture) */
    [data-theme="maltese"] .radio-inner::before {
      background:
        /* soft wavy fur lines */
        repeating-linear-gradient(
          170deg,
          transparent, transparent 4px,
          rgba(200,180,160,0.025) 4px, rgba(200,180,160,0.025) 5px
        ),
        repeating-linear-gradient(
          175deg,
          transparent, transparent 6px,
          rgba(220,200,180,0.02) 6px, rgba(220,200,180,0.02) 7px
        ),
        repeating-linear-gradient(
          168deg,
          transparent, transparent 8px,
          rgba(180,160,140,0.018) 8px, rgba(180,160,140,0.018) 9px
        ),
        /* fluffy dot highlights */
        radial-gradient(circle 2px at 10px 12px, rgba(255,255,255,0.04), transparent 3px),
        radial-gradient(circle 2px at 30px 25px, rgba(255,255,255,0.03), transparent 3px),
        radial-gradient(circle 2px at 50px 8px, rgba(255,255,255,0.035), transparent 3px);
      background-size: 10px 10px, 14px 14px, 18px 18px, 60px 40px, 60px 40px, 60px 40px;
    }
    [data-theme="maltese"] .radio {
      border-radius: 30px;
      box-shadow:
        0 30px 60px rgba(80,60,40,0.2),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.5);
    }
    [data-theme="maltese"] .radio-inner {
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
    }
    [data-theme="maltese"] .speaker-mesh {
      background-image:
        radial-gradient(circle, rgba(139,94,60,0.05) 1px, transparent 1px);
      background-size: 5px 5px;
    }
    [data-theme="maltese"] .speaker-grille {
      border-radius: 20px;
    }
    [data-theme="maltese"] .screw {
      background: linear-gradient(145deg, #e8ddd0, #c8b8a5);
      border-color: #b0a090;
    }
    /* Maltese face silhouette background */
    [data-theme="maltese"] .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cg fill='none' stroke='rgba(139,94,60,0.05)' stroke-width='1.5'%3E%3C!-- fluffy head outline --%3E%3Cpath d='M60 95 Q50 70 60 55 Q70 40 85 45 Q95 35 105 35 Q115 35 125 45 Q140 40 150 55 Q160 70 150 95' fill='rgba(139,94,60,0.02)'/%3E%3C!-- face --%3E%3Cellipse cx='105' cy='110' rx='42' ry='38' fill='rgba(139,94,60,0.015)'/%3E%3C!-- fluffy cheeks --%3E%3Cpath d='M63 100 Q50 110 55 125 Q60 135 75 130' stroke='rgba(139,94,60,0.04)' fill='rgba(139,94,60,0.015)'/%3E%3Cpath d='M147 100 Q160 110 155 125 Q150 135 135 130' stroke='rgba(139,94,60,0.04)' fill='rgba(139,94,60,0.015)'/%3E%3C!-- floppy ears --%3E%3Cpath d='M65 85 Q40 90 35 115 Q32 140 50 155 Q60 145 68 125' fill='rgba(139,94,60,0.025)' stroke='rgba(139,94,60,0.04)'/%3E%3Cpath d='M145 85 Q170 90 175 115 Q178 140 160 155 Q150 145 142 125' fill='rgba(139,94,60,0.025)' stroke='rgba(139,94,60,0.04)'/%3E%3C!-- eyes --%3E%3Ccircle cx='88' cy='105' r='6' fill='rgba(60,35,15,0.06)'/%3E%3Ccircle cx='122' cy='105' r='6' fill='rgba(60,35,15,0.06)'/%3E%3C!-- eye highlights --%3E%3Ccircle cx='90' cy='103' r='2.5' fill='rgba(255,255,255,0.04)'/%3E%3Ccircle cx='124' cy='103' r='2.5' fill='rgba(255,255,255,0.04)'/%3E%3C!-- nose --%3E%3Cellipse cx='105' cy='118' rx='6' ry='5' fill='rgba(60,35,15,0.06)'/%3E%3C!-- nose highlight --%3E%3Cellipse cx='104' cy='116' rx='2' ry='1.5' fill='rgba(255,255,255,0.03)'/%3E%3C!-- mouth --%3E%3Cpath d='M105 123 Q100 130 93 127' stroke='rgba(139,94,60,0.04)'/%3E%3Cpath d='M105 123 Q110 130 117 127' stroke='rgba(139,94,60,0.04)'/%3E%3C!-- tongue --%3E%3Cellipse cx='105' cy='132' rx='5' ry='6' fill='rgba(255,120,120,0.04)' stroke='rgba(200,80,80,0.04)'/%3E%3C!-- fluffy body tuft --%3E%3Cpath d='M75 145 Q80 160 90 168 Q100 172 110 172 Q120 168 130 160 Q135 145 130 140' stroke='rgba(139,94,60,0.03)' fill='rgba(139,94,60,0.01)'/%3E%3C!-- fur texture lines --%3E%3Cpath d='M70 60 Q68 50 72 48' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M90 42 Q92 34 95 36' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M115 38 Q118 30 120 34' stroke='rgba(139,94,60,0.03)'/%3E%3Cpath d='M140 55 Q143 47 140 45' stroke='rgba(139,94,60,0.03)'/%3E%3C/g%3E%3C/svg%3E") no-repeat center center,
        radial-gradient(ellipse at 50% 0%, rgba(255,255,255,0.05) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.08) 100%);
      background-size: 65% auto, 100% 100%, 100% 100%;
      pointer-events: none; z-index: 0; border-radius: inherit;
    }

    /* 9. Purple - 은하 성운 (Galaxy Nebula) */
    [data-theme="purple"] .radio-inner::before {
      background:
        radial-gradient(ellipse 40px 40px at 20% 30%, rgba(156,77,255,0.06) 0%, transparent 70%),
        radial-gradient(ellipse 30px 50px at 75% 60%, rgba(100,60,200,0.05) 0%, transparent 70%),
        radial-gradient(ellipse 50px 30px at 50% 80%, rgba(180,100,255,0.04) 0%, transparent 70%),
        repeating-linear-gradient(135deg, transparent, transparent 3px, rgba(140,80,220,0.02) 3px, rgba(140,80,220,0.02) 4px);
    }
    [data-theme="purple"] .radio {
      border-radius: 24px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.7),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.06);
    }
    [data-theme="purple"] .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 30% 20%, rgba(156,77,255,0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 70% 70%, rgba(100,60,200,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.15) 100%);
      pointer-events: none; z-index: 0; border-radius: inherit;
    }

    /* 10. Hot Pink - 네온 글로우 (Neon Glow) */
    [data-theme="hotpink"] .radio-inner::before {
      background:
        radial-gradient(ellipse 35px 45px at 25% 35%, rgba(255,20,147,0.05) 0%, transparent 70%),
        radial-gradient(ellipse 45px 35px at 70% 55%, rgba(255,80,180,0.04) 0%, transparent 70%),
        repeating-linear-gradient(160deg, transparent, transparent 4px, rgba(255,80,180,0.015) 4px, rgba(255,80,180,0.015) 5px),
        repeating-linear-gradient(110deg, transparent, transparent 6px, rgba(255,20,147,0.01) 6px, rgba(255,20,147,0.01) 7px);
    }
    [data-theme="hotpink"] .radio {
      border-radius: 24px;
      box-shadow:
        0 30px 60px rgba(0,0,0,0.7),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.06);
    }
    [data-theme="hotpink"] .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 40% 25%, rgba(255,20,147,0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 65% 75%, rgba(255,105,180,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.15) 100%);
      pointer-events: none; z-index: 0; border-radius: inherit;
    }

    /* ============================================
       TEXT READABILITY & VIVID COLORS
       ============================================ */
    :root, [data-theme="wood"] {
      --label-color: #e8d0a8; --freq-mark: #d4b888; --tick-color: #b89868;
      --preset-num: #f0d898; --preset-name: #d8c090;
      --footer-color: #c8b088; --footer-link: #e8c880;
      --power-icon: #e8d0a8;
      --lcd-text: #55ff55; --lcd-dim: #44dd44; --lcd-idle: #33bb33;
      --lcd-glow: rgba(85,255,85,0.7);
    }
    [data-theme="cream"] {
      --label-color: #5a3518; --freq-mark: #704828; --tick-color: #8a5830;
      --preset-num: #4a2810; --preset-name: #5a3818;
      --footer-color: #704828; --footer-link: #4a2810;
      --power-icon: #5a3518;
      --lcd-text: #ffcc55; --lcd-dim: #ddaa33; --lcd-idle: #bb8800;
      --lcd-glow: rgba(255,204,85,0.7);
    }
    [data-theme="black"] {
      --label-color: #cccccc; --freq-mark: #aaaaaa; --tick-color: #888888;
      --preset-num: #dddddd; --preset-name: #bbbbbb;
      --footer-color: #999999; --footer-link: #cccccc;
      --power-icon: #cccccc;
      --lcd-text: #ffffff; --lcd-dim: #bbbbbb; --lcd-idle: #888888;
      --lcd-glow: rgba(255,255,255,0.5);
    }
    [data-theme="military"] {
      --label-color: #c8e098; --freq-mark: #a8c878; --tick-color: #88aa58;
      --preset-num: #d8ee98; --preset-name: #b8d080;
      --footer-color: #a8c878; --footer-link: #c8e098;
      --power-icon: #c8e098;
      --lcd-text: #55ff55; --lcd-dim: #44dd44; --lcd-idle: #33bb33;
      --lcd-glow: rgba(85,255,85,0.7);
    }
    [data-theme="silver"] {
      --label-color: #222238; --freq-mark: #333348; --tick-color: #444458;
      --preset-num: #1a1a30; --preset-name: #333348;
      --footer-color: #444458; --footer-link: #222238;
      --power-icon: #222238;
      --lcd-text: #77ddff; --lcd-dim: #55bbdd; --lcd-idle: #3399bb;
      --lcd-glow: rgba(119,221,255,0.7);
    }
    [data-theme="cyber"] {
      --label-color: #00ddff; --freq-mark: #00bbdd; --tick-color: #0099bb;
      --preset-num: #00eeff; --preset-name: #00ccee;
      --footer-color: #00bbdd; --footer-link: #00eeff;
      --power-icon: #00ddff;
      --lcd-text: #00ffff; --lcd-dim: #00ddee; --lcd-idle: #00bbcc;
      --lcd-glow: rgba(0,255,255,0.8);
    }
    [data-theme="rose"] {
      --label-color: #eec0d0; --freq-mark: #dda8b8; --tick-color: #cc90a0;
      --preset-num: #ffd0dd; --preset-name: #eec0d0;
      --footer-color: #dda8b8; --footer-link: #ffd0dd;
      --power-icon: #eec0d0;
      --lcd-text: #ffbbdd; --lcd-dim: #dd88aa; --lcd-idle: #cc6699;
      --lcd-glow: rgba(255,187,221,0.7);
    }
    [data-theme="maltese"] {
      --label-color: #5a4030; --freq-mark: #6a5040; --tick-color: #7a6050;
      --preset-num: #4a3020; --preset-name: #5a4030;
      --footer-color: #6a5040; --footer-link: #4a3020;
      --power-icon: #5a4030;
      --lcd-text: #ffdd88; --lcd-dim: #ddbb55; --lcd-idle: #ccaa44;
      --lcd-glow: rgba(255,221,136,0.7);
    }
    [data-theme="purple"] {
      --label-color: #d0b8f0; --freq-mark: #b898d8; --tick-color: #9878b8;
      --preset-num: #e0c8ff; --preset-name: #c8a8e8;
      --footer-color: #b898d8; --footer-link: #d0b8f0;
      --power-icon: #d0b8f0;
      --lcd-text: #d0aaff; --lcd-dim: #b088dd; --lcd-idle: #9068bb;
      --lcd-glow: rgba(208,170,255,0.7);
    }
    [data-theme="hotpink"] {
      --label-color: #f0b8d8; --freq-mark: #d898c0; --tick-color: #c080a8;
      --preset-num: #ffc8e0; --preset-name: #f0b0d0;
      --footer-color: #d898c0; --footer-link: #f0b8d8;
      --power-icon: #f0b8d8;
      --lcd-text: #ff99cc; --lcd-dim: #dd77aa; --lcd-idle: #cc5588;
      --lcd-glow: rgba(255,153,204,0.7);
    }

    /* ============================================
       CORE STYLES (using CSS variables)
       ============================================ */
    body {
      background: var(--bg);
      min-height: 100vh;
      min-height: 100dvh;
      display: flex;
      flex-direction: column;
      justify-content: safe center;
      align-items: center;
      font-family: 'Inter', sans-serif;
      padding: 20px;
      overflow-y: auto;
      transition: background 0.6s ease;
    }

    /* === THEME SWITCHER === */
    .theme-switcher {
      display: flex;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(0,0,0,0.2);
      border-radius: 20px 20px 0 0;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.04);
      justify-content: center;
      align-items: center;
    }
    .theme-toggle-btn {
      background: none; border: none; cursor: pointer; padding: 2px;
      color: var(--label-color, #999); font-size: 14px; line-height: 1;
      opacity: 0.6; transition: opacity 0.2s; flex-shrink: 0;
    }
    .theme-toggle-btn:hover { opacity: 1; }
    .theme-dots-wrap {
      display: flex; gap: 8px; justify-content: center; align-items: center;
      overflow: hidden; transition: max-width 0.3s ease, opacity 0.3s ease;
      max-width: 500px; opacity: 1;
    }
    .theme-dots-wrap.hidden {
      max-width: 0; opacity: 0; gap: 0;
    }

    .theme-dot {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.15);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .theme-dot:hover { transform: scale(1.2); }
    .theme-dot.active {
      border-color: #fff;
      transform: scale(1.15);
      box-shadow: 0 2px 12px rgba(255,255,255,0.2);
    }
    .theme-dot.active::after {
      content: '';
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 8px; height: 8px;
      background: #fff;
      border-radius: 50%;
    }

    .theme-dot[data-t="wood"]     { background: linear-gradient(135deg, #3a2a1a, #d4a862); }
    .theme-dot[data-t="cream"]    { background: linear-gradient(135deg, #f5e6c8, #8b4513); }
    .theme-dot[data-t="black"]    { background: linear-gradient(135deg, #222, #000); }
    .theme-dot[data-t="military"] { background: linear-gradient(135deg, #4a5540, #c8b400); }
    .theme-dot[data-t="silver"]   { background: linear-gradient(135deg, #c0c0cc, #5a5a6a); }
    .theme-dot[data-t="cyber"]    { background: linear-gradient(135deg, #101025, #00e5ff); }
    .theme-dot[data-t="rose"]     { background: linear-gradient(135deg, #8a6070, #ffc8d0); }
    .theme-dot[data-t="maltese"]  { background: linear-gradient(135deg, #faf8f5, #DEB887); }
    .theme-dot[data-t="purple"]   { background: linear-gradient(135deg, #1e1040, #b388ff); }
    .theme-dot[data-t="hotpink"]  { background: linear-gradient(135deg, #3a1038, #ff69b4); }
    .theme-dot[data-t="skyblue"]  { background: linear-gradient(135deg, #0a1828, #66BBFF); }

    .theme-name {
      font-size: 10px;
      color: rgba(255,255,255,0.6);
      text-align: center;
      margin-bottom: 4px;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      font-family: 'Outfit', sans-serif;
      transition: color 0.3s;
      text-shadow: 0 1px 4px rgba(0,0,0,0.5);
    }

    /* === RADIO BODY === */
    .radio {
      width: 100%;
      max-width: 480px;
      background: linear-gradient(145deg, var(--body-out1), var(--body-out2));
      border-radius: 24px;
      padding: 0;
      border: 2px solid var(--neon-border);
      box-shadow:
        0 30px 60px rgba(0,0,0,0.6),
        0 0 8px var(--neon-glow),
        0 0 20px var(--neon-glow),
        inset 0 0 8px var(--neon-glow),
        inset 0 1px 0 rgba(255,255,255,0.08);
      position: relative;
      transition: all 0.6s ease;
      overflow: hidden;
    }

    .radio-inner {
      background: linear-gradient(180deg, var(--body-in1), var(--body-in2));
      border-radius: 0;
      padding: 20px 20px 16px;
      position: relative;
      overflow: hidden;
      transition: all 0.6s ease;
    }
    .radio-inner::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 50% 0%, rgba(255,255,255,0.04) 0%, transparent 50%),
        radial-gradient(ellipse at center, transparent 60%, rgba(0,0,0,0.15) 100%);
      pointer-events: none; z-index: 0;
      border-radius: inherit;
    }

    .radio-inner::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(
        90deg, transparent, transparent 3px,
        var(--texture-color) 3px, var(--texture-color) 6px
      );
      pointer-events: none;
    }

    /* === BRAND & POWER === */
    .radio-top-row1 {
      display: flex; justify-content: center; align-items: center;
      margin-bottom: 6px; position: relative; z-index: 1;
    }
    .radio-top-row1 .power-btn {
      position: absolute; right: 0;
    }
    .radio-top-row2 {
      display: flex; justify-content: center; align-items: center;
      gap: 8px;
      margin-bottom: 12px; position: relative; z-index: 1;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .brand {
      font-family: 'Outfit', sans-serif; font-size: 22px; font-weight: 800;
      letter-spacing: 3px;
      text-shadow: 0 -1px 0 rgba(0,0,0,0.6), 0 1px 0 rgba(255,255,255,0.08), 0 2px 4px rgba(0,0,0,0.4);
      transition: color 0.6s;
    }
    .brand-clara { color: var(--needle, #ff6b6b); }
    .brand-cafe { color: var(--accent); }
    /* Brand Mascots - hidden by default */
    .brand-mascot {
      display: none;
      flex-shrink: 0;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
      transition: all 0.4s ease;
    }
    img.brand-mascot {
      width: 34px; height: 34px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      margin-left: 3px;
    }
    .ctrl-mascot {
      display: none;
      width: 48px; height: 48px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      flex-shrink: 0;
      align-self: center;
    }

    .power-area { display: flex; align-items: center; gap: 10px; }
    .digital-to-analog-btn {
      background: var(--btn-bg); color: var(--accent); border: 1px solid var(--btn-border);
      padding: 5px 10px; border-radius: 12px;
      font-family: 'Orbitron', monospace; font-size: 7px; font-weight: 700;
      cursor: pointer; letter-spacing: 1px; transition: all 0.3s;
    }
    .digital-to-analog-btn:hover {
      background: var(--accent); color: var(--inner-bg);
    }
    .power-btn.on {
      border-color: #ff3333;
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 8px rgba(255,51,51,0.5), inset 0 1px 0 rgba(255,255,255,0.08);
      color: #ff3333;
    }
    .power-btn {
      width: 36px; height: 36px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--power-icon);
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow), inset 0 1px 0 rgba(255,255,255,0.08);
      transition: all 0.15s ease;
    }
    .power-btn:active {
      transform: scale(0.92);
      box-shadow: 0 1px 3px rgba(0,0,0,0.4), inset 0 1px 3px rgba(0,0,0,0.3);
    }

    /* === ANTENNA === */
    .antenna {
      position: absolute; top: -40px; right: 50px;
      width: 3px; height: 44px;
      background: linear-gradient(to top, var(--antenna1), var(--antenna2), var(--antenna1));
      border-radius: 2px; transform-origin: bottom center;
      transition: transform 0.5s ease, background 0.6s;
    }
    .antenna::after {
      content: ''; position: absolute; top: -4px; left: -2px;
      width: 7px; height: 7px;
      background: radial-gradient(circle, #ddd, #999);
      border-radius: 50%;
    }
    .antenna.active { transform: rotate(-15deg); }

    /* === SPEAKER GRILLE === */
    .speaker-grille {
      background: var(--speaker-bg); border-radius: 14px; padding: 16px;
      margin-bottom: 16px; border: 1px solid var(--neon-light);
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.6), inset 0 -2px 6px rgba(0,0,0,0.3), 0 0 6px var(--neon-light-glow), 0 1px 0 rgba(255,255,255,0.04);
      position: relative; z-index: 1; overflow: hidden;
      transition: all 0.6s;
    }
    .speaker-label {
      position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
      font-family: 'Orbitron', monospace; font-size: 6px; letter-spacing: 4px;
      color: var(--mesh-color); text-transform: uppercase; z-index: 2;
      opacity: 0.7; pointer-events: none;
    }
    .speaker-mesh {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.12) 2px, rgba(0,0,0,0.12) 3px),
        radial-gradient(circle, var(--mesh-color) 1px, transparent 1px);
      background-size: 100% 5px, 6px 6px;
      pointer-events: none;
    }
    .eq-container {
      display: flex; align-items: flex-end; justify-content: center;
      gap: 3px; height: 50px; position: relative; z-index: 1;
    }
    .eq-bar {
      width: 5px; height: 6px; background: var(--accent);
      border-radius: 2px; transition: height 0.15s ease, background 0.6s; opacity: 0.3;
    }
    .eq-bar.playing {
      opacity: 1; animation: eqBounce 0.6s ease-in-out infinite alternate;
      box-shadow: 0 0 6px var(--accent-glow);
    }
    @keyframes eqBounce { 0%{height:6px} 50%{height:40px} 100%{height:12px} }
    .eq-bar:nth-child(1).playing{animation-duration:.52s;animation-delay:0s}
    .eq-bar:nth-child(2).playing{animation-duration:.63s;animation-delay:.08s}
    .eq-bar:nth-child(3).playing{animation-duration:.48s;animation-delay:.03s}
    .eq-bar:nth-child(4).playing{animation-duration:.57s;animation-delay:.12s}
    .eq-bar:nth-child(5).playing{animation-duration:.65s;animation-delay:.05s}
    .eq-bar:nth-child(6).playing{animation-duration:.5s;animation-delay:.1s}
    .eq-bar:nth-child(7).playing{animation-duration:.6s;animation-delay:.02s}
    .eq-bar:nth-child(8).playing{animation-duration:.53s;animation-delay:.14s}
    .eq-bar:nth-child(9).playing{animation-duration:.62s;animation-delay:.07s}
    .eq-bar:nth-child(10).playing{animation-duration:.47s;animation-delay:.11s}
    .eq-bar:nth-child(11).playing{animation-duration:.58s;animation-delay:.04s}
    .eq-bar:nth-child(12).playing{animation-duration:.55s;animation-delay:.09s}
    .eq-bar:nth-child(13).playing{animation-duration:.61s;animation-delay:.01s}
    .eq-bar:nth-child(14).playing{animation-duration:.49s;animation-delay:.13s}
    .eq-bar:nth-child(15).playing{animation-duration:.56s;animation-delay:.06s}
    .eq-bar:nth-child(16).playing{animation-duration:.64s;animation-delay:.08s}

    /* === LCD DISPLAY === */
    .lcd-display {
      background: var(--lcd-bg); border-radius: 10px; padding: 14px 18px;
      margin-bottom: 16px;
      border: 1px solid var(--neon-light);
      box-shadow: inset 0 3px 10px rgba(0,0,0,0.8), inset 0 0 20px rgba(0,0,0,0.4), 0 0 6px var(--neon-light-glow), 0 1px 0 rgba(255,255,255,0.06);
      position: relative; z-index: 1; min-height: 90px;
      display: flex; flex-direction: column; justify-content: center;
      transition: all 0.6s;
    }
    .lcd-display::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, transparent 30%, transparent 80%, rgba(0,0,0,0.1) 100%);
      pointer-events: none; border-radius: 7px; z-index: 2;
    }
    .lcd-display::after {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(0,0,0,0.08) 1px, rgba(0,0,0,0.08) 2px);
      pointer-events: none; border-radius: 7px;
    }
    .on-air-dot {
      display: inline-block; width: 6px; height: 6px; border-radius: 50%;
      background: #ff3333; margin-right: 6px; vertical-align: middle;
      animation: onAirPulse 1s ease-in-out infinite;
      box-shadow: 0 0 4px #ff3333, 0 0 8px rgba(255,51,51,0.4);
    }
    @keyframes onAirPulse { 0%,100%{opacity:1} 50%{opacity:0.3} }
    .lcd-idle {
      text-align: center; color: var(--lcd-idle);
      font-family: 'Orbitron', monospace; font-size: 14px;
      letter-spacing: 2px; position: relative; z-index: 1;
      transition: color 0.6s;
      text-shadow: 0 0 8px var(--lcd-glow);
    }
    .lcd-active { position: relative; z-index: 1; display: none; }
    .lcd-active.visible { display: block; }
    .lcd-idle.hidden { display: none; }
    .lcd-provider {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: var(--lcd-dim); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 4px; transition: color 0.6s;
    }
    .lcd-name {
      font-family: 'Orbitron', monospace; font-size: 16px; font-weight: 700;
      color: var(--lcd-text); text-shadow: 0 0 10px var(--lcd-glow);
      margin-bottom: 2px; white-space: nowrap; overflow: hidden; transition: color 0.6s;
    }
    .lcd-freq {
      font-family: 'Orbitron', monospace; font-size: 26px; font-weight: 900;
      color: var(--lcd-text); text-shadow: 0 0 15px var(--lcd-glow);
      letter-spacing: 2px; transition: color 0.6s;
    }
    .lcd-status {
      font-family: 'Orbitron', monospace; font-size: 8px;
      color: var(--lcd-dim); letter-spacing: 2px; margin-top: 4px;
      display: flex; justify-content: space-between; align-items: center;
      transition: color 0.6s;
    }
    .lcd-signal { display: flex; gap: 2px; align-items: flex-end; }
    .lcd-signal-bar {
      width: 3px; background: var(--lcd-dim);
      border-radius: 1px; transition: all 0.5s ease;
    }
    .lcd-signal-bar.active { background: var(--lcd-text); }

    /* === TUNING DIAL === */
    .tuning-section {
      background: linear-gradient(180deg, rgba(0,0,0,0.3), rgba(0,0,0,0.1));
      border-radius: 10px; padding: 12px 16px; margin-bottom: 16px;
      border: 1px solid var(--neon-light);
      box-shadow: 0 0 6px var(--neon-light-glow);
      position: relative; z-index: 1;
    }
    .tuning-label {
      font-size: 8px; color: var(--label-color); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 8px; font-weight: 600;
      transition: color 0.6s;
    }
    .freq-band {
      position: relative; height: 28px; background: var(--speaker-bg);
      border-radius: 4px; overflow: hidden;
      border: 1px solid var(--speaker-border);
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.5);
      transition: all 0.6s;
    }
    .freq-band::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 40%;
      background: linear-gradient(180deg, rgba(255,255,255,0.06), transparent);
      pointer-events: none; z-index: 1;
    }
    .freq-ticks {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
    }
    .freq-tick {
      position: absolute; bottom: 0; width: 1px; background: var(--tick-color); opacity: 0.4;
    }
    .freq-tick.major { height: 10px; opacity: 0.7; }
    .freq-tick.minor { height: 5px; }
    .freq-marks {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      display: flex; justify-content: space-between; align-items: center; padding: 0 8px;
    }
    .freq-mark {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--freq-mark); position: relative; transition: color 0.6s;
    }
    .freq-mark::before {
      content: ''; position: absolute; top: -8px; left: 50%;
      width: 1px; height: 5px; background: var(--tick-color);
    }
    .tuning-needle {
      position: absolute; top: 2px; width: 2px; height: 24px;
      background: var(--needle); box-shadow: 0 0 6px var(--needle-glow), 0 0 12px var(--needle-glow);
      border-radius: 1px; left: 20%;
      transition: left 0.6s cubic-bezier(0.34,1.56,0.64,1), background 0.6s;
      z-index: 2;
    }
    .tuning-needle::after {
      content: ''; position: absolute; top: -2px; left: -2px;
      width: 6px; height: 6px; border-radius: 50%;
      background: var(--needle); box-shadow: 0 0 4px var(--needle-glow);
    }

    /* === PRESET BUTTONS === */
    .preset-section { margin-bottom: 16px; position: relative; z-index: 1; }
    .preset-label {
      font-size: 8px; color: var(--label-color); letter-spacing: 3px;
      text-transform: uppercase; margin-bottom: 8px; font-weight: 600;
      transition: color 0.6s;
    }
    .preset-scroll {
      overflow-y: auto; overflow-x: hidden;
      max-height: 200px;
      scrollbar-width: thin;
      scrollbar-color: var(--btn-border) transparent;
      padding-right: 2px;
    }
    .preset-scroll::-webkit-scrollbar { width: 3px; }
    .preset-scroll::-webkit-scrollbar-track { background: transparent; }
    .preset-scroll::-webkit-scrollbar-thumb { background: var(--btn-border); border-radius: 2px; }
    .preset-buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-auto-rows: 1fr;
      gap: 5px;
    }
    .preset-btn {
      background: linear-gradient(180deg, var(--btn-bg1), var(--btn-bg2));
      border: 2.5px solid var(--neon-light); border-radius: 8px;
      padding: 8px 6px; cursor: pointer; text-align: center;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3), 0 0 4px var(--neon-light-glow), inset 0 1px 0 rgba(255,255,255,0.06);
      transition: all 0.15s ease;
    }
    .preset-btn:active {
      transform: translateY(2px);
      box-shadow: 0 1px 2px rgba(0,0,0,0.3), inset 0 1px 3px rgba(0,0,0,0.3);
    }
    .preset-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .preset-btn.active {
      background: linear-gradient(180deg, var(--btn-active1), var(--btn-active2));
      border-color: var(--accent);
      box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 12px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);
      animation: presetPulse 2s ease-in-out infinite;
    }
    @keyframes presetPulse {
      0%,100%{box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 12px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);}
      50%{box-shadow: 0 3px 8px rgba(0,0,0,0.3), 0 0 20px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.1);}
    }
    .preset-btn.active .preset-num { color: var(--accent); }
    .preset-btn.active .preset-name { color: var(--accent); }
    .preset-btn.preset-special {
      border-color: rgba(255, 180, 50, 0.7);
      box-shadow: 0 3px 6px rgba(0,0,0,0.3), 0 0 8px rgba(255,180,50,0.25), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .preset-btn.preset-foreign {
      border-color: rgba(80, 180, 255, 0.5);
      box-shadow: 0 3px 6px rgba(0,0,0,0.3), 0 0 4px rgba(80,180,255,0.15), inset 0 1px 0 rgba(255,255,255,0.06);
    }
    .preset-btn.preset-empty { opacity: 0.35; cursor: default; border-style: dashed; }
    .preset-btn.preset-empty:hover { transform: none; box-shadow: 0 3px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.06); }
    .preset-btn.preset-empty:active { transform: none; }
    .preset-num {
      font-family: 'Orbitron', monospace; font-size: 10px; font-weight: 700;
      color: var(--preset-num); display: block; margin-bottom: 1px; transition: color 0.3s;
    }
    .preset-name {
      font-size: 7px; font-weight: 600; color: var(--preset-name);
      letter-spacing: 0.3px; white-space: nowrap; overflow: hidden;
      text-overflow: ellipsis; transition: color 0.6s;
    }
    .preset-tarot-cards { font-size: 14px; letter-spacing: -2px; }
    .preset-lucky7 { font-family: 'Orbitron', monospace; font-size: 16px; font-weight: 900; color: var(--accent); }

    /* === CONTROL PANEL === */
    .control-panel {
      display: flex; align-items: center; justify-content: space-between;
      gap: 16px; position: relative; z-index: 1;
    }
    .knob-area { display: flex; flex-direction: column; align-items: center; gap: 4px; }
    .knob-label {
      font-size: 7px; color: var(--preset-num); letter-spacing: 2px;
      text-transform: uppercase; font-weight: 600; transition: color 0.6s;
    }
    .knob-container { position: relative; width: 56px; height: 56px; }
    .knob-marks { position: absolute; top: 0; left: 0; right: 0; bottom: 0; }
    .knob-tick {
      position: absolute; width: 1px; height: 5px;
      background: var(--tick-color); top: 2px; left: 50%;
      transform-origin: 0 26px; transition: background 0.6s;
    }
    .knob {
      width: 48px; height: 48px; border-radius: 50%;
      background:
        repeating-conic-gradient(from 0deg, rgba(255,255,255,0.03) 0deg 6deg, transparent 6deg 12deg),
        linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light);
      box-shadow: 0 4px 8px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow), inset 0 2px 0 rgba(255,255,255,0.06), inset 0 -2px 4px rgba(0,0,0,0.3);
      position: absolute; top: 4px; left: 4px;
      cursor: pointer; transition: transform 0.1s ease;
    }
    .knob-indicator {
      position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
      width: 2px; height: 10px; background: var(--knob-ind);
      border-radius: 1px; transition: background 0.6s;
    }

    /* Play Button */
    .play-btn-container { display: flex; flex-direction: column; align-items: center; gap: 6px; }
    .play-btn {
      width: 64px; height: 64px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-active1), var(--btn-bg2));
      border: 2px solid var(--neon-light);
      box-shadow: 0 6px 12px rgba(0,0,0,0.5), 0 0 8px var(--neon-light-glow), inset 0 2px 0 rgba(255,255,255,0.08), inset 0 -2px 4px rgba(0,0,0,0.3);
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      color: var(--accent); transition: all 0.15s ease;
    }
    .play-btn:active {
      transform: scale(0.93);
      box-shadow: 0 2px 6px rgba(0,0,0,0.5), inset 0 2px 4px rgba(0,0,0,0.3);
    }
    .play-btn.playing {
      box-shadow: 0 6px 12px rgba(0,0,0,0.5), 0 0 20px var(--accent-glow), inset 0 2px 0 rgba(255,255,255,0.08);
    }
    .play-btn svg { fill: var(--accent); transition: fill 0.6s; }

    @keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }
    .spin { animation: spin 1s linear infinite; }

    /* === EQ PANEL === */
    .eq-toggle-btn {
      width: 48px; height: 48px; border-radius: 50%;
      background: linear-gradient(145deg, var(--btn-hi1), var(--btn-hi2));
      border: 1px solid var(--neon-light); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: var(--accent); font-family: 'Orbitron', monospace; font-size: 8px; font-weight: 700;
      letter-spacing: 1px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 4px var(--neon-light-glow);
      transition: all 0.2s ease;
    }
    .eq-toggle-btn:active { transform: scale(0.92); }
    .eq-toggle-btn.active {
      background: linear-gradient(145deg, var(--btn-active1), var(--btn-active2));
      box-shadow: 0 3px 6px rgba(0,0,0,0.4), 0 0 8px var(--accent-glow);
    }

    .eq-panel {
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.15));
      border: 1px solid var(--neon-light);
      border-radius: 12px; padding: 14px 16px; margin-bottom: 12px;
      position: relative; z-index: 1;
      box-shadow: 0 0 6px var(--neon-light-glow), inset 0 2px 6px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    .eq-panel-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 12px;
    }
    .eq-panel-title {
      font-family: 'Orbitron', monospace; font-size: 8px; font-weight: 700;
      color: var(--label-color); letter-spacing: 3px; text-transform: uppercase;
    }
    .eq-reset-btn {
      font-family: 'Orbitron', monospace; font-size: 7px; font-weight: 600;
      color: var(--accent); background: transparent;
      border: 1px solid var(--neon-light); border-radius: 4px;
      padding: 3px 8px; cursor: pointer; letter-spacing: 1px;
      transition: all 0.2s;
    }
    .eq-reset-btn:hover { background: rgba(255,255,255,0.05); }

    /* EQ Vertical Sliders */
    .eq-sliders {
      display: flex; justify-content: space-around; align-items: flex-end;
      gap: 4px; margin-bottom: 14px; padding: 0 8px;
    }
    .eq-slider-group {
      display: flex; flex-direction: column; align-items: center; gap: 6px;
    }
    .eq-slider-wrap {
      width: 28px; height: 100px; position: relative;
      display: flex; align-items: center; justify-content: center;
    }
    .eq-slider-wrap input[type="range"] {
      -webkit-appearance: none; appearance: none;
      width: 90px; height: 4px;
      background: linear-gradient(90deg, var(--neon-light-glow), var(--accent), var(--neon-light-glow));
      border-radius: 2px; outline: none;
      transform: rotate(-90deg);
      transform-origin: center center;
    }
    .eq-slider-wrap input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 16px; height: 16px;
      background: var(--accent); border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 6px var(--accent-glow), 0 2px 4px rgba(0,0,0,0.4);
    }
    .eq-freq-label {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--freq-mark); letter-spacing: 0.5px;
    }
    .eq-db-label {
      font-family: 'Orbitron', monospace; font-size: 7px;
      color: var(--lcd-dim); min-width: 30px; text-align: center;
    }

    /* Horizontal Controls (Woofer, Virtualizer) */
    .eq-extra-controls {
      display: flex; flex-direction: column; gap: 10px;
    }
    .eq-control-row {
      display: flex; align-items: center; gap: 10px;
    }
    .eq-control-label {
      font-family: 'Orbitron', monospace; font-size: 7px; font-weight: 600;
      color: var(--label-color); letter-spacing: 2px;
      min-width: 72px; text-transform: uppercase;
    }
    .eq-h-slider {
      -webkit-appearance: none; appearance: none;
      flex: 1; height: 4px;
      background: linear-gradient(90deg, var(--speaker-border), var(--accent));
      border-radius: 2px; outline: none;
    }
    .eq-h-slider::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 14px; height: 14px;
      background: var(--accent); border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 6px var(--accent-glow), 0 2px 4px rgba(0,0,0,0.4);
    }
    .eq-h-value {
      font-family: 'Orbitron', monospace; font-size: 8px;
      color: var(--lcd-text); min-width: 28px; text-align: right;
      text-shadow: 0 0 4px var(--lcd-glow);
    }

    /* === PHOTO SELECTION SCREEN (Radio Style) === */
    @keyframes landingShimmer {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }
    @keyframes landingPulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }
    @keyframes landingFloat {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }
    /* User Login Screen */
    .user-login-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, #060e1a 0%, #0a1828 30%, #081420 60%, #050c18 100%);
      z-index: 10001;
      display: flex; align-items: center; justify-content: center;
      padding: 16px;
      transition: opacity 0.5s ease;
    }
    .user-login-screen::before {
      content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(102,187,255,0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(102,187,255,0.04) 0%, transparent 50%);
      pointer-events: none;
    }
    .user-login-screen.hidden { display: none; }
    .login-radio-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #0e1e38, #081428);
      border-radius: 28px;
      padding: 3px;
      border: 1px solid rgba(102,187,255,0.35);
      box-shadow:
        0 40px 80px rgba(0,0,0,0.5),
        0 0 30px rgba(102,187,255,0.12),
        0 0 60px rgba(102,187,255,0.06),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .login-radio-inner {
      background: linear-gradient(145deg, #0c1a30, #081220);
      border-radius: 25px;
      padding: 20px;
      position: relative;
    }
    .login-box {
      text-align: center;
    }
    .login-box.hidden { display: none; }
    .login-lcd {
      background: linear-gradient(180deg, #020a14, #041018);
      border-radius: 12px; padding: 16px;
      margin-bottom: 16px;
      border: 2px solid rgba(102,187,255,0.3);
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.6), 0 0 12px rgba(102,187,255,0.08);
    }
    .login-lcd-title {
      font-family: 'Orbitron', monospace; font-size: 14px;
      color: #88CCFF; letter-spacing: 4px; font-weight: 700;
      text-shadow: 0 0 10px rgba(136,204,255,0.6);
      margin-bottom: 6px;
    }
    .login-lcd-sub {
      font-family: 'Inter', sans-serif; font-size: 12px;
      color: #5599CC;
    }
    .login-footer {
      margin-top: 20px; padding-top: 16px;
      border-top: 1px solid rgba(102,187,255,0.15);
      text-align: center;
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: rgba(102,187,255,0.4);
    }
    .footer-divider { margin: 0 8px; opacity: 0.5; }
    .footer-link {
      color: rgba(102,187,255,0.6); text-decoration: none;
      transition: color 0.2s;
    }
    .footer-link:hover { color: #66BBFF; }

    /* About Modal */
    .about-modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 20000;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .about-modal.visible { display: flex; }
    .about-content {
      background: linear-gradient(145deg, #2a2018, #1e1610);
      border: 2px solid rgba(212,175,105,0.3);
      border-radius: 24px; padding: 30px;
      max-width: 360px; width: 100%;
      position: relative;
      box-shadow: 0 30px 60px rgba(0,0,0,0.5);
    }
    .about-close {
      position: absolute; top: 15px; right: 20px;
      background: none; border: none;
      color: rgba(212,175,105,0.5); font-size: 28px;
      cursor: pointer; transition: color 0.2s;
    }
    .about-close:hover { color: #d4af69; }
    .about-header { text-align: center; margin-bottom: 20px; }
    .about-avatar {
      width: 80px; height: 80px; margin: 0 auto 16px;
      background: linear-gradient(135deg, #d4af69, #c49a50);
      border-radius: 50%; overflow: hidden;
    }
    .about-avatar img {
      width: 100%; height: 100%;
      object-fit: cover;
    }
    .about-name {
      font-family: 'Outfit', sans-serif; font-size: 22px;
      font-weight: 700; color: #d4af69; margin-bottom: 4px;
    }
    .about-title {
      font-family: 'Inter', sans-serif; font-size: 13px;
      color: rgba(212,175,105,0.6);
    }
    .about-body { text-align: center; }
    .about-intro {
      font-family: 'Inter', sans-serif; font-size: 14px;
      color: rgba(255,255,255,0.9); margin-bottom: 12px;
    }
    .about-desc {
      font-family: 'Inter', sans-serif; font-size: 13px;
      color: rgba(255,255,255,0.6); line-height: 1.6;
      margin-bottom: 20px;
    }
    .about-links { display: flex; justify-content: center; gap: 12px; }
    .about-link-btn {
      padding: 10px 24px; border-radius: 20px;
      background: linear-gradient(135deg, #d4af69, #c49a50);
      color: #1a1410; text-decoration: none;
      font-family: 'Outfit', sans-serif; font-size: 13px;
      font-weight: 600; transition: all 0.2s;
    }
    .about-link-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(212,175,105,0.3);
    }
    .about-footer {
      margin-top: 20px; padding-top: 16px;
      border-top: 1px solid rgba(212,175,105,0.15);
      text-align: center;
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: rgba(212,175,105,0.4);
    }
    .username-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(102,187,255,0.35);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 16px;
      text-align: center; outline: none;
      transition: border-color 0.3s;
    }
    .username-input:focus { border-color: rgba(102,187,255,0.6); }
    .username-input::placeholder { color: rgba(255,255,255,0.3); }
    .birth-input-group {
      margin-top: 12px; padding: 12px; border-radius: 12px;
      background: rgba(0,0,0,0.15); border: 1px solid rgba(102,187,255,0.15);
    }
    .birth-label {
      font-family: 'Outfit', sans-serif; font-size: 11px; font-weight: 600;
      color: rgba(102,187,255,0.7); letter-spacing: 1px; margin-bottom: 8px; text-align: center;
    }
    .birth-guide {
      font-family: 'Inter', sans-serif; font-size: 10px; line-height: 1.5;
      color: rgba(255,255,255,0.85); text-align: center; margin-bottom: 10px;
    }
    .birth-row {
      display: flex; gap: 6px;
    }
    .birth-field {
      flex: 1; padding: 10px 4px; border-radius: 10px;
      border: 2px solid rgba(102,187,255,0.25);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 15px;
      text-align: center; outline: none; transition: border-color 0.3s;
      -moz-appearance: textfield;
    }
    .birth-field::-webkit-outer-spin-button,
    .birth-field::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .birth-field:focus { border-color: rgba(102,187,255,0.6); }
    .birth-field::placeholder { color: rgba(255,255,255,0.3); font-size: 12px; }
    .birth-calendar-row {
      display: flex; justify-content: center; gap: 20px; margin-top: 8px;
    }
    .birth-radio-label {
      font-family: 'Inter', sans-serif; font-size: 13px; color: rgba(255,255,255,0.7);
      cursor: pointer; display: flex; align-items: center; gap: 4px;
    }
    .birth-radio-label input[type="radio"] {
      accent-color: #66BBFF; width: 14px; height: 14px;
    }
    .password-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(102,187,255,0.35);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 24px;
      text-align: center; outline: none; letter-spacing: 8px;
      transition: border-color 0.3s; margin-top: 12px;
    }
    .password-input:focus { border-color: rgba(102,187,255,0.6); }
    .password-input::placeholder { color: rgba(255,255,255,0.3); font-size: 14px; letter-spacing: 0; }
    .login-btn {
      margin-top: 20px; width: 100%; padding: 14px;
      background: linear-gradient(135deg, #66BBFF, #4499DD);
      border: none; border-radius: 16px;
      color: #041018; font-family: 'Outfit', sans-serif;
      font-size: 16px; font-weight: 700; letter-spacing: 2px;
      cursor: pointer; transition: all 0.3s;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(102,187,255,0.3);
    }
    .login-box.hidden { display: none; }
    .user-search-input {
      width: 100%; padding: 12px 16px; border-radius: 12px;
      border: 2px solid rgba(102,187,255,0.2);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 14px;
      outline: none; transition: border-color 0.2s;
      margin-bottom: 12px;
    }
    .user-search-input:focus { border-color: rgba(102,187,255,0.5); }
    .user-search-input::placeholder { color: rgba(255,255,255,0.3); }
    .user-list {
      max-height: 200px; overflow-y: auto;
      margin-bottom: 16px;
    }
    .user-list::-webkit-scrollbar { width: 6px; }
    .user-list::-webkit-scrollbar-thumb { background: rgba(102,187,255,0.3); border-radius: 3px; }
    .user-item {
      padding: 14px 20px; margin: 8px 0;
      background: rgba(0,0,0,0.3); border-radius: 12px;
      border: 2px solid rgba(102,187,255,0.2);
      color: #fff; font-family: 'Inter', sans-serif; font-size: 15px;
      cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; gap: 10px;
    }
    .user-item:hover {
      border-color: rgba(102,187,255,0.5);
      background: rgba(102,187,255,0.1);
    }
    .user-item-icon { font-size: 20px; }
    .user-item-name { flex: 1; }
    .new-user-btn {
      width: 100%; padding: 12px;
      background: transparent; border: 2px dashed rgba(102,187,255,0.4);
      border-radius: 12px; color: rgba(102,187,255,0.7);
      font-family: 'Inter', sans-serif; font-size: 14px;
      cursor: pointer; transition: all 0.2s;
    }
    .new-user-btn:hover {
      border-color: rgba(102,187,255,0.7);
      color: #66BBFF;
    }
    .back-btn {
      margin-top: 12px; width: 100%; padding: 10px;
      background: transparent; border: none;
      color: rgba(102,187,255,0.6); font-family: 'Inter', sans-serif;
      font-size: 13px; cursor: pointer; transition: color 0.2s;
    }
    .back-btn:hover { color: #66BBFF; }
    .no-users {
      padding: 30px; text-align: center;
      color: rgba(102,187,255,0.5); font-size: 13px;
      font-family: 'Inter', sans-serif;
    }
    .user-badge {
      position: absolute; top: 10px; right: 10px;
      background: rgba(102,187,255,0.2); padding: 6px 12px;
      border-radius: 12px; font-size: 11px; color: #66BBFF;
      font-family: 'Inter', sans-serif;
    }

    .photo-select-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, #040a18 0%, #081830 30%, #0a2040 60%, #061428 100%);
      z-index: 10000;
      display: flex; align-items: flex-start; justify-content: center;
      padding: 16px;
      overflow-y: auto; -webkit-overflow-scrolling: touch;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .photo-select-screen::before {
      content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 20% 30%, rgba(100,200,255,0.12) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 70%, rgba(60,160,255,0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(80,180,255,0.05) 0%, transparent 60%);
      pointer-events: none;
      animation: neonBgPulse 6s ease-in-out infinite;
    }
    @keyframes neonBgPulse {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }
    .photo-select-screen.hiding {
      opacity: 0; transform: scale(1.05); pointer-events: none;
    }
    .photo-select-screen.hidden { display: none; }
    .photo-radio-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #0c1e3a, #081428);
      border-radius: 28px;
      padding: 3px;
      margin: auto 0; flex-shrink: 0;
      box-shadow:
        0 40px 80px rgba(0,0,0,0.6),
        0 0 40px rgba(100,200,255,0.15),
        0 0 80px rgba(60,160,255,0.08),
        inset 0 1px 0 rgba(255,255,255,0.08);
      border: 2px solid rgba(100,200,255,0.5);
      position: relative;
    }
    .photo-radio-body::before {
      content: ''; position: absolute; top: -2px; left: 15%; right: 15%; height: 2px;
      background: linear-gradient(90deg, transparent, rgba(100,200,255,0.9), transparent);
      z-index: 3;
      box-shadow: 0 0 12px rgba(100,200,255,0.6);
    }
    .photo-radio-inner {
      background: linear-gradient(160deg, #0e1e38 0%, #0a1828 50%, #081420 100%);
      border-radius: 25px;
      padding: 24px 18px;
      position: relative;
      overflow: hidden;
    }
    .photo-radio-inner::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        repeating-linear-gradient(90deg, rgba(100,200,255,0.015) 0px, transparent 1px, transparent 3px),
        repeating-linear-gradient(0deg, rgba(100,200,255,0.01) 0px, transparent 1px, transparent 3px);
      pointer-events: none; border-radius: inherit;
    }
    /* Neon trim line */
    .photo-radio-inner::after {
      content: ''; position: absolute; top: 12px; left: 12px; right: 12px; bottom: 12px;
      border: 1px solid rgba(100,200,255,0.15);
      border-radius: 16px; pointer-events: none;
      box-shadow: inset 0 0 20px rgba(100,200,255,0.03);
    }
    /* Speaker grille top */
    .photo-speaker {
      background: linear-gradient(180deg, #06101e, #0c1828);
      border-radius: 14px;
      padding: 10px 12px;
      margin-bottom: 16px;
      border: 2px solid rgba(102,187,255,0.45);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(102,187,255,0.08);
    }
    .photo-speaker::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        radial-gradient(circle, rgba(102,187,255,0.08) 0.8px, transparent 0.8px),
        radial-gradient(circle, rgba(102,187,255,0.04) 0.8px, transparent 0.8px);
      background-size: 5px 5px, 5px 5px;
      background-position: 0 0, 2.5px 2.5px;
    }
    .photo-speaker-label {
      text-align: center;
      font-family: 'Orbitron', monospace;
      font-size: 9px; letter-spacing: 5px;
      font-weight: 900;
      color: #66BBFF;
      text-shadow: 0 0 10px rgba(102,187,255,0.5), 0 0 4px rgba(102,187,255,0.3);
      position: relative; z-index: 1;
    }
    /* Brand */
    .photo-brand {
      text-align: center; margin-bottom: 16px; position: relative; z-index: 1;
    }
    .photo-brand-text {
      font-family: 'Outfit', sans-serif;
      font-size: 22px; font-weight: 800;
      letter-spacing: 3px;
      text-shadow: 0 -1px 0 rgba(0,0,0,0.6), 0 1px 0 rgba(255,255,255,0.08), 0 2px 4px rgba(0,0,0,0.4);
    }
    .photo-brand-clara {
      color: #ff6b6b;
    }
    .photo-brand-cafe {
      color: #66BBFF;
    }
    .photo-brand-sub {
      display: block;
      font-family: 'Outfit', sans-serif;
      font-size: 12px; font-weight: 500;
      color: rgba(102,187,255,0.8);
      margin-top: 6px;
      letter-spacing: 1.5px;
    }
    /* Decorative divider */
    .photo-brand::after {
      content: ''; display: block;
      width: 80px; height: 1px; margin: 12px auto 0;
      background: linear-gradient(90deg, transparent, rgba(102,187,255,0.6), transparent);
    }
    /* LCD area - instructions */
    .photo-lcd {
      background: linear-gradient(180deg, #020a14, #061018);
      border-radius: 14px;
      padding: 16px 18px;
      margin-bottom: 16px;
      border: 2px solid rgba(102,187,255,0.4);
      text-align: center;
      position: relative; z-index: 1;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.8), 0 0 8px rgba(102,187,255,0.1);
    }
    .photo-lcd::before {
      content: ''; position: absolute; top: -1px; left: 10%; right: 10%; height: 1px;
      background: linear-gradient(90deg, transparent, rgba(102,187,255,0.6), transparent);
    }
    .photo-lcd-title {
      font-family: 'Orbitron', monospace;
      font-size: 14px; color: #99DDFF; letter-spacing: 3px;
      text-shadow: 0 0 16px rgba(153,221,255,0.7), 0 0 6px rgba(153,221,255,0.4);
      margin-bottom: 8px; font-weight: 700;
    }
    .photo-lcd-sub {
      font-family: 'Inter', sans-serif;
      font-size: 13px; color: rgba(102,187,255,0.8); line-height: 1.7; font-weight: 500;
      letter-spacing: 0.5px;
    }
    .photo-lcd-count {
      font-family: 'Orbitron', monospace;
      font-size: 24px; font-weight: 900;
      color: #f0d890; margin-top: 10px;
      text-shadow: 0 0 20px rgba(240,216,144,0.8), 0 0 8px rgba(240,216,144,0.5);
      animation: landingPulse 2s ease-in-out infinite;
    }
    /* Photo grid */
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      width: 100%;
      margin-bottom: 16px;
      position: relative; z-index: 1;
    }
    .photo-slot {
      position: relative;
      aspect-ratio: 1;
      border-radius: 12px;
      border: 2px dashed rgba(100,200,255,0.45);
      background: rgba(100,200,255,0.03);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.4);
    }
    .photo-slot:hover {
      border-color: rgba(100,200,255,0.8);
      background: rgba(100,200,255,0.06);
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.3), 0 0 18px rgba(100,200,255,0.2);
    }
    .photo-slot.filled {
      border: 2px solid rgba(100,200,255,0.6);
      box-shadow: 0 4px 16px rgba(0,0,0,0.3), 0 0 14px rgba(100,200,255,0.2);
    }
    .photo-slot.filled img {
      width: 100%; height: 100%; object-fit: cover;
      border-radius: 10px;
    }
    .photo-slot .slot-label {
      position: absolute; bottom: 4px; left: 0; right: 0;
      text-align: center; font-size: 9px;
      color: rgba(100,200,255,0.7);
      font-family: 'Orbitron', monospace;
      font-weight: 700; letter-spacing: 0.5px;
    }
    .photo-slot.filled .slot-label {
      background: linear-gradient(transparent, rgba(0,0,0,0.7));
      color: rgba(255,255,255,0.85);
      border-radius: 0 0 10px 10px;
      padding: 8px 0 4px; bottom: 0;
    }
    .photo-slot .slot-icon {
      font-size: 26px; color: rgba(100,200,255,0.4); transition: all 0.3s;
    }
    .photo-slot:hover .slot-icon { color: rgba(100,200,255,0.8); }
    .photo-slot .remove-photo {
      position: absolute; top: 4px; right: 4px;
      width: 22px; height: 22px; border-radius: 50%;
      background: rgba(180,60,60,0.85); color: #fff;
      border: 1px solid rgba(255,255,255,0.15);
      font-size: 13px; font-weight: 700; line-height: 1;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      z-index: 2; box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      backdrop-filter: blur(4px);
    }
    /* Control area */
    .photo-controls {
      display: flex; flex-direction: column; align-items: center; gap: 10px;
      position: relative; z-index: 1;
    }
    .photo-batch-btn {
      background: linear-gradient(135deg, rgba(100,200,255,0.12), rgba(60,160,255,0.06));
      color: rgba(100,200,255,0.9); border: 2px solid rgba(100,200,255,0.45);
      padding: 12px 28px; border-radius: 24px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 0.5px;
      transition: all 0.3s ease;
      backdrop-filter: blur(4px);
    }
    .photo-batch-btn:hover {
      background: linear-gradient(135deg, rgba(100,200,255,0.22), rgba(60,160,255,0.12));
      border-color: rgba(100,200,255,0.7);
      color: #88DDFF;
      box-shadow: 0 4px 24px rgba(100,200,255,0.25);
    }
    .photo-batch-btn:active { transform: scale(0.97); }
    .photo-batch-row {
      display: flex; gap: 10px; align-items: center; justify-content: center;
    }
    .photo-select-or {
      font-size: 10px; color: rgba(100,200,255,0.4);
      font-family: 'Orbitron', monospace; letter-spacing: 3px; font-weight: 600;
    }
    .photo-save-load-row {
      display: flex; gap: 12px; margin-bottom: 8px;
    }
    .photo-save-btn, .photo-load-btn {
      background: linear-gradient(135deg, rgba(100,200,255,0.15), rgba(60,160,255,0.08));
      color: #88CCFF; border: 2px solid rgba(100,200,255,0.45);
      padding: 10px 24px; border-radius: 20px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 1px;
      box-shadow: 0 4px 16px rgba(60,160,255,0.2);
      transition: all 0.3s ease;
    }
    .photo-save-btn {
      opacity: 0.3; pointer-events: none;
    }
    .photo-save-btn.ready {
      opacity: 1; pointer-events: auto;
    }
    .photo-load-btn {
      background: linear-gradient(135deg, rgba(80,220,160,0.15), rgba(60,180,120,0.08));
      color: #66DDAA; border-color: rgba(80,220,160,0.45);
      box-shadow: 0 4px 16px rgba(80,220,160,0.2);
    }
    .photo-save-btn.ready:hover, .photo-load-btn:hover {
      transform: translateY(-2px);
    }
    .photo-save-btn.ready:hover {
      background: linear-gradient(135deg, rgba(100,200,255,0.25), rgba(60,160,255,0.15));
      box-shadow: 0 6px 24px rgba(60,160,255,0.3);
      color: #AADDFF;
    }
    .photo-load-btn:hover {
      background: linear-gradient(135deg, rgba(80,220,160,0.25), rgba(60,180,120,0.15));
      box-shadow: 0 6px 24px rgba(80,220,160,0.3);
      color: #88EEBB;
    }
    .photo-save-btn.ready:active, .photo-load-btn:active { transform: scale(0.97); }
    .photo-reset-btn {
      background: linear-gradient(135deg, rgba(100,200,255,0.08), rgba(60,160,255,0.04));
      color: rgba(100,200,255,0.7); border: 2px solid rgba(100,200,255,0.3);
      padding: 8px 20px; border-radius: 16px;
      font-size: 12px; font-weight: 600; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 1px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    .photo-reset-btn:hover {
      background: linear-gradient(135deg, rgba(100,200,255,0.15), rgba(60,160,255,0.08));
      transform: translateY(-2px);
      box-shadow: 0 5px 18px rgba(100,200,255,0.15);
      color: #88DDFF;
    }
    .photo-reset-btn:active { transform: scale(0.97); }
    .album-list-popup {
      display: none; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(145deg, #0e1e38, #081428);
      border: 2px solid rgba(100,200,255,0.4);
      border-radius: 16px; padding: 0; min-width: 280px; max-width: 320px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.8), 0 0 20px rgba(100,200,255,0.1);
      z-index: 1000;
    }
    .album-list-popup.visible { display: block; }
    .album-list-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 16px; border-bottom: 1px solid rgba(100,200,255,0.2);
      color: #88CCFF; font-family: 'Outfit', sans-serif; font-weight: 600;
    }
    .album-list-close {
      background: none; border: none; color: rgba(100,200,255,0.6);
      font-size: 20px; cursor: pointer; padding: 0 4px;
    }
    .album-list-close:hover { color: #88DDFF; }
    .album-list-content {
      max-height: 250px; overflow-y: auto; padding: 8px;
    }
    .album-list-content::-webkit-scrollbar { width: 6px; }
    .album-list-content::-webkit-scrollbar-thumb {
      background: rgba(100,200,255,0.3); border-radius: 3px;
    }
    .album-item {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; margin: 4px 0; border-radius: 10px;
      background: rgba(0,0,0,0.2); cursor: pointer;
      transition: all 0.2s; border: 1px solid transparent;
    }
    .album-item:hover {
      background: rgba(100,200,255,0.08);
      border-color: rgba(100,200,255,0.3);
    }
    .album-item-icon { font-size: 20px; }
    .album-item-name {
      flex: 1; color: rgba(255,255,255,0.85);
      font-family: 'Inter', sans-serif; font-size: 13px;
      overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .album-item-count {
      color: rgba(100,200,255,0.6); font-size: 11px;
      font-family: 'Inter', sans-serif;
    }
    .album-item-delete {
      background: none; border: 1px solid rgba(255,100,100,0.3);
      color: rgba(255,100,100,0.6); font-size: 14px;
      width: 26px; height: 26px; border-radius: 50%;
      cursor: pointer; display: flex; align-items: center;
      justify-content: center; flex-shrink: 0;
      transition: all 0.2s;
    }
    .album-item-delete:hover {
      background: rgba(255,100,100,0.15);
      border-color: rgba(255,100,100,0.6);
      color: #ff6666;
    }
    .album-list-empty {
      text-align: center; padding: 30px 20px;
      color: rgba(100,200,255,0.5); font-size: 13px;
      font-family: 'Inter', sans-serif;
    }
    .mode-select-row {
      display: flex; gap: 12px; justify-content: center;
      opacity: 0.2; pointer-events: none;
      transition: all 0.3s ease;
    }
    .mode-select-row.ready {
      opacity: 1; pointer-events: auto;
    }
    .mode-btn {
      background: linear-gradient(135deg, #4a9eee, #3580cc);
      color: #fff; border: 2px solid rgba(100,200,255,0.6);
      padding: 14px 32px; border-radius: 28px;
      font-size: 14px; font-weight: 900; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 2px;
      box-shadow: 0 6px 24px rgba(60,160,255,0.35);
      transition: all 0.3s ease;
      flex: 1; max-width: 180px;
    }
    .mode-select-row.ready .mode-btn {
      animation: landingFloat 3s ease-in-out infinite;
    }
    .mode-btn:hover {
      transform: translateY(-2px);
      background: linear-gradient(135deg, #5cb0ff, #4a9eee);
      box-shadow: 0 8px 32px rgba(60,160,255,0.45), 0 0 24px rgba(100,200,255,0.2);
    }
    .mode-btn:active { transform: scale(0.97); animation: none; }
    .analog-btn {
      background: linear-gradient(135deg, #2a7acc, #1e60aa);
      border-color: rgba(60,160,255,0.5);
    }
    .analog-btn:hover {
      background: linear-gradient(135deg, #3a8add, #2a7acc);
    }
    /* Screws */
    .photo-screw {
      position: absolute; width: 8px; height: 8px;
      background: linear-gradient(145deg, #1a2848, #0e1e38);
      border-radius: 50%; border: 1px solid rgba(102,187,255,0.15);
      z-index: 2;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.4);
    }
    .photo-screw::after {
      content: ''; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%,-50%) rotate(35deg);
      width: 4px; height: 0.5px; background: rgba(102,187,255,0.3);
    }
    .photo-screw-tl { top: 10px; left: 10px; }
    .photo-screw-tr { top: 10px; right: 10px; }
    .photo-screw-bl { bottom: 10px; left: 10px; }
    .photo-screw-br { bottom: 10px; right: 10px; }

    /* === SONG DOWNLOAD BUTTON on Photo Screen === */
    .song-open-btn {
      background: linear-gradient(135deg, rgba(100,200,255,0.12), rgba(60,160,255,0.06));
      color: rgba(100,200,255,0.9); border: 2px solid rgba(100,200,255,0.4);
      padding: 11px 24px; border-radius: 22px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 0.5px;
      transition: all 0.3s ease; width: 100%;
      backdrop-filter: blur(4px); margin-top: 4px;
    }
    .song-open-btn:hover {
      background: linear-gradient(135deg, rgba(100,200,255,0.22), rgba(60,160,255,0.12));
      border-color: rgba(100,200,255,0.7); color: #88DDFF;
      box-shadow: 0 4px 24px rgba(100,200,255,0.25);
    }
    .song-open-btn:active { transform: scale(0.97); }

    /* === SONG DOWNLOAD SCREEN === */
    .song-dl-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(135deg, #040a18 0%, #081830 30%, #0a2040 60%, #061428 100%);
      z-index: 10002;
      display: flex; align-items: flex-start; justify-content: center;
      padding: 16px;
      overflow-y: auto; -webkit-overflow-scrolling: touch;
      transition: opacity 0.5s ease;
    }
    .song-dl-screen::before {
      content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(ellipse at 30% 20%, rgba(100,200,255,0.14) 0%, transparent 50%),
        radial-gradient(ellipse at 70% 80%, rgba(60,160,255,0.10) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(80,180,255,0.06) 0%, transparent 55%);
      pointer-events: none;
      animation: neonBgPulse 6s ease-in-out infinite;
    }
    .song-dl-screen.hidden { display: none; }
    .song-dl-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #0c1e3a, #081428);
      border-radius: 28px; padding: 3px;
      margin: auto 0; flex-shrink: 0;
      box-shadow:
        0 40px 80px rgba(0,0,0,0.6),
        0 0 50px rgba(100,200,255,0.12),
        0 0 100px rgba(60,160,255,0.06),
        inset 0 1px 0 rgba(255,255,255,0.08);
      border: 2px solid rgba(100,200,255,0.45);
      position: relative;
    }
    .song-dl-body::before {
      content: ''; position: absolute; top: -2px; left: 12%; right: 12%; height: 2px;
      background: linear-gradient(90deg, transparent, rgba(100,200,255,0.9), transparent);
      z-index: 3; box-shadow: 0 0 14px rgba(100,200,255,0.6);
    }
    .song-dl-inner {
      background: linear-gradient(160deg, #0e1e38 0%, #0a1828 50%, #081420 100%);
      border-radius: 25px; padding: 24px 18px;
      position: relative; overflow: hidden;
    }
    .song-dl-inner::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background:
        repeating-linear-gradient(90deg, rgba(100,200,255,0.012) 0px, transparent 1px, transparent 3px),
        repeating-linear-gradient(0deg, rgba(100,200,255,0.008) 0px, transparent 1px, transparent 3px);
      pointer-events: none; border-radius: inherit;
    }
    .song-dl-inner::after {
      content: ''; position: absolute; top: 12px; left: 12px; right: 12px; bottom: 12px;
      border: 1px solid rgba(100,200,255,0.12);
      border-radius: 16px; pointer-events: none;
    }
    .song-dl-close {
      position: absolute; top: 16px; right: 20px; z-index: 5;
      background: none; border: none;
      color: rgba(100,200,255,0.5); font-size: 28px;
      cursor: pointer; transition: color 0.2s; line-height: 1;
    }
    .song-dl-close:hover { color: #88DDFF; text-shadow: 0 0 10px rgba(100,200,255,0.5); }
    .song-dl-header {
      text-align: center; margin-bottom: 20px; position: relative; z-index: 1;
    }
    .song-dl-speaker {
      background: linear-gradient(180deg, #06101e, #0c1828);
      border-radius: 14px; padding: 10px 12px; margin-bottom: 16px;
      border: 2px solid rgba(102,187,255,0.45);
      position: relative; overflow: hidden;
      box-shadow: 0 0 10px rgba(102,187,255,0.08);
    }
    .song-dl-speaker::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        radial-gradient(circle, rgba(102,187,255,0.08) 0.8px, transparent 0.8px),
        radial-gradient(circle, rgba(102,187,255,0.04) 0.8px, transparent 0.8px);
      background-size: 5px 5px, 5px 5px;
      background-position: 0 0, 2.5px 2.5px;
    }
    .song-dl-speaker-label {
      text-align: center; font-family: 'Orbitron', monospace;
      font-size: 9px; letter-spacing: 5px; font-weight: 900;
      color: #66BBFF;
      text-shadow: 0 0 10px rgba(102,187,255,0.5), 0 0 4px rgba(102,187,255,0.3);
      position: relative; z-index: 1;
    }
    .song-dl-title {
      font-family: 'Outfit', sans-serif;
      font-size: 20px; font-weight: 800;
      background: linear-gradient(135deg, #66BBFF, #99DDFF, #66BBFF, #4499DD);
      background-size: 200% auto;
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: landingShimmer 4s linear infinite;
      letter-spacing: 1px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));
    }
    .song-dl-sub {
      font-family: 'Inter', sans-serif; font-size: 12px;
      color: rgba(100,200,255,0.7); margin-top: 6px; letter-spacing: 1px;
    }
    .song-dl-header::after {
      content: ''; display: block;
      width: 80px; height: 1px; margin: 14px auto 0;
      background: linear-gradient(90deg, transparent, rgba(100,200,255,0.6), transparent);
    }
    .song-dl-list {
      display: flex; flex-direction: column; gap: 12px;
      position: relative; z-index: 1;
    }
    .song-category {
      background: linear-gradient(145deg, rgba(100,200,255,0.06), rgba(60,160,255,0.02));
      border: 1px solid rgba(100,200,255,0.2);
      border-radius: 16px; padding: 14px 16px;
      transition: all 0.3s ease;
    }
    .song-category:hover {
      border-color: rgba(100,200,255,0.35);
      box-shadow: 0 0 20px rgba(100,200,255,0.08);
    }
    .song-cat-header {
      display: flex; align-items: center; gap: 10px; margin-bottom: 10px;
    }
    .song-cat-icon {
      font-size: 22px; width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      background: rgba(100,200,255,0.08); border-radius: 10px;
      border: 1px solid rgba(100,200,255,0.15);
    }
    .song-cat-title {
      font-family: 'Outfit', sans-serif; font-size: 15px; font-weight: 700;
      color: #AADDFF; letter-spacing: 0.5px;
    }
    .song-cat-btns {
      display: flex; gap: 8px;
    }
    .song-dl-btn {
      flex: 1; padding: 10px 8px; border-radius: 14px;
      font-family: 'Outfit', sans-serif; font-size: 12px; font-weight: 700;
      cursor: pointer; transition: all 0.3s ease;
      display: flex; align-items: center; justify-content: center; gap: 6px;
      letter-spacing: 0.5px; border: none; position: relative;
      overflow: hidden;
    }
    .song-dl-btn::before {
      content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      transition: left 0.5s;
    }
    .song-dl-btn:hover::before { left: 100%; }
    .song-dl-btn.kr {
      background: linear-gradient(135deg, #1a5a9e, #144a88);
      color: #BBDDFF;
      box-shadow: 0 3px 12px rgba(20,74,136,0.4), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .song-dl-btn.kr:hover {
      background: linear-gradient(135deg, #2068b0, #1a5a9e);
      box-shadow: 0 5px 20px rgba(32,104,176,0.5), 0 0 16px rgba(100,200,255,0.15);
      transform: translateY(-1px);
    }
    .song-dl-btn.en {
      background: linear-gradient(135deg, #0e4a3a, #0a3a2e);
      color: #AAEEDD;
      box-shadow: 0 3px 12px rgba(10,58,46,0.4), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .song-dl-btn.en:hover {
      background: linear-gradient(135deg, #125a48, #0e4a3a);
      box-shadow: 0 5px 20px rgba(18,90,72,0.5), 0 0 16px rgba(80,220,160,0.15);
      transform: translateY(-1px);
    }
    .song-dl-btn:active { transform: scale(0.96) !important; }
    .song-dl-btn .dl-icon { font-size: 14px; }
    .song-dl-btn.generating {
      opacity: 0.6; pointer-events: none;
    }
    .song-dl-btn.generating::after {
      content: ''; position: absolute;
      width: 16px; height: 16px; border: 2px solid transparent;
      border-top-color: currentColor; border-radius: 50%;
      animation: dlSpin 0.8s linear infinite;
    }
    @keyframes dlSpin { to { transform: rotate(360deg); } }
    .song-dl-back {
      margin-top: 18px; text-align: center; position: relative; z-index: 1;
    }
    .song-dl-back-btn {
      background: linear-gradient(135deg, rgba(100,200,255,0.1), rgba(60,160,255,0.05));
      color: rgba(100,200,255,0.8); border: 2px solid rgba(100,200,255,0.3);
      padding: 12px 36px; border-radius: 24px;
      font-size: 13px; font-weight: 700; font-family: 'Outfit', sans-serif;
      cursor: pointer; letter-spacing: 1px; transition: all 0.3s;
    }
    .song-dl-back-btn:hover {
      background: linear-gradient(135deg, rgba(100,200,255,0.18), rgba(60,160,255,0.1));
      border-color: rgba(100,200,255,0.6); color: #88DDFF;
      box-shadow: 0 4px 20px rgba(100,200,255,0.2);
    }
    .song-dl-back-btn:active { transform: scale(0.97); }

    /* === PHOTO UPLOAD (in-radio) === */
    .photo-upload-btn {
      display: none;
      width: 30px; height: 30px;
      border-radius: 50%;
      background: var(--accent-muted);
      border: 2px dashed var(--neon-light);
      color: var(--text-dim);
      font-size: 18px; line-height: 1;
      cursor: pointer;
      flex-shrink: 0;
      align-self: center;
      margin-left: 3px;
      transition: all 0.3s ease;
    }
    .photo-upload-btn:hover {
      background: var(--neon-light);
      color: var(--player-bg);
      box-shadow: 0 0 8px var(--neon-light-glow);
    }
    .photo-upload-btn.has-photos { display: flex; align-items: center; justify-content: center; }
    #photoUploadBtn { color: #f5c518; border-color: #f5c518; }
    #photoUploadBtn:hover { background: #f5c518; color: var(--player-bg); box-shadow: 0 0 8px rgba(245,197,24,0.5); }
    .brand-photos { display: contents; }
    .ctrl-photos { display: contents; }

    /* === PHOTO LIGHTBOX === */
    .photo-lightbox {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
      z-index: 9999; align-items: center; justify-content: center;
      cursor: pointer;
    }
    .photo-lightbox.visible { display: flex; }
    .photo-lightbox img {
      max-width: 85%; max-height: 85%;
      border-radius: 16px; object-fit: contain;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 12px var(--neon-glow);
      border: 2px solid var(--neon-border);
      animation: lightboxIn 0.3s ease;
    }
    @keyframes lightboxIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    /* === SCREWS === */
    .screw {
      position: absolute; width: 10px; height: 10px; border-radius: 50%;
      background: linear-gradient(145deg, var(--screw1), var(--screw2));
      border: 1px solid var(--btn-border);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.1); z-index: 2;
      transition: all 0.6s;
    }
    .screw::after {
      content: ''; position: absolute; top: 4px; left: 1px;
      width: 8px; height: 1px; background: var(--screw-line);
      transition: background 0.6s;
    }
    .screw-tl{top:12px;left:12px} .screw-tr{top:12px;right:12px}
    .screw-bl{bottom:12px;left:12px} .screw-br{bottom:12px;right:12px}

    /* === FOOTER === */
    .radio-footer {
      text-align: center; margin-top: 10px; padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.05);
      position: relative; z-index: 1;
    }
    .footer-text {
      font-size: 9px; color: var(--footer-color);
      letter-spacing: 1px; transition: color 0.6s;
      font-weight: 500;
    }
    .footer-text a { color: var(--footer-link); text-decoration: none; transition: color 0.6s; }
    .footer-text a:hover { color: var(--accent); }

    /* === ERROR === */
    .error-msg {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: #ff4b4b; text-align: center; margin-top: 8px;
      display: none; position: relative; z-index: 1;
    }
    .error-msg.visible { display: block; }

    /* ============================================
       RESPONSIVE - MOBILE FIRST
       ============================================ */

    /* Desktop: 라디오 body 둥글게 */
    @media (min-width: 481px) {
      .radio { padding: 6px; border-radius: 24px; }
      .radio-inner { border-radius: 20px; padding: 24px 20px 20px; }
      .radio-inner::before { border-radius: 20px; }
      .theme-switcher { border-radius: 20px 20px 0 0; }
      .theme-name { margin-bottom: 6px; }
    }

    /* Tablet */
    @media (max-width: 540px) {
      body { padding: 10px; }
      .radio { max-width: 100%; }
    }

    /* === Mobile (phones) === */
    @media (max-width: 480px) {
      body {
        padding: 0;
        justify-content: flex-start;
        min-height: 100vh;
        min-height: 100dvh;
      }

      /* Theme switcher: 라디오 안에 붙이기 */
      .theme-name { font-size: 0; height: 0; margin: 0; overflow: hidden; }
      .theme-switcher {
        margin: 0;
        padding: 8px 12px;
        border-radius: 0;
        background: rgba(0,0,0,0.25);
        border: none;
        border-bottom: 1px solid rgba(255,255,255,0.04);
        justify-content: center;
        gap: 10px;
        width: 100%;
      }
      .theme-dot {
        width: 32px; height: 32px;
        flex-shrink: 0;
      }

      /* Radio body: 풀 화면 */
      .radio {
        max-width: 100%;
        border-radius: 0;
        padding: 0;
        border-width: 2px 0;
        box-shadow:
          0 0 8px var(--neon-glow),
          inset 0 0 8px var(--neon-glow);
        min-height: 100vh;
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
      }
      .radio-inner {
        border-radius: 0;
        padding: 14px 16px 16px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .radio-inner::before { border-radius: 0; }

      /* Antenna 숨김 */
      .antenna { display: none; }

      /* Screws 숨김 */
      .screw { display: none; }

      /* Brand */
      .radio-top-row1 { margin-bottom: 4px; }
      .radio-top-row2 { margin-bottom: 8px; padding-bottom: 8px; }
      .brand { font-size: 18px; letter-spacing: 2px; }
      .power-btn { width: 38px; height: 38px; }

      /* Speaker: 컴팩트 */
      .speaker-grille {
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 10px;
      }
      .eq-container { height: 36px; gap: 2px; }
      .eq-bar { width: 4px; }

      /* LCD: 컴팩트 */
      .lcd-display {
        padding: 10px 14px;
        margin-bottom: 10px;
        min-height: 74px;
        border-radius: 8px;
      }
      .lcd-name { font-size: 13px; }
      .lcd-freq { font-size: 22px; }
      .lcd-provider { font-size: 8px; margin-bottom: 2px; }
      .lcd-status { font-size: 7px; margin-top: 3px; }

      /* Tuning: 컴팩트 */
      .tuning-section {
        padding: 8px 14px;
        margin-bottom: 10px;
        border-radius: 8px;
      }
      .tuning-label { margin-bottom: 6px; }
      .freq-band { height: 22px; }
      .tuning-needle { height: 18px; top: 2px; }
      .freq-mark { font-size: 6px; }

      /* Preset: flex-grow로 남은 공간 활용 */
      .preset-section {
        margin-bottom: 10px;
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
      }
      .preset-label { margin-bottom: 6px; }
      .preset-scroll { flex: 1; min-height: 0; }
      .preset-buttons {
        gap: 4px;
        grid-template-columns: repeat(5, 1fr);
      }
      .preset-btn {
        padding: 7px 4px;
        border-radius: 6px;
        min-width: auto;
      }
      .eq-panel { padding: 10px 12px; margin-bottom: 8px; }
      .eq-slider-wrap { height: 80px; }
      .eq-slider-wrap input[type="range"] { width: 70px; }
      .preset-num { font-size: 10px; }
      .preset-name { font-size: 6.5px; }

      /* Controls: 컴팩트 */
      .control-panel { gap: 8px; }
      .knob-container { width: 50px; height: 50px; }
      .knob { width: 42px; height: 42px; top: 4px; left: 4px; }
      .knob-indicator { top: 5px; height: 9px; }
      .knob-tick { height: 4px; }
      .knob-label { font-size: 6px; }
      .play-btn { width: 58px; height: 58px; border-width: 2px; }
      .play-btn svg { width: 24px; height: 24px; }

      /* Footer: 컴팩트 */
      .radio-footer { margin-top: 8px; padding-top: 8px; }
      .footer-text { font-size: 8px; }
    }

    /* === Small phones (SE, mini 등) === */
    @media (max-width: 380px) {
      .radio-inner { padding: 10px 12px 12px; }
      .brand { font-size: 16px; }
      .speaker-grille { padding: 8px; margin-bottom: 8px; }
      .eq-container { height: 30px; }
      .lcd-display { padding: 8px 12px; margin-bottom: 8px; min-height: 66px; }
      .lcd-freq { font-size: 19px; }
      .lcd-name { font-size: 11px; }
      .tuning-section { padding: 6px 12px; margin-bottom: 8px; }
      .freq-band { height: 20px; }
      .tuning-needle { height: 16px; }
      .preset-section { margin-bottom: 8px; }
      .preset-buttons { gap: 3px; grid-template-columns: repeat(5, 1fr); }
      .preset-btn { padding: 5px 3px; min-width: auto; }
      .preset-num { font-size: 9px; }
      .preset-name { font-size: 5.5px; }
      .control-panel { gap: 6px; }
      .knob-container { width: 44px; height: 44px; }
      .knob { width: 38px; height: 38px; top: 3px; left: 3px; }
      .play-btn { width: 52px; height: 52px; }
      .theme-dot { width: 28px; height: 28px; }
      .theme-switcher { gap: 6px; padding: 6px 8px; }
    }

    /* === Very small phones === */
    @media (max-width: 340px) {
      .theme-dot { width: 24px; height: 24px; }
      .theme-switcher { gap: 5px; }
      .brand { font-size: 14px; }
      .lcd-freq { font-size: 17px; }
      .play-btn { width: 48px; height: 48px; }
      .knob-container { width: 40px; height: 40px; }
      .knob { width: 34px; height: 34px; top: 3px; left: 3px; }
      .preset-buttons { grid-template-columns: repeat(5, 1fr); }
      .preset-btn { min-width: auto; padding: 4px 2px; }
    }

    /* Landscape phone */
    @media (max-height: 500px) and (orientation: landscape) {
      body { justify-content: flex-start; }
      .radio { min-height: auto; }
      .radio-inner { min-height: auto; flex: none; }
      .speaker-grille { padding: 6px; margin-bottom: 6px; }
      .eq-container { height: 24px; }
      .lcd-display { min-height: 58px; padding: 6px 12px; margin-bottom: 6px; }
      .lcd-freq { font-size: 18px; }
      .tuning-section { padding: 4px 12px; margin-bottom: 6px; }
      .preset-section { margin-bottom: 6px; }
      .eq-panel { padding: 8px 10px; margin-bottom: 4px; }
      .eq-slider-wrap { height: 60px; }
      .eq-slider-wrap input[type="range"] { width: 50px; }
      .eq-extra-controls { gap: 4px; }
      .control-panel { gap: 6px; }
      .knob-container { width: 40px; height: 40px; }
      .knob { width: 34px; height: 34px; top: 3px; left: 3px; }
      .play-btn { width: 48px; height: 48px; }
      .radio-footer { display: none; }
    }

    /* Touch: 터치 타겟 최소 크기 보장 */
    @media (pointer: coarse) {
      .preset-btn { min-height: 40px; }
      .power-btn { width: 40px; height: 40px; }
      .play-btn { min-width: 52px; min-height: 52px; }
      .theme-dot { min-width: 28px; min-height: 28px; }
    }

    /* === ANNIVERSARY SECTION === */
    .anniversary-section {
      margin-bottom: 10px; position: relative; z-index: 2;
      margin-top: 16px; padding: 16px 12px 12px;
      border-top: none !important;
      background: linear-gradient(145deg, #FFF8E7, #F2E8D0) !important;
      border-radius: 14px;
      border: 1px solid rgba(139,105,20,0.15) !important;
      box-shadow: 0 8px 24px rgba(100,70,30,0.1), inset 0 1px 0 rgba(255,255,255,0.3) !important;
      isolation: isolate;
    }
    .anniversary-label {
      font-family: 'Orbitron', monospace; font-size: 8px; font-weight: 600;
      color: #8B6914 !important; letter-spacing: 3px; margin-bottom: 6px;
    }
    .anniversary-panel {
      background: rgba(255,255,255,0.4) !important;
      border: 1px solid rgba(139,105,20,0.12) !important; border-radius: 10px;
      padding: 10px 12px;
      box-shadow: none !important;
    }
    .anniversary-list { display: flex; flex-direction: column; gap: 4px; }
    .anniversary-item {
      display: flex; align-items: center; gap: 6px;
      padding: 4px 6px; border-radius: 8px;
      background: rgba(255,255,255,0.5) !important;
      border: 1px solid rgba(139,105,20,0.1) !important;
    }
    .anniversary-item .anniv-name {
      font-family: 'Inter', sans-serif; font-size: 10px; font-weight: 600;
      color: #3a2a10 !important; flex: 1; min-width: 0;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .anniversary-item .anniv-date {
      font-family: 'Orbitron', monospace; font-size: 8px;
      color: #6a5530 !important; opacity: 0.7; flex-shrink: 0;
    }
    .anniversary-item .anniv-dday {
      font-family: 'Orbitron', monospace; font-size: 10px; font-weight: 700;
      flex-shrink: 0; min-width: 48px; text-align: right;
    }
    .anniv-dday.future { color: #8B6914 !important; }
    .anniv-dday.today { color: #8B6914 !important; text-shadow: 0 0 6px rgba(200,169,110,0.5); }
    .anniv-dday.past { color: #8B6914 !important; opacity: 0.5; }
    .anniversary-item .anniv-edit {
      background: none; border: 1px solid rgba(0,0,0,0.2); color: #1a1a1a !important;
      font-size: 8px; cursor: pointer; padding: 1px 4px; opacity: 0.7;
      transition: all 0.2s; border-radius: 3px; font-family: 'Inter', sans-serif;
      white-space: nowrap; flex-shrink: 0; margin-right: 10px;
    }
    .anniversary-item .anniv-edit:hover { opacity: 1; color: #000 !important; border-color: #3a2a10; }
    .anniversary-item .anniv-del {
      background: none; border: 1px solid rgba(255,68,68,0.4); color: #ff4444 !important;
      font-size: 12px; cursor: pointer; padding: 0 3px; opacity: 0.7;
      transition: all 0.2s; border-radius: 3px;
    }
    .anniversary-item .anniv-del:hover { opacity: 1; color: #ff6b6b; }
    .anniversary-item.bday-anniv { flex-wrap: wrap; }
    .anniversary-item.bday-anniv .anniv-name { flex: none; }
    .anniversary-item.bday-anniv .anniv-bday-date { font-family: 'Inter', sans-serif; font-size: 9px; color: #3a2a10; white-space: nowrap; }
    .anniversary-item.bday-anniv .anniv-bday-sep { color: rgba(139,105,20,0.2); font-size: 9px; }
    .anniversary-item.bday-anniv .anniv-dday { min-width: auto; font-size: 9px; }
    .anniversary-item.bday-anniv .anniv-bday-lived { font-family: 'Inter', sans-serif; font-size: 9px; color: #3a2a10; white-space: nowrap; margin-left: auto; }
    .anniversary-add-row {
      display: flex; gap: 3px; margin-top: 5px; align-items: center;
    }
    .anniversary-add-row input[type="text"] {
      width: 58px; min-width: 0; flex-shrink: 1; padding: 3px 4px; font-size: 9px;
      font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 4px; color: #3a2a10 !important; outline: none;
    }
    .anniv-type-select {
      padding: 3px 1px; font-size: 8px; font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 4px; color: #3a2a10 !important; outline: none;
      cursor: pointer; flex-shrink: 0;
    }
    .anniv-type-select option { color: #3a2a10; background: #FFF8E7; }
    .anniv-date-field {
      width: 28px; padding: 3px 1px; font-size: 8px; text-align: center;
      font-family: 'Orbitron', monospace;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 4px; color: #3a2a10 !important; outline: none;
    }
    .anniv-date-field::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .anniv-date-field::placeholder { color: rgba(100,70,30,0.3); font-size: 8px; }
    .anniversary-add-row button {
      background: linear-gradient(135deg, #C8A96E, #b89858) !important;
      border: none !important; border-radius: 5px;
      color: #fff !important; font-size: 12px; font-weight: 700;
      width: 22px; height: 22px; cursor: pointer; padding: 0;
      display: flex; align-items: center; justify-content: center; flex-shrink: 0;
    }
    .anniversary-add-row button:active { transform: scale(0.95); }
    .anniv-cal-select, .dash-cal-select {
      padding: 3px 2px; font-size: 9px; font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 4px; color: #3a2a10 !important; outline: none;
      cursor: pointer; flex-shrink: 0;
    }
    .anniv-cal-select option, .dash-cal-select option { color: #3a2a10; background: #FFF8E7; }
    .dash-cal-select { padding: 5px 4px; font-size: 11px; border-radius: 6px; }
    .anniv-cal-tag {
      font-size: 7px; padding: 1px 3px; border-radius: 2px;
      background: rgba(200,169,110,0.15); color: #8B6914;
      margin-left: 2px; vertical-align: middle; font-family: 'Inter', sans-serif;
    }
    .anniv-type-icon { font-size: 10px; margin-right: 2px; flex-shrink: 0; }
    .anniversary-empty {
      font-size: 9px; color: #6a5530; opacity: 0.6;
      text-align: center; padding: 4px 0; font-family: 'Inter', sans-serif;
    }
    .anniversary-add-row.hidden { display: none; }

    /* Anniversary Login */
    .anniv-login-row {
      display: flex; gap: 4px; align-items: center; margin-bottom: 8px;
    }
    .anniv-login-row input {
      padding: 4px 6px; font-size: 10px; font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 4px; color: #3a2a10 !important; outline: none;
    }
    .anniv-login-row input[type="text"] { flex: 1; min-width: 0; }
    .anniv-login-row input[type="password"] { width: 52px; text-align: center; letter-spacing: 2px; }
    .anniv-login-row button {
      background: linear-gradient(135deg, #C8A96E, #b89858) !important;
      border: none !important; border-radius: 6px;
      color: #fff !important; font-size: 9px; font-weight: 700;
      padding: 4px 8px; cursor: pointer; white-space: nowrap;
      font-family: 'Orbitron', monospace;
    }
    .anniv-login-row button:active { transform: scale(0.95); }
    .anniv-user-row {
      display: flex; gap: 6px; align-items: center; margin-bottom: 8px;
    }
    .anniv-user-row .anniv-user-name {
      font-family: 'Inter', sans-serif; font-size: 11px; font-weight: 700;
      color: #8B6914 !important; flex: 1;
    }
    .anniv-user-row button {
      background: linear-gradient(135deg, #C8A96E, #b89858) !important;
      border: none !important; border-radius: 6px;
      font-size: 8px; font-weight: 700; padding: 3px 7px; cursor: pointer;
      font-family: 'Orbitron', monospace; white-space: nowrap;
    }
    .anniv-user-row button:active { transform: scale(0.95); }
    .anniv-user-row .anniv-dash-btn { color: #fff; }
    .anniv-user-row .anniv-logout-btn { color: #fff; }
    .anniv-user-row.hidden { display: none; }

    /* Birthday Info */
    .anniv-birthday-info {
      display: none; padding: 6px 10px; margin-bottom: 6px; border-radius: 8px;
      background: rgba(255,255,255,0.4) !important; border: 1px solid rgba(139,105,20,0.1) !important;
      align-items: center; gap: 6px;
    }
    .anniv-birthday-info.visible { display: flex; }
    .anniv-bday-icon { font-size: 12px; flex-shrink: 0; }
    .anniv-bday-date {
      font-family: 'Inter', sans-serif; font-size: 10px;
      color: #3a2a10 !important; white-space: nowrap;
    }
    .anniv-bday-sep { color: rgba(139,105,20,0.2) !important; font-size: 10px; }
    .anniv-bday-dday {
      font-family: 'Orbitron', monospace; font-size: 11px; font-weight: 700;
      color: #8B6914 !important; white-space: nowrap;
    }
    .anniv-bday-dday.today { color: #8B6914 !important; text-shadow: 0 0 8px rgba(200,169,110,0.5); }
    .anniv-bday-lived {
      font-family: 'Inter', sans-serif; font-size: 10px;
      color: #3a2a10 !important; white-space: nowrap; margin-left: auto;
    }

    /* Dashboard Modal */
    .dashboard-overlay {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); z-index: 9999;
      justify-content: center; align-items: center;
    }
    .dashboard-overlay.visible { display: flex; }
    .dashboard-modal {
      background: linear-gradient(145deg, #FFF8E7, #F2E8D0) !important;
      border: 1px solid rgba(139,105,20,0.2) !important; border-radius: 20px;
      padding: 24px 20px; width: 90%; max-width: 360px; max-height: 80vh;
      overflow-y: auto; position: relative;
      box-shadow: 0 40px 80px rgba(100,70,30,0.15), 0 0 40px rgba(200,169,110,0.15), inset 0 1px 0 rgba(255,255,255,0.3) !important;
    }
    .dashboard-modal::-webkit-scrollbar { width: 4px; }
    .dashboard-modal::-webkit-scrollbar-thumb { background: rgba(200,169,110,0.4); border-radius: 2px; }
    .dashboard-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 16px; padding-bottom: 10px;
      border-bottom: 1px solid rgba(139,105,20,0.15) !important;
    }
    .dashboard-title {
      font-family: 'Orbitron', monospace; font-size: 14px; font-weight: 700;
      color: #8B6914 !important; letter-spacing: 2px;
    }
    .dashboard-close {
      background: none; border: none; color: #A08050 !important;
      font-size: 20px; cursor: pointer; padding: 0 4px;
    }
    .dashboard-close:hover { color: #ff6b6b !important; }
    .dashboard-admin-back { margin-bottom: 10px; }
    .dashboard-admin-back.hidden { display: none; }
    .dashboard-user-info {
      margin-bottom: 16px; padding: 12px 14px; border-radius: 12px;
      background: rgba(255,255,255,0.5) !important; border: 1px solid rgba(139,105,20,0.12) !important;
    }
    .dashboard-user-name {
      font-family: 'Outfit', sans-serif; font-size: 16px; font-weight: 700;
      color: #3a2a10 !important; margin-bottom: 2px;
    }
    .dashboard-user-email {
      font-family: 'Inter', sans-serif; font-size: 10px;
      color: #6a5530 !important; opacity: 0.8;
    }
    .dashboard-section-title {
      font-family: 'Orbitron', monospace; font-size: 9px; font-weight: 600;
      color: #8B6914 !important; letter-spacing: 2px; margin-bottom: 8px;
    }
    .dashboard-usage-list { display: flex; flex-direction: column; gap: 4px; margin-bottom: 8px; }
    .dashboard-usage-item {
      display: flex; align-items: center; gap: 8px;
      padding: 6px 10px; border-radius: 8px;
      background: rgba(255,255,255,0.4) !important; border: 1px solid rgba(139,105,20,0.1) !important;
    }
    .dashboard-usage-item .usage-no {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: #C8A96E !important; font-weight: 700; min-width: 18px;
    }
    .dashboard-usage-item .usage-name {
      flex: 1; font-family: 'Inter', sans-serif; font-size: 11px;
      color: #3a2a10 !important;
    }
    .dashboard-usage-item .usage-count {
      font-family: 'Orbitron', monospace; font-size: 12px;
      color: #8B6914 !important; font-weight: 700; min-width: 30px; text-align: right;
    }
    .dashboard-usage-item .usage-received {
      font-family: 'Orbitron', monospace; font-size: 12px;
      color: #8B6914 !important; font-weight: 700; min-width: 30px; text-align: right;
    }
    .dashboard-usage-header {
      display: flex; align-items: center; gap: 8px;
      padding: 2px 10px 6px; font-family: 'Inter', sans-serif; font-size: 9px;
      color: #8B6914 !important; letter-spacing: 0.5px;
    }
    .dashboard-usage-header .usage-no { min-width: 18px; }
    .dashboard-usage-header .usage-name { flex: 1; }
    .dashboard-usage-header .usage-count { min-width: 30px; text-align: right; }
    .dashboard-usage-header .usage-received { min-width: 30px; text-align: right; }
    .dashboard-anniv-list { display: flex; flex-direction: column; gap: 6px; }
    .dashboard-anniv-item {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 10px; border-radius: 10px;
      background: rgba(255,255,255,0.4) !important; border: 1px solid rgba(139,105,20,0.12) !important;
    }
    .dashboard-anniv-item.nearest {
      border-color: #C8A96E !important;
      box-shadow: 0 0 10px rgba(200,169,110,0.25) !important;
    }
    .dashboard-anniv-item .dash-name {
      font-family: 'Inter', sans-serif; font-size: 12px; font-weight: 600;
      color: #3a2a10 !important; flex: 1;
    }
    .dashboard-anniv-item .dash-date {
      font-family: 'Orbitron', monospace; font-size: 9px;
      color: #6a5530 !important; opacity: 0.7;
    }
    .dashboard-anniv-item .dash-dday {
      font-family: 'Orbitron', monospace; font-size: 12px; font-weight: 700;
      min-width: 56px; text-align: right; color: #8B6914 !important;
    }
    .dashboard-empty {
      font-size: 11px; color: #6a5530 !important; opacity: 0.6;
      text-align: center; padding: 16px 0; font-family: 'Inter', sans-serif;
    }
    .dashboard-anniv-item .dash-edit {
      background: none; border: 1px solid rgba(0,0,0,0.25); color: #1a1a1a !important;
      font-size: 9px; cursor: pointer; padding: 2px 6px; opacity: 0.7;
      transition: all 0.2s; flex-shrink: 0; border-radius: 4px;
      font-family: 'Inter', sans-serif; white-space: nowrap; margin-right: 14px;
    }
    .dashboard-anniv-item .dash-edit:hover { opacity: 1; color: #000 !important; border-color: #3a2a10; }
    .dashboard-anniv-item .dash-del {
      background: none; border: 1px solid rgba(255,68,68,0.4); color: #ff4444 !important;
      font-size: 14px; cursor: pointer; padding: 0 4px; opacity: 0.7;
      transition: all 0.2s; flex-shrink: 0; border-radius: 4px;
    }
    .dashboard-anniv-item .dash-del:hover { opacity: 1; color: #ff6b6b !important; }
    .dashboard-anniv-item.bday-anniv { flex-wrap: wrap; }
    .dashboard-anniv-item.bday-anniv .dash-name { flex: none; }
    .dashboard-anniv-item.bday-anniv .anniv-bday-date { font-family: 'Inter', sans-serif; font-size: 10px; color: #3a2a10 !important; white-space: nowrap; }
    .dashboard-anniv-item.bday-anniv .anniv-bday-sep { color: rgba(139,105,20,0.2) !important; font-size: 10px; }
    .dashboard-anniv-item.bday-anniv .dash-dday { min-width: auto; font-size: 10px; text-align: left; }
    .dashboard-anniv-item.bday-anniv .anniv-bday-lived { font-family: 'Inter', sans-serif; font-size: 10px; color: #3a2a10 !important; white-space: nowrap; margin-left: auto; }
    .dashboard-add-row {
      display: flex; gap: 4px; margin-top: 10px; padding-top: 8px;
      border-top: 1px solid rgba(139,105,20,0.1) !important; align-items: center;
    }
    .dashboard-add-row input[type="text"] {
      width: 70px; min-width: 0; flex-shrink: 1; padding: 5px 6px; font-size: 11px;
      font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 6px; color: #3a2a10 !important; outline: none;
    }
    .dash-type-select {
      padding: 5px 2px; font-size: 10px; font-family: 'Inter', sans-serif;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 6px; color: #3a2a10 !important; outline: none;
      cursor: pointer; flex-shrink: 0;
    }
    .dash-type-select option { color: #3a2a10; background: #FFF8E7; }
    .dash-date-field {
      width: 34px; padding: 5px 2px; font-size: 10px; text-align: center;
      font-family: 'Orbitron', monospace;
      background: rgba(255,255,255,0.7) !important; border: 1px solid rgba(139,105,20,0.2) !important;
      border-radius: 6px; color: #3a2a10 !important; outline: none;
    }
    .dash-date-field::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .dash-date-field::placeholder { color: rgba(100,70,30,0.3) !important; font-size: 10px; }
    .dashboard-add-row button {
      background: linear-gradient(135deg, #C8A96E, #b89858) !important;
      border: none !important; border-radius: 8px;
      color: #fff !important; font-size: 18px; font-weight: 700;
      width: 34px; height: 34px; cursor: pointer; padding: 0;
      display: flex; align-items: center; justify-content: center;
    }
    .dashboard-add-row button:active { transform: scale(0.95); }
    .dashboard-add-row.hidden { display: none; }

    /* === Fortune Modal === */
    .fortune-overlay {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.75); z-index: 9999;
      justify-content: center; align-items: center;
    }
    .fortune-overlay.visible { display: flex; }
    .fortune-modal {
      background: linear-gradient(160deg, var(--body-from, #2a2218), var(--body-to, #1a150e));
      border: 2px solid var(--accent); border-radius: 18px;
      padding: 22px 18px; width: 92%; max-width: 370px; max-height: 85vh;
      overflow-y: auto; position: relative;
      box-shadow: 0 0 40px rgba(0,0,0,0.6), 0 0 20px var(--accent-glow);
    }
    .fortune-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 14px; padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .fortune-title {
      font-family: 'Orbitron', monospace; font-size: 15px; font-weight: 700;
      color: var(--accent); letter-spacing: 2px;
    }
    .fortune-close {
      background: none; border: none; color: var(--preset-name, #999);
      font-size: 24px; cursor: pointer; padding: 0 4px;
    }
    .fortune-close:hover { color: var(--needle, #ff6b6b); }
    .fortune-date {
      text-align: center; font-family: 'Inter', sans-serif; font-size: 13px;
      color: var(--preset-name, #bbb); margin-bottom: 14px;
    }
    .fortune-zodiac-box {
      display: flex; align-items: center; justify-content: center; gap: 16px;
      padding: 14px; margin-bottom: 14px; border-radius: 12px;
      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);
    }
    .fortune-zodiac-item {
      display: flex; flex-direction: column; align-items: center; gap: 4px;
    }
    .fortune-zodiac-emoji { font-size: 30px; }
    .fortune-zodiac-name {
      font-family: 'Outfit', sans-serif; font-size: 14px; font-weight: 600;
      color: var(--lcd-text, #e0e0e0);
    }
    .fortune-zodiac-sub {
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: var(--preset-name, #bbb);
    }
    .fortune-score-wrap { text-align: center; margin-bottom: 16px; }
    .fortune-score-bar {
      width: 100%; height: 8px; border-radius: 4px;
      background: rgba(255,255,255,0.08); overflow: hidden; margin-top: 6px;
    }
    .fortune-score-fill {
      height: 100%; border-radius: 4px;
      background: linear-gradient(90deg, var(--accent), var(--needle, #ff6b6b));
      transition: width 0.8s ease;
    }
    .fortune-score-label {
      font-family: 'Orbitron', monospace; font-size: 12px; font-weight: 600;
      color: var(--accent); letter-spacing: 1px;
    }
    .fortune-score-num {
      font-family: 'Orbitron', monospace; font-size: 24px; font-weight: 700;
      color: var(--lcd-text, #e0e0e0); margin: 4px 0;
    }
    .fortune-categories { display: flex; flex-direction: column; gap: 8px; margin-bottom: 14px; }
    .fortune-cat-card {
      padding: 12px; border-radius: 10px;
      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);
    }
    .fortune-cat-header { display: flex; align-items: center; gap: 6px; margin-bottom: 6px; }
    .fortune-cat-icon { font-size: 16px; }
    .fortune-cat-title {
      font-family: 'Outfit', sans-serif; font-size: 13px; font-weight: 700;
      color: var(--accent); letter-spacing: 1px;
    }
    .fortune-cat-text {
      font-family: 'Inter', sans-serif; font-size: 14px; line-height: 1.6;
      color: var(--lcd-text, #f0f0f0);
    }
    .fortune-lucky-row { display: flex; gap: 8px; }
    .fortune-lucky-card {
      flex: 1; padding: 10px; border-radius: 10px; text-align: center;
      background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);
    }
    .fortune-lucky-label {
      font-family: 'Outfit', sans-serif; font-size: 11px; font-weight: 600;
      color: var(--preset-name, #999); letter-spacing: 1px; margin-bottom: 4px;
    }
    .fortune-lucky-value {
      font-family: 'Orbitron', monospace; font-size: 18px; font-weight: 700;
      color: var(--lcd-text, #e0e0e0);
    }
    .fortune-lucky-color-dot {
      display: inline-block; width: 16px; height: 16px; border-radius: 50%;
      vertical-align: middle; margin-right: 4px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .fortune-login-msg {
      text-align: center; padding: 30px 10px;
      font-family: 'Inter', sans-serif; font-size: 15px;
      color: var(--preset-name, #999); line-height: 1.8;
    }

    /* === Tarot Modal === */
    .tarot-overlay {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); z-index: 9999;
      justify-content: center; align-items: center;
    }
    .tarot-overlay.visible { display: flex; }
    .tarot-modal {
      background: linear-gradient(160deg, #1a1028, #0e0a18);
      border: 2px solid #9b59b6; border-radius: 18px;
      padding: 22px 18px; width: 92%; max-width: 370px; max-height: 85vh;
      overflow-y: auto; position: relative;
      box-shadow: 0 0 40px rgba(155,89,182,0.3), 0 0 20px rgba(155,89,182,0.15);
    }
    .tarot-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 14px; padding-bottom: 10px;
      border-bottom: 1px solid rgba(155,89,182,0.2);
    }
    .tarot-title {
      font-family: 'Orbitron', monospace; font-size: 15px; font-weight: 700;
      color: #9b59b6; letter-spacing: 2px;
    }
    .tarot-close {
      background: none; border: none; color: #777;
      font-size: 24px; cursor: pointer; padding: 0 4px;
    }
    .tarot-close:hover { color: #e74c3c; }
    .tarot-date {
      text-align: center; font-family: 'Inter', sans-serif; font-size: 13px;
      color: #bbb; margin-bottom: 16px;
    }
    .tarot-spread {
      display: flex; gap: 10px; justify-content: center; margin-bottom: 18px;
    }
    .tarot-card-slot {
      flex: 1; max-width: 100px; text-align: center;
    }
    .tarot-card {
      width: 100%; aspect-ratio: 2/3; border-radius: 10px;
      background: linear-gradient(145deg, #2d1f4e, #1a1030);
      border: 2px solid #9b59b6;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 8px 4px; margin-bottom: 6px;
      box-shadow: 0 4px 15px rgba(155,89,182,0.25);
    }
    .tarot-card-num {
      font-family: 'Orbitron', monospace; font-size: 11px; font-weight: 600;
      color: rgba(155,89,182,0.85); margin-bottom: 4px;
    }
    .tarot-card-symbol { font-size: 30px; margin-bottom: 4px; }
    .tarot-card-name {
      font-family: 'Outfit', sans-serif; font-size: 11px; font-weight: 600;
      color: #d4b6e8; text-align: center; line-height: 1.2;
    }
    .tarot-card-position {
      font-family: 'Orbitron', monospace; font-size: 11px; font-weight: 600;
      color: #f0d060; letter-spacing: 1px;
    }
    .tarot-readings {
      display: flex; flex-direction: column; gap: 10px;
    }
    .tarot-reading-card {
      padding: 12px; border-radius: 10px;
      background: rgba(155,89,182,0.06); border: 1px solid rgba(155,89,182,0.12);
    }
    .tarot-reading-header {
      display: flex; align-items: center; gap: 6px; margin-bottom: 6px;
    }
    .tarot-reading-pos {
      font-family: 'Orbitron', monospace; font-size: 12px; font-weight: 600;
      color: #f0d060; letter-spacing: 1px;
    }
    .tarot-reading-name {
      font-family: 'Outfit', sans-serif; font-size: 13px; font-weight: 700;
      color: #d4b6e8;
    }
    .tarot-reading-text {
      font-family: 'Inter', sans-serif; font-size: 14px; line-height: 1.6;
      color: #e8e8e8;
    }
    .tarot-login-msg {
      text-align: center; padding: 30px 10px;
      font-family: 'Inter', sans-serif; font-size: 15px;
      color: #bbb; line-height: 1.8;
    }

  </style>
  <script defer src="https://cdn.jsdelivr.net/npm/hls.js@1.6.15"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/lamejs@1.2.1/lame.min.js"></script>
</head>
<body>

<!-- User Login Screen -->
<div class="user-login-screen" id="userLoginScreen">
  <div class="login-radio-body">
    <div class="login-radio-inner">
      <div class="photo-screw photo-screw-tl"></div>
      <div class="photo-screw photo-screw-tr"></div>
      <div class="photo-screw photo-screw-bl"></div>
      <div class="photo-screw photo-screw-br"></div>

      <div class="photo-speaker">
        <div class="photo-speaker-label">STEREO RADIO</div>
      </div>

      <div class="photo-brand">
        <span class="photo-brand-text"><span class="photo-brand-clara">클라라</span> <span class="photo-brand-cafe">라디오카페</span></span>
        <span class="photo-brand-sub">나만의 추억 사진을 보면서 라디오 방송을 들으세요!</span>
      </div>

      <!-- 사용자 선택 화면 -->
      <div class="login-box" id="userSelectBox">
        <div class="login-lcd">
          <div class="login-lcd-title">USER SELECT</div>
          <div class="login-lcd-sub">사용자를 선택(또는 검색)하거나, 새 사용자 등록하세요.</div>
        </div>
        <input type="text" id="userSearchInput" class="user-search-input" placeholder="" autocomplete="off" oninput="filterUsers()">
        <div class="user-list" id="userList"></div>
        <button class="new-user-btn" onclick="showNewUserForm()">+ 새 사용자 등록</button>
      </div>

      <!-- 비밀번호 입력 화면 -->
      <div class="login-box hidden" id="passwordBox">
        <div class="login-lcd">
          <div class="login-lcd-title">PASSWORD</div>
          <div class="login-lcd-sub"><span id="selectedUserName"></span>님, 비밀번호를 입력하세요</div>
        </div>
        <input type="password" id="passwordInput" class="password-input" placeholder="●●●●" maxlength="4" inputmode="numeric" pattern="[0-9]*" autocomplete="off">
        <button class="login-btn" onclick="submitPassword()">확인</button>
        <button class="back-btn" onclick="showUserSelect()">← 돌아가기</button>
      </div>

      <!-- 새 사용자 등록 화면 -->
      <div class="login-box hidden" id="newUserBox">
        <div class="login-lcd">
          <div class="login-lcd-title">NEW USER</div>
          <div class="login-lcd-sub">닉네임, 이메일, 생년월일, 비밀번호를 입력하세요</div>
        </div>
        <input type="text" id="newUsernameInput" class="username-input" placeholder="닉네임을 입력하세요" maxlength="20">
        <input type="email" id="newEmailInput" class="username-input" placeholder="예: hong@email.com" style="margin-top:8px;">
        <div class="birth-input-group">
          <div class="birth-label">생년월일</div>
          <div class="birth-guide">생년월일을 입력하면 매일 오늘의 운세를 받아볼 수 있으며, 내 생일까지 며칠 남았는지 알림 서비스를 제공합니다.</div>
          <div class="birth-row">
            <input type="number" id="newBirthYear" class="birth-field" placeholder="년" min="1920" max="2010" inputmode="numeric">
            <input type="number" id="newBirthMonth" class="birth-field" placeholder="월" min="1" max="12" inputmode="numeric">
            <input type="number" id="newBirthDay" class="birth-field" placeholder="일" min="1" max="31" inputmode="numeric">
          </div>
          <div class="birth-calendar-row">
            <label class="birth-radio-label"><input type="radio" name="birthCalendar" value="solar" checked> 양력</label>
            <label class="birth-radio-label"><input type="radio" name="birthCalendar" value="lunar"> 음력</label>
          </div>
        </div>
        <div class="birth-label" style="margin-top:10px;">성별</div>
        <div class="birth-calendar-row">
          <label class="birth-radio-label"><input type="radio" name="userGender" value="male" checked> 남자</label>
          <label class="birth-radio-label"><input type="radio" name="userGender" value="female"> 여자</label>
        </div>
        <input type="password" id="newPasswordInput" class="password-input" placeholder="●●●●" maxlength="4" inputmode="numeric" pattern="[0-9]*" autocomplete="off">
        <button class="login-btn" onclick="registerNewUser()">등록하기</button>
        <button class="back-btn" onclick="showUserSelect()">← 돌아가기</button>
      </div>

      <!-- 푸터 -->
      <div class="login-footer">
        <span>© 2026 클라라 라디오카페</span>
        <span class="footer-divider">|</span>
        <a href="landing.html" class="footer-link" style="color: #d4a862; font-weight: 700;">소개</a>
        <span class="footer-divider">|</span>
        <a href="manual.html" class="footer-link" style="color: #ff69b4; font-weight: 700;">사용법</a>
        <span class="footer-divider">|</span>
        <a href="admin.html" class="footer-link">관리자</a>
        <span class="footer-divider">|</span>
        <a href="about.html" class="footer-link">Hyein Cho</a>
      </div>
    </div>
  </div>
</div>

<!-- About Modal -->
<div class="about-modal" id="aboutModal" onclick="hideAbout(event)">
  <div class="about-content" onclick="event.stopPropagation()">
    <button class="about-close" onclick="hideAbout()">&times;</button>
    <div class="about-header">
      <div class="about-avatar"><img src="profile.jpg" alt="Hyein Cho"></div>
      <div class="about-name">조혜인 (Hyein Cho)</div>
      <div class="about-title">마이펫태일 대표 · 인셀랩 대표 · 서양화가</div>
    </div>
    <div class="about-body">
      <p class="about-intro">안녕하세요! 클라라 라디오카페를 만든 심재우입니다.</p>
      <p class="about-desc">음악과 추억을 함께 즐길 수 있는 공간을 만들고 싶었습니다. 나만의 사진을 보면서 라디오를 들으며 편안한 시간을 보내세요.</p>
      <div class="about-links">
        <a href="https://github.com/jaiwshim-project" target="_blank" class="about-link-btn">GitHub</a>
      </div>
    </div>
    <div class="about-footer">
      <span>클라라 라디오카페 v1.0</span>
    </div>
  </div>
</div>

<!-- Dashboard Modal -->
<div class="dashboard-overlay" id="dashboardOverlay" onclick="if(event.target===this)closeDashboard()">
  <div class="dashboard-modal">
    <div class="dashboard-header">
      <span class="dashboard-title">MY DASHBOARD</span>
      <button class="dashboard-close" onclick="closeDashboard()">&times;</button>
    </div>
    <div class="dashboard-admin-back hidden" id="dashAdminBack">
      <button onclick="location.href='admin.html?tab=users'" style="background:linear-gradient(135deg,#C8A96E,#b89858);border:none;border-radius:8px;color:#fff;font-family:'Orbitron',monospace;font-size:10px;font-weight:700;padding:8px 14px;cursor:pointer;width:100%;">관리자 페이지로 돌아가기</button>
    </div>
    <div class="dashboard-user-info">
      <div class="dashboard-user-name" id="dashUserName"></div>
      <div class="dashboard-user-email" id="dashUserEmail"></div>
    </div>
    <div class="dashboard-section-title">소확행 아이템 통계</div>
    <div class="dashboard-usage-list" id="dashUsageList">
      <div class="dashboard-empty">로딩 중...</div>
    </div>
    <div class="dashboard-section-title" style="margin-top:16px;">ANNIVERSARIES</div>
    <div class="dashboard-anniv-list" id="dashAnnivList"></div>
    <div class="dashboard-add-row" id="dashAddRow">
      <input type="text" id="dashAnnivNameInput" placeholder="기념일 이름" maxlength="12" autocomplete="off">
      <select id="dashAnnivTypeSelect" class="dash-type-select"><option value="birthday">생일</option><option value="wedding">결혼기념일</option><option value="meeting">만난 날</option></select>
      <input type="number" id="dashAnnivYearInput" class="dash-date-field" placeholder="년" min="1920" max="2030" inputmode="numeric">
      <input type="number" id="dashAnnivMonthInput" class="dash-date-field" placeholder="월" min="1" max="12" inputmode="numeric">
      <input type="number" id="dashAnnivDayInput" class="dash-date-field" placeholder="일" min="1" max="31" inputmode="numeric">
      <select id="dashAnnivCalSelect" class="dash-cal-select"><option value="solar">양력</option><option value="lunar">음력</option></select>
      <button onclick="addAnniversaryFromDash()">+</button>
    </div>
  </div>
</div>

<!-- Fortune Modal -->
<div class="fortune-overlay" id="fortuneOverlay" onclick="if(event.target===this)closeFortune()">
  <div class="fortune-modal">
    <div class="fortune-header">
      <span class="fortune-title">TODAY'S FORTUNE</span>
      <button class="fortune-close" onclick="closeFortune()">&times;</button>
    </div>
    <div id="fortuneContent"></div>
  </div>
</div>

<!-- Tarot Modal -->
<div class="tarot-overlay" id="tarotOverlay" onclick="if(event.target===this)closeTarot()">
  <div class="tarot-modal">
    <div class="tarot-header">
      <span class="tarot-title">TAROT READING</span>
      <button class="tarot-close" onclick="closeTarot()">&times;</button>
    </div>
    <div id="tarotContent"></div>
  </div>
</div>

<!-- Photo Selection Screen -->
<div class="photo-select-screen hidden" id="photoSelectScreen">
  <div class="photo-radio-body">
    <div class="photo-radio-inner">
      <div class="photo-screw photo-screw-tl"></div>
      <div class="photo-screw photo-screw-tr"></div>
      <div class="photo-screw photo-screw-bl"></div>
      <div class="photo-screw photo-screw-br"></div>

      <div class="photo-speaker">
        <div class="photo-speaker-label">STEREO RADIO</div>
      </div>

      <div class="photo-brand">
        <span class="photo-brand-text"><span class="photo-brand-clara">클라라</span> <span class="photo-brand-cafe">라디오카페</span> - 15개 방송듣기</span>
        <span class="photo-brand-sub">나만의 추억 사진을 보면서 라디오 방송을 들으세요!</span>
      </div>

      <div class="photo-lcd">
        <div class="photo-lcd-title">PHOTO SELECT</div>
        <div class="photo-lcd-sub">갤러리에서 사진을 선택하세요<br>상단 4장 + 하단 2장</div>
        <div class="photo-lcd-count" id="photoCount">0 / 6</div>
      </div>

      <div class="photo-grid" id="photoGrid">
        <div class="photo-slot" data-idx="0" onclick="pickSlotPhoto(0)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 1</div>
        </div>
        <div class="photo-slot" data-idx="1" onclick="pickSlotPhoto(1)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 2</div>
        </div>
        <div class="photo-slot" data-idx="2" onclick="pickSlotPhoto(2)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 3</div>
        </div>
        <div class="photo-slot" data-idx="3" onclick="pickSlotPhoto(3)">
          <span class="slot-icon">+</span>
          <div class="slot-label">상단 4</div>
        </div>
        <div class="photo-slot" data-idx="4" onclick="pickSlotPhoto(4)">
          <span class="slot-icon">+</span>
          <div class="slot-label">하단 좌</div>
        </div>
        <div class="photo-slot" data-idx="5" onclick="pickSlotPhoto(5)">
          <span class="slot-icon">+</span>
          <div class="slot-label">하단 우</div>
        </div>
      </div>

      <div class="photo-controls">
        <div class="photo-batch-row">
          <button class="photo-batch-btn" onclick="pickAllPhotos()">갤러리에서 6장 한번에 선택</button>
          <button class="photo-reset-btn" onclick="resetPhotos()">사진선택 초기화</button>
        </div>
        <input type="file" id="batchFileInput" accept="image/*" multiple style="display:none">
        <div class="photo-select-or">- OR -</div>
        <div class="photo-save-load-row">
          <button class="photo-save-btn" id="photoSaveBtn" onclick="savePhotosToAlbum()">새 사진첩 저장</button>
          <button class="photo-load-btn" id="photoLoadBtn" onclick="showAlbumList()">사진첩 불러오기</button>
        </div>
        <div class="album-list-popup" id="albumListPopup">
          <div class="album-list-header">
            <span>📚 사진첩 목록</span>
            <button class="album-list-close" onclick="hideAlbumList()">&times;</button>
          </div>
          <div class="album-list-content" id="albumListContent"></div>
        </div>
        <a class="song-open-btn" href="song.html" style="display:block;text-align:center;text-decoration:none;">축하 노래 MP3 다운로드</a>
        <div class="mode-select-row" id="modeSelectRow">
          <button class="mode-btn analog-btn" onclick="document.body.style.visibility='hidden';location.href='analog.html'">ANALOG</button>
          <button class="mode-btn digital-btn" onclick="completePhotoSelect()">DIGITAL</button>
        </div>
      </div>

      <input type="file" id="slotFileInput" accept="image/*" style="display:none">
    </div>
  </div>
</div>


<!-- Theme Name (desktop only) -->
<div class="theme-name" id="themeName">WOOD CLASSIC</div>

<div class="radio" id="radioBody">
  <div class="antenna" id="antenna"></div>

  <!-- Theme Switcher: 라디오 본체 안 상단 -->
  <div class="theme-switcher" id="themeSwitcher">
    <button class="theme-toggle-btn" id="themeToggleBtn" onclick="toggleThemeDots()" title="테마 감추기">◀</button>
    <div class="theme-dots-wrap" id="themeDotsWrap">
      <div class="theme-dot active" data-t="wood" title="우드 클래식 · 나무결" onclick="setTheme('wood')"></div>
      <div class="theme-dot" data-t="cream" title="레트로 크림 · 가죽" onclick="setTheme('cream')"></div>
      <div class="theme-dot" data-t="black" title="미드나잇 블랙 · 카본파이버" onclick="setTheme('black')"></div>
      <div class="theme-dot" data-t="military" title="밀리터리 · 캔버스" onclick="setTheme('military')"></div>
      <div class="theme-dot" data-t="silver" title="크롬 실버 · 브러시드메탈" onclick="setTheme('silver')"></div>
      <div class="theme-dot" data-t="cyber" title="네온 사이버 · 회로기판" onclick="setTheme('cyber')"></div>
      <div class="theme-dot" data-t="rose" title="로즈 골드 · 대리석" onclick="setTheme('rose')"></div>
      <div class="theme-dot" data-t="maltese" title="말티즈 · 털 결" onclick="setTheme('maltese')"></div>
      <div class="theme-dot" data-t="purple" title="퍼플 갤럭시 · 성운" onclick="setTheme('purple')"></div>
      <div class="theme-dot" data-t="hotpink" title="핫핑크 네온 · 글로우" onclick="setTheme('hotpink')"></div>
      <div class="theme-dot" data-t="skyblue" title="스카이블루 네온 · 하늘" onclick="setTheme('skyblue')"></div>
    </div>
  </div>

  <div class="radio-inner">
    <div class="screw screw-tl"></div>
    <div class="screw screw-tr"></div>
    <div class="screw screw-bl"></div>
    <div class="screw screw-br"></div>

    <!-- Brand & Power (1줄) -->
    <div class="radio-top-row1">
      <div class="brand"><span class="brand-clara">클라라</span> <span class="brand-cafe">라디오카페</span></div>
      <button class="power-btn" id="powerBtn" title="전원">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M12 2v10"/><path d="M18.4 6.6a9 9 0 1 1-12.8 0"/></svg>
      </button>
    </div>
    <!-- Photos & Mode Switch (2줄) -->
    <div class="radio-top-row2">
      <button class="photo-upload-btn" id="photoUploadBtn" onclick="reopenPhotoSelect()" title="사진 변경">+</button>
      <span class="brand-photos" id="brandPhotos"></span>
      <button class="digital-to-analog-btn" onclick="if(currentStation)localStorage.setItem('radio-switch-station',currentStation.id);document.body.style.visibility='hidden';location.href='analog.html'" title="아날로그 모드">ANALOG ▸</button>
    </div>

    <!-- Speaker Grille -->
    <div class="speaker-grille">
      <div class="speaker-label">STEREO</div>
      <div class="speaker-mesh"></div>
      <div class="eq-container" id="equalizer"></div>
    </div>

    <!-- LCD Display -->
    <div class="lcd-display">
      <div class="lcd-idle" id="lcdIdle"><span style="display:block;margin-bottom:2px"><span id="lcdDate" style="font-size:11px;font-weight:600;color:var(--needle,#ff6b6b);opacity:0.85"></span> <span id="lcdLunar" style="font-size:10px;font-weight:500;color:var(--accent,#d4a574);opacity:0.75"></span></span><span id="lcdClock" style="font-size:22px;font-weight:700;display:block;margin-bottom:4px"></span><span style="font-size:9px;opacity:0.6;letter-spacing:3px">SELECT STATION</span></div>
      <div class="lcd-active" id="lcdActive">
        <div class="lcd-provider" id="lcdProvider"></div>
        <div class="lcd-name" id="lcdName"></div>
        <div class="lcd-freq" id="lcdFreq"></div>
        <div class="lcd-status">
          <span id="lcdStatusText"><span class="on-air-dot" id="onAirDot" style="display:none"></span>PLAYING</span>
          <div class="lcd-signal" id="lcdSignal">
            <div class="lcd-signal-bar" style="height:4px"></div>
            <div class="lcd-signal-bar" style="height:7px"></div>
            <div class="lcd-signal-bar" style="height:10px"></div>
            <div class="lcd-signal-bar" style="height:13px"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tuning Dial -->
    <div class="tuning-section">
      <div class="tuning-label">FM TUNING</div>
      <div class="freq-band">
        <div class="freq-ticks" id="freqTicks"></div>
        <div class="freq-marks">
          <span class="freq-mark">88</span><span class="freq-mark">92</span>
          <span class="freq-mark">96</span><span class="freq-mark">100</span>
          <span class="freq-mark">104</span><span class="freq-mark">108</span>
        </div>
        <div class="tuning-needle" id="tuningNeedle"></div>
      </div>
    </div>

    <!-- Preset Station Buttons -->
    <div class="preset-section">
      <div class="preset-label">PRESET STATIONS</div>
      <div class="preset-scroll">
        <div class="preset-buttons" id="presetButtons"></div>
      </div>
    </div>

    <!-- EQ Panel -->
    <div class="eq-panel" id="eqPanel" style="display:none">
      <div class="eq-panel-header">
        <span class="eq-panel-title">EQUALIZER</span>
        <button class="eq-reset-btn" onclick="resetEQ()">RESET</button>
      </div>
      <div class="eq-sliders">
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb0">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="0" oninput="updateEQ(0,this.value)"></div>
          <span class="eq-freq-label">60</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb1">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="1" oninput="updateEQ(1,this.value)"></div>
          <span class="eq-freq-label">230</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb2">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="2" oninput="updateEQ(2,this.value)"></div>
          <span class="eq-freq-label">910</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb3">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="3" oninput="updateEQ(3,this.value)"></div>
          <span class="eq-freq-label">3.6k</span>
        </div>
        <div class="eq-slider-group">
          <div class="eq-db-label" id="eqDb4">0</div>
          <div class="eq-slider-wrap"><input type="range" min="-12" max="12" value="0" data-eq="4" oninput="updateEQ(4,this.value)"></div>
          <span class="eq-freq-label">14k</span>
        </div>
      </div>
      <div class="eq-extra-controls">
        <div class="eq-control-row">
          <span class="eq-control-label">BASS BOOST</span>
          <input type="range" class="eq-h-slider" id="wooferSlider" min="0" max="12" value="0" step="0.5" oninput="updateWoofer(this.value)">
          <span class="eq-h-value" id="wooferValue">0</span>
        </div>
        <div class="eq-control-row">
          <span class="eq-control-label">VIRTUAL</span>
          <input type="range" class="eq-h-slider" id="virtualizerSlider" min="0" max="100" value="0" oninput="updateVirtualizer(this.value)">
          <span class="eq-h-value" id="virtualizerValue">0</span>
        </div>
      </div>
    </div>

    <!-- Control Panel -->
    <div class="control-panel">
      <div class="knob-area">
        <div class="knob-container" id="knobContainer">
          <div class="knob-marks" id="knobMarks"></div>
          <div class="knob" id="volumeKnob" title="볼륨 조절"><div class="knob-indicator"></div></div>
        </div>
        <div class="knob-label">VOLUME</div>
      </div>
      <span class="ctrl-photos" id="ctrlPhotoLeft"></span>
      <div class="play-btn-container">
        <button class="play-btn" id="playBtn" onclick="togglePlay()">
          <svg id="playIcon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="7,3 21,12 7,21"/></svg>
          <svg id="pauseIcon" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" stroke="none" style="display:none"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
          <svg id="loaderIcon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" style="display:none" class="spin"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
        </button>
      </div>
      <span class="ctrl-photos" id="ctrlPhotoRight"></span>
      <div class="knob-area">
        <button class="eq-toggle-btn" id="eqToggleBtn" onclick="toggleEqPanel()" title="이퀄라이저">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
        </button>
        <div class="knob-label">EQ</div>
      </div>
    </div>

    <!-- Anniversary Section -->
    <div class="anniversary-section">
      <div class="anniversary-label">ANNIVERSARY</div>
      <div class="anniversary-panel">
        <div class="anniv-user-row" id="annivUserRow">
          <span class="anniv-user-name" id="annivUserName"></span>
          <button class="anniv-dash-btn" onclick="openDashboard()">DASHBOARD</button>
        </div>
        <div class="anniv-birthday-info" id="annivBirthdayInfo"></div>
        <div class="anniversary-list" id="anniversaryList"></div>
        <div class="anniversary-add-row hidden" id="anniversaryAddRow">
          <input type="text" id="annivNameInput" placeholder="기념일 이름" maxlength="12" autocomplete="off">
          <select id="annivTypeSelect" class="anniv-type-select"><option value="birthday">생일</option><option value="wedding">결혼기념일</option><option value="meeting">만난 날</option></select>
          <input type="number" id="annivYearInput" class="anniv-date-field" placeholder="년" min="1920" max="2030" inputmode="numeric">
          <input type="number" id="annivMonthInput" class="anniv-date-field" placeholder="월" min="1" max="12" inputmode="numeric">
          <input type="number" id="annivDayInput" class="anniv-date-field" placeholder="일" min="1" max="31" inputmode="numeric">
          <select id="annivCalSelect" class="anniv-cal-select"><option value="solar">양력</option><option value="lunar">음력</option></select>
          <button onclick="addAnniversary()">+</button>
        </div>
      </div>
    </div>

    <div class="error-msg" id="errorMsg"></div>

    <!-- Photo Lightbox -->
    <div class="photo-lightbox" id="photoLightbox" onclick="closeLightbox()">
      <img id="lightboxImg" src="" alt="">
    </div>

    <div class="radio-footer">
      <div class="footer-text">&copy; 2026 클라라 라디오카페 <span style="margin:0 4px;opacity:0.5;">|</span> <a href="landing.html" style="color:var(--accent);font-weight:700;">소개</a> <span style="margin:0 4px;opacity:0.5;">|</span> <a href="manual.html">사용법</a> <span style="margin:0 4px;opacity:0.5;">|</span> <a href="admin.html">관리자</a> <span style="margin:0 4px;opacity:0.5;">|</span> <a href="about.html"><strong>Hyein Cho</strong></a></div>
    </div>
  </div>
</div>

<script>
  // === Station Data ===
  var STATIONS = [
    {id:'kbs-1fm',name:'KBS 클래식FM',url:'',apiUrl:'https://cfpwwwapi.kbs.co.kr/api/v1/landing/live/channel_code/24',freq:'93.1 MHz',freqNum:93.1,logoText:'KBS 클래식',provider:'KBS'},
    {id:'ebs-fm',name:'EBS FM',url:'https://ebsonair.ebs.co.kr/fmradiofamilypc/familypc1m/playlist.m3u8',freq:'104.5 MHz',freqNum:104.5,logoText:'EBS',provider:'EBS'},
    {id:'gwangju-mbc-fm',name:'광주MBC FM',url:'https://media.kjmbc.co.kr/hls/fmlive/GWANGJU-MBC-FM/playlist.m3u8',freq:'93.9 MHz',freqNum:93.9,logoText:'MBC',provider:'MBC'},
    {id:'ytn-radio',name:'YTN 라디오',url:'https://radiolive.ytn.co.kr/radio/_definst_/20211118_fmlive/playlist.m3u8',freq:'94.5 MHz',freqNum:94.5,logoText:'YTN',provider:'YTN'},
    {id:'tbs-fm',name:'TBS FM',url:'https://cdnfm.tbs.seoul.kr/tbs/_definst_/tbs_fm_web_360.smil/playlist.m3u8',freq:'95.1 MHz',freqNum:95.1,logoText:'TBS',provider:'TBS'},
    {id:'febc',name:'극동방송',url:'http://mlive2.febc.net:1935/live/seoulfm/playlist.m3u8',freq:'106.9 MHz',freqNum:106.9,logoText:'극동',provider:'FEBC'},
    {id:'tbn',name:'TBN 교통방송',url:'http://radio2.tbn.or.kr:1935/gyeongin/myStream/playlist.m3u8',freq:'95.1 MHz',freqNum:95.1,logoText:'TBN 교통방송',provider:'TBN'},
    {id:'obs',name:'OBS 라디오',url:'https://vod3.obs.co.kr:444/live/obsstream1/radio.stream/playlist.m3u8',freq:'99.9 MHz',freqNum:99.9,logoText:'OBS',provider:'OBS'},
    {id:'tarot',name:'타로 점보기',url:'',freq:'타로',freqNum:0,logoText:'타로 점보기',provider:'CLARA',isTarot:true},
    {id:'fortune',name:'오늘의 운세',url:'',freq:'운세',freqNum:0,logoText:'오늘의 운세',provider:'CLARA',isFortune:true},
    {id:'empty-1',name:'',url:'',freq:'',freqNum:0,logoText:'',provider:'',isEmpty:true},
    {id:'empty-2',name:'',url:'',freq:'',freqNum:0,logoText:'',provider:'',isEmpty:true},
    {id:'empty-3',name:'',url:'',freq:'',freqNum:0,logoText:'',provider:'',isEmpty:true},
    {id:'empty-4',name:'',url:'',freq:'',freqNum:0,logoText:'',provider:'',isEmpty:true},
    {id:'empty-5',name:'',url:'',freq:'',freqNum:0,logoText:'',provider:'',isEmpty:true}
  ];

  // === Theme Names ===
  var THEME_NAMES = {
    wood: 'WOOD CLASSIC \u00b7 \ub098\ubb34\uacb0',
    cream: 'RETRO CREAM \u00b7 \uac00\uc8fd',
    black: 'MIDNIGHT BLACK \u00b7 \uce74\ubcf8\ud30c\uc774\ubc84',
    military: 'MILITARY \u00b7 \uce94\ubc84\uc2a4',
    silver: 'CHROME SILVER \u00b7 \ube0c\ub7ec\uc2dc\ub4dc\uba54\ud0c8',
    cyber: 'NEON CYBER \u00b7 \ud68c\ub85c\uae30\ud310',
    rose: 'ROSE GOLD \u00b7 \ub300\ub9ac\uc11d',
    maltese: 'MALTESE \u00b7 \ud138 \uacb0',
    skyblue: 'SKY BLUE NEON \u00b7 \ud558\ub298\uc0c9'
  };

  // === State ===
  var currentStation = null;
  var audio = null;
  var hlsInstance = null;
  var isPlaying = false;
  var isLoading = false;
  var volume = 0.8;
  var knobAngle = -135 + (0.8 * 270);
  var isPowered = false;
  var currentTheme = 'wood';

  // === Theme ===
  function toggleThemeDots() {
    var wrap = document.getElementById('themeDotsWrap');
    var btn = document.getElementById('themeToggleBtn');
    wrap.classList.toggle('hidden');
    var hidden = wrap.classList.contains('hidden');
    btn.textContent = hidden ? '▶' : '◀';
    btn.title = hidden ? '테마 보이기' : '테마 감추기';
  }
  function setTheme(name) {
    currentTheme = name;
    document.getElementById('radioBody').setAttribute('data-theme', name);
    document.body.setAttribute('data-theme', name);
    document.getElementById('themeName').textContent = THEME_NAMES[name] || name.toUpperCase();
    document.querySelectorAll('.theme-dot').forEach(function(d) {
      d.classList.toggle('active', d.getAttribute('data-t') === name);
    });
    try { localStorage.setItem('k-radio-theme', name); } catch(e) {}
    applyCreamGoldOverride();
  }
  function applyCreamGoldOverride() {
    // Anniversary section (cream-gold theme)
    var sec = document.querySelector('.anniversary-section');
    if (sec) {
      sec.style.cssText += 'background:linear-gradient(145deg,#FFF8E7,#F2E8D0)!important;border:1px solid rgba(139,105,20,0.15)!important;border-radius:14px;isolation:isolate;position:relative;z-index:2;box-shadow:0 8px 24px rgba(100,70,30,0.1),inset 0 1px 0 rgba(255,255,255,0.3)!important;';
    }
    var lbl = document.querySelector('.anniversary-label');
    if (lbl) lbl.style.cssText += 'color:#8B6914!important;';
    var pnl = document.querySelector('.anniversary-panel');
    if (pnl) pnl.style.cssText += 'background:rgba(255,255,255,0.4)!important;border:1px solid rgba(139,105,20,0.12)!important;box-shadow:none!important;';
    // Anniversary items
    document.querySelectorAll('.anniversary-item').forEach(function(el) {
      el.style.cssText += 'background:rgba(255,255,255,0.5)!important;border:1px solid rgba(139,105,20,0.1)!important;';
    });
    document.querySelectorAll('.anniv-name').forEach(function(el) { el.style.color = '#3a2a10'; });
    document.querySelectorAll('.anniv-date').forEach(function(el) { el.style.color = '#6a5530'; });
    document.querySelectorAll('.anniv-dday').forEach(function(el) { el.style.color = '#8B6914'; });
    // Anniversary inputs
    document.querySelectorAll('.anniversary-add-row input, .anniv-type-select, .anniv-date-field, .anniv-cal-select, .anniv-login-row input').forEach(function(el) {
      el.style.cssText += 'background:rgba(255,255,255,0.7)!important;border:1px solid rgba(139,105,20,0.2)!important;color:#3a2a10!important;';
    });
    document.querySelectorAll('.anniversary-add-row button, .anniv-login-row button, .anniv-user-row button').forEach(function(el) {
      el.style.cssText += 'background:linear-gradient(135deg,#C8A96E,#b89858)!important;border:none!important;color:#fff!important;';
    });
    var uname = document.querySelector('.anniv-user-name');
    if (uname) uname.style.cssText += 'color:#8B6914!important;';
    // Birthday info
    var bday = document.querySelector('.anniv-birthday-info');
    if (bday) bday.style.cssText += 'background:rgba(255,255,255,0.4)!important;border:1px solid rgba(139,105,20,0.1)!important;';
    document.querySelectorAll('.anniv-bday-date, .anniv-bday-lived').forEach(function(el) { el.style.color = '#3a2a10'; });
    document.querySelectorAll('.anniv-bday-dday').forEach(function(el) { el.style.color = '#8B6914'; });
    // Dashboard modal (cream-gold theme)
    var dm = document.querySelector('.dashboard-modal');
    if (dm) dm.style.cssText += 'background:linear-gradient(145deg,#FFF8E7,#F2E8D0)!important;border:1px solid rgba(139,105,20,0.2)!important;box-shadow:0 40px 80px rgba(100,70,30,0.15),0 0 40px rgba(200,169,110,0.15),inset 0 1px 0 rgba(255,255,255,0.3)!important;';
    var dh = document.querySelector('.dashboard-header');
    if (dh) dh.style.cssText += 'border-bottom:1px solid rgba(139,105,20,0.15)!important;';
    var dt = document.querySelector('.dashboard-title');
    if (dt) dt.style.cssText += 'color:#8B6914!important;';
    var dc = document.querySelector('.dashboard-close');
    if (dc) dc.style.cssText += 'color:#A08050!important;';
    var dui = document.querySelector('.dashboard-user-info');
    if (dui) dui.style.cssText += 'background:rgba(255,255,255,0.5)!important;border:1px solid rgba(139,105,20,0.12)!important;';
    var dun = document.querySelector('.dashboard-user-name');
    if (dun) dun.style.cssText += 'color:#3a2a10!important;';
    var due = document.querySelector('.dashboard-user-email');
    if (due) due.style.cssText += 'color:#6a5530!important;';
    document.querySelectorAll('.dashboard-section-title').forEach(function(el) { el.style.cssText += 'color:#8B6914!important;'; });
    document.querySelectorAll('.dashboard-usage-item').forEach(function(el) {
      el.style.cssText += 'background:rgba(255,255,255,0.4)!important;border:1px solid rgba(139,105,20,0.1)!important;';
    });
    document.querySelectorAll('.usage-no').forEach(function(el) { el.style.cssText += 'color:#C8A96E!important;'; });
    document.querySelectorAll('.usage-name').forEach(function(el) { el.style.cssText += 'color:#3a2a10!important;'; });
    document.querySelectorAll('.usage-count, .usage-received').forEach(function(el) { el.style.cssText += 'color:#8B6914!important;'; });
    document.querySelectorAll('.dashboard-anniv-item').forEach(function(el) {
      el.style.cssText += 'background:rgba(255,255,255,0.4)!important;border:1px solid rgba(139,105,20,0.12)!important;';
    });
    document.querySelectorAll('.dash-name').forEach(function(el) { el.style.cssText += 'color:#3a2a10!important;'; });
    document.querySelectorAll('.dash-date').forEach(function(el) { el.style.cssText += 'color:#6a5530!important;'; });
    document.querySelectorAll('.dash-dday').forEach(function(el) { el.style.cssText += 'color:#8B6914!important;'; });
    document.querySelectorAll('.dashboard-add-row input, .dash-type-select, .dash-date-field, .dash-cal-select').forEach(function(el) {
      el.style.cssText += 'background:rgba(255,255,255,0.7)!important;border:1px solid rgba(139,105,20,0.2)!important;color:#3a2a10!important;';
    });
    document.querySelectorAll('.dashboard-add-row button').forEach(function(el) {
      el.style.cssText += 'background:linear-gradient(135deg,#C8A96E,#b89858)!important;border:none!important;color:#fff!important;';
    });
    document.querySelectorAll('.dashboard-usage-header').forEach(function(el) { el.style.cssText += 'color:#8B6914!important;'; });
  }

  // === Init ===
  async function init() {
    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY, {
      global: { fetch: function(url, opts) { opts = opts || {}; opts.cache = 'no-store'; return fetch(url, opts); } }
    });
    // Restore saved theme (default: purple)
    setTheme('purple');
    try {
      var saved = localStorage.getItem('k-radio-theme');
      if (saved && THEME_NAMES[saved]) setTheme(saved);
    } catch(e) {}

    // 클라우드에서 방송국 데이터 로드 시도
    try {
      var r = await supabase.storage.from(BUCKET_NAME).download('_system/stations.json');
      if (r.data) {
        var text = await r.data.text();
        var cloudStations = JSON.parse(text);
        if (cloudStations && cloudStations.length > 0) {
          STATIONS = cloudStations;
        }
      }
    } catch(e) { /* 기본 하드코딩 방송국 사용 */ }

    renderPresets();
    renderEqualizer();
    renderKnobMarks();
    renderFreqTicks();
    updateKnobVisual();
    setupKnobDrag();
    updateClock();
    setInterval(updateClock, 1000);
    loadSavedPhotos();
    loadAnniversaries();

    // Anniversary login removed - auto-login via main user
  }

  // === Render ===
  function renderPresets() {
    var c = document.getElementById('presetButtons');
    c.innerHTML = STATIONS.map(function(s,i) {
      var cat = s.isTarot || s.isFortune ? ' preset-special' : s.flag ? ' preset-foreign' : '';
      var cls = 'preset-btn' + cat + (s.empty || s.isEmpty ? ' preset-empty' : '');
      var nameHtml;
      if(s.empty || s.isEmpty) nameHtml='';
      else if(s.isTarot) nameHtml='<span class="preset-tarot-cards">🂠🂠🂠</span>';
      else if(s.isFortune) nameHtml='<span class="preset-lucky7">7</span>';
      else if(s.flag) nameHtml='<img src="https://flagcdn.com/24x18/'+s.flag+'.png" alt="'+s.flag+'" style="height:13px;vertical-align:middle;">';
      else nameHtml=s.name.replace(/\s+/g,' ').split(' ')[0];
      if(s.isEmpty) return '<button class="'+cls+'" disabled style="cursor:default;opacity:0.3;">' +
        '<span class="preset-num"></span><span class="preset-name"></span></button>';
      return '<button class="'+cls+'" data-id="'+s.id+'" onclick="selectStation(\''+s.id+'\')">' +
        '<span class="preset-num">'+s.logoText+'</span>' +
        '<span class="preset-name">'+nameHtml+'</span></button>';
    }).join('');
  }
  function renderEqualizer() {
    var h=''; for(var i=0;i<16;i++) h+='<div class="eq-bar"></div>';
    document.getElementById('equalizer').innerHTML=h;
  }
  function renderKnobMarks() {
    var h=''; for(var i=0;i<11;i++){var a=-135+(i*27);
    h+='<div class="knob-tick" style="transform:rotate('+a+'deg)"></div>';}
    document.getElementById('knobMarks').innerHTML=h;
  }

  // === Freq Ticks ===
  function renderFreqTicks(){
    var el=document.getElementById('freqTicks');if(!el)return;
    var h='';
    for(var f=88;f<=108;f+=0.5){
      var pct=((f-88)/20)*90+5;
      var cls=f%2===0?'freq-tick major':'freq-tick minor';
      h+='<div class="'+cls+'" style="left:'+pct+'%"></div>';
    }
    el.innerHTML=h;
  }

  // === Lunar Calendar ===
  var LUNAR_DATA = [
    0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,
    0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,
    0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970,
    0x06566,0x0d4a0,0x0ea50,0x16a95,0x05ad0,0x02b60,0x186e3,0x092e0,0x1c8d7,0x0c950,
    0x0d4a0,0x1d8a6,0x0b550,0x056a0,0x1a5b4,0x025d0,0x092d0,0x0d2b2,0x0a950,0x0b557,
    0x06ca0,0x0b550,0x15355,0x04da0,0x0a5b0,0x14573,0x052b0,0x0a9a8,0x0e950,0x06aa0,
    0x0aea6,0x0ab50,0x04b60,0x0aae4,0x0a570,0x05260,0x0f263,0x0d950,0x05b57,0x056a0,
    0x096d0,0x04dd5,0x04ad0,0x0a4d0,0x0d4d4,0x0d250,0x0d558,0x0b540,0x0b6a0,0x195a6,
    0x095b0,0x049b0,0x0a974,0x0a4b0,0x0b27a,0x06a50,0x06d40,0x0af46,0x0ab60,0x09570,
    0x04af5,0x04970,0x064b0,0x074a3,0x0ea50,0x06b58,0x05ac0,0x0ab60,0x096d5,0x092e0,
    0x0c960,0x0d954,0x0d4a0,0x0da50,0x07552,0x056a0,0x0abb7,0x025d0,0x092d0,0x0cab5,
    0x0a950,0x0b4a0,0x0baa4,0x0ad50,0x055d9,0x04ba0,0x0a5b0,0x15176,0x052b0,0x0a930,
    0x07954,0x06aa0,0x0ad50,0x05b52,0x04b60,0x0a6e6,0x0a4e0,0x0d260,0x0ea65,0x0d530,
    0x05aa0,0x076a3,0x096d0,0x04afb,0x04ad0,0x0a4d0,0x1d0b6,0x0d250,0x0d520,0x0dd45,
    0x0b5a0,0x056d0,0x055b2,0x049b0,0x0a577,0x0a4b0,0x0aa50,0x1b255,0x06d20,0x0ada0,
    0x14b63,0x09370,0x049f8,0x04970,0x064b0,0x168a6,0x0ea50,0x06aa0,0x1a6c4,0x0aae0,
    0x092e0,0x0d2e3,0x0c960,0x0d557,0x0d4a0,0x0da50,0x05d55,0x056a0,0x0a6d0,0x055d4,
    0x052d0,0x0a9b8,0x0a950,0x0b4a0,0x0b6a6,0x0ad50,0x055a0,0x0aba4,0x0a5b0,0x052b0,
    0x0b273,0x06930,0x07337,0x06aa0,0x0ad50,0x14b55,0x04b60,0x0a570,0x054e4,0x0d160,
    0x0e968,0x0d520,0x0daa0,0x16aa6,0x056d0,0x04ae0,0x0a9d4,0x0a4d0,0x0d150,0x0f252,
    0x0d520
  ];
  var LUNAR_START_YEAR = 1900;
  function lunarYearDays(y) {
    var i, sum = 348;
    for (i = 0x8000; i > 0x8; i >>= 1) sum += (LUNAR_DATA[y - LUNAR_START_YEAR] & i) ? 1 : 0;
    return sum + leapDaysInLunarYear(y);
  }
  function leapMonthInLunarYear(y) { return LUNAR_DATA[y - LUNAR_START_YEAR] & 0xf; }
  function leapDaysInLunarYear(y) { return leapMonthInLunarYear(y) ? ((LUNAR_DATA[y - LUNAR_START_YEAR] & 0x10000) ? 30 : 29) : 0; }
  function lunarMonthDays(y, m) { return (LUNAR_DATA[y - LUNAR_START_YEAR] & (0x10000 >> m)) ? 30 : 29; }
  function solarToLunar(year, month, day) {
    var baseDate = new Date(1900, 0, 31);
    var targetDate = new Date(year, month - 1, day);
    var offset = Math.floor((targetDate - baseDate) / 86400000);
    var i, leap, temp, isLeap = false, lunarYear, lunarMonth, lunarDay;
    for (i = LUNAR_START_YEAR; i < 2101 && offset > 0; i++) {
      temp = lunarYearDays(i);
      offset -= temp;
    }
    if (offset < 0) { offset += temp; i--; }
    lunarYear = i;
    leap = leapMonthInLunarYear(lunarYear);
    isLeap = false;
    for (i = 1; i < 13 && offset > 0; i++) {
      if (leap > 0 && i === (leap + 1) && !isLeap) {
        --i; isLeap = true;
        temp = leapDaysInLunarYear(lunarYear);
      } else { temp = lunarMonthDays(lunarYear, i); }
      if (isLeap && i === (leap + 1)) isLeap = false;
      offset -= temp;
    }
    if (offset === 0 && leap > 0 && i === leap + 1) {
      if (isLeap) { isLeap = false; } else { isLeap = true; --i; }
    }
    if (offset < 0) { offset += temp; --i; }
    lunarMonth = i;
    lunarDay = offset + 1;
    return { year: lunarYear, month: lunarMonth, day: lunarDay, isLeap: isLeap };
  }

  // === Clock ===
  var cachedLunarDate = '';
  var cachedLunarDay = -1;

  function updateClock(){
    var now=new Date();
    var h=String(now.getHours()).padStart(2,'0');
    var m=String(now.getMinutes()).padStart(2,'0');
    var s=String(now.getSeconds()).padStart(2,'0');
    var timeStr=h+':'+m+':'+s;
    var el=document.getElementById('lcdClock');
    if(el) el.textContent=timeStr;
    var dateStr=now.getFullYear()+'년 '+(now.getMonth()+1)+'월 '+now.getDate()+'일';
    var dateEl=document.getElementById('lcdDate');
    if(dateEl) dateEl.textContent=dateStr;
    var today=now.getDate();
    if(cachedLunarDay!==today){
      cachedLunarDay=today;
      try{
        var l=solarToLunar(now.getFullYear(),now.getMonth()+1,now.getDate());
        cachedLunarDate='(음력 '+(l.isLeap?'윤':'')+l.month+'월 '+l.day+'일)';
      }catch(e){cachedLunarDate='';}
    }
    var lunarEl=document.getElementById('lcdLunar');
    if(lunarEl) lunarEl.textContent=cachedLunarDate;
  }

  // === Power ===
  document.getElementById('powerBtn').addEventListener('click',function(){
    isPowered=!isPowered;
    document.getElementById('powerBtn').classList.toggle('on',isPowered);
    if(!isPowered&&audio){
      audio.pause(); setPlayState(false); currentStation=null;
      document.getElementById('lcdIdle').classList.remove('hidden');
      document.getElementById('lcdActive').classList.remove('visible');
      document.getElementById('antenna').classList.remove('active');
      document.querySelectorAll('.preset-btn').forEach(function(b){b.classList.remove('active');});
      updateSignalBars(false);
    }
  });

  // === Select Station ===
  // === Fortune Engine ===
  var ZODIAC_ANIMALS = ['원숭이','닭','개','돼지','쥐','소','호랑이','토끼','용','뱀','말','양'];
  var ZODIAC_EMOJIS = ['🐵','🐔','🐶','🐷','🐭','🐮','🐯','🐰','🐲','🐍','🐴','🐑'];
  var CONSTELLATIONS_DATA = [
    {name:'염소자리',symbol:'♑',s:[12,22],e:[1,19]},
    {name:'물병자리',symbol:'♒',s:[1,20],e:[2,18]},
    {name:'물고기자리',symbol:'♓',s:[2,19],e:[3,20]},
    {name:'양자리',symbol:'♈',s:[3,21],e:[4,19]},
    {name:'황소자리',symbol:'♉',s:[4,20],e:[5,20]},
    {name:'쌍둥이자리',symbol:'♊',s:[5,21],e:[6,21]},
    {name:'게자리',symbol:'♋',s:[6,22],e:[7,22]},
    {name:'사자자리',symbol:'♌',s:[7,23],e:[8,22]},
    {name:'처녀자리',symbol:'♍',s:[8,23],e:[9,22]},
    {name:'천칭자리',symbol:'♎',s:[9,23],e:[10,23]},
    {name:'전갈자리',symbol:'♏',s:[10,24],e:[11,22]},
    {name:'사수자리',symbol:'♐',s:[11,23],e:[12,21]}
  ];
  var FORTUNE_OVERALL = [
    '오늘은 새로운 시작을 위한 좋은 날입니다. 그동안 망설여왔던 일이 있다면 지금이 바로 첫 발을 내딛을 때입니다. 우주의 에너지가 당신의 새로운 도전을 응원하고 있으며, 용기를 내는 만큼 좋은 결과가 따라올 것입니다.',
    '주변 사람들과의 소통이 행운을 가져다줄 것입니다. 오늘은 특히 진심 어린 대화가 예상치 못한 기회를 열어줄 수 있습니다. 마음을 열고 다가가면 뜻밖의 도움과 따뜻한 인연을 만나게 될 것입니다.',
    '오래 미뤄왔던 일을 처리하기에 좋은 날입니다. 작은 일부터 하나씩 정리해 나가면 마음도 가벼워지고, 그 성취감이 더 큰 일을 해낼 수 있는 동력이 될 것입니다. 오늘 시작하면 놀라울 정도로 순조롭게 풀릴 것입니다.',
    '작은 변화가 큰 행운으로 이어질 수 있습니다. 매일 같은 길을 걷고 같은 일을 반복하고 있다면, 오늘은 일상의 루틴을 조금 바꿔보세요. 그 작은 변화 속에서 새로운 영감과 기회를 발견하게 될 것입니다.',
    '직감이 예리해지는 날입니다. 논리적으로는 설명하기 어렵지만 마음 깊은 곳에서 올라오는 느낌이 있다면, 그것을 믿어도 좋습니다. 중요한 결정은 첫 느낌을 따르는 것이 오늘은 가장 현명한 선택입니다.',
    '과거의 노력이 결실을 맺기 시작하는 시기입니다. 묵묵히 쌓아온 당신의 성실함이 드디어 보상을 받는 때가 왔습니다. 인내하며 기다려온 시간이 헛되지 않았음을 곧 느끼게 될 것입니다.',
    '예상치 못한 기회가 찾아올 수 있습니다. 계획에 없던 일이 갑자기 생기더라도 당황하지 마세요. 그것이 오히려 당신에게 가장 필요한 기회일 수 있습니다. 열린 마음으로 받아들이면 좋은 결과가 따릅니다.',
    '오늘은 자신을 돌아보는 시간이 필요합니다. 바쁜 일상에서 잠시 멈추고 내면의 소리에 귀 기울여 보세요. 조용한 성찰의 시간이 앞으로의 방향을 더욱 명확하게 해줄 것입니다.',
    '긍정적인 에너지가 가득한 날입니다. 당신이 품고 있는 밝은 기운이 주변 사람들에게도 전해져 함께하는 모든 이들을 행복하게 만들 수 있습니다. 좋은 영향을 나누면 그 에너지가 배로 돌아올 것입니다.',
    '새로운 사람과의 만남이 특별한 인연으로 이어질 수 있습니다. 오늘 우연히 마주치는 사람, 처음 나누는 대화 속에서 당신의 삶에 중요한 의미를 가질 인연을 발견하게 될지도 모릅니다.',
    '창의적인 아이디어가 떠오르는 날입니다. 번뜩이는 영감이 찾아올 때 놓치지 말고 바로 기록해 두세요. 지금은 사소해 보이는 아이디어가 나중에 큰 가치를 발휘하게 될 것입니다.',
    '꾸준함이 빛을 발하는 시기입니다. 눈에 보이는 성과가 없어도 당신의 노력은 보이지 않는 곳에서 단단한 뿌리를 내리고 있습니다. 포기하지 말고 계속 나아가면 곧 아름다운 꽃이 필 것입니다.',
    '오늘은 감사하는 마음이 더 큰 행복을 가져다줍니다. 당연하게 여겼던 일상의 작은 것들에 감사의 눈길을 보내보세요. 감사의 에너지는 더 많은 축복을 끌어당기는 강력한 힘을 가지고 있습니다.',
    '자신감을 가지세요. 당신의 능력은 생각보다 훨씬 큽니다. 스스로를 과소평가하지 말고 당당하게 자신의 가치를 드러내 보세요. 오늘은 당신의 빛이 특히 밝게 빛나는 날입니다.',
    '조급함을 내려놓으면 더 좋은 결과를 얻을 수 있습니다. 빨리 가려고 서두르면 오히려 중요한 것을 놓칠 수 있습니다. 여유를 가지고 한 걸음씩 나아가면 더 확실하고 만족스러운 결과에 도달하게 됩니다.',
    '오늘 만나는 사람 중 중요한 조언을 해줄 귀인이 있습니다. 평소와 다를 것 없는 대화 속에서도 귀를 기울여 보세요. 누군가의 한마디가 당신의 고민을 해결하는 열쇠가 될 수 있습니다.',
    '작은 친절이 큰 행운으로 돌아오는 날입니다. 누군가에게 건네는 따뜻한 미소, 작은 도움의 손길이 예상치 못한 형태로 당신에게 돌아올 것입니다. 베풀 수 있을 때 아낌없이 베푸세요.',
    '오래된 습관을 바꾸기 좋은 날입니다. 편안하지만 성장을 방해하는 익숙한 패턴에서 벗어나 새로운 도전을 시작해 보세요. 변화의 첫걸음이 당신을 전혀 다른 세계로 안내할 것입니다.',
    '마음의 여유가 좋은 판단력으로 이어집니다. 급한 불을 끄듯 서두르기보다 한 발 물러나 전체 그림을 바라보세요. 여유로운 시선으로 보면 복잡해 보였던 문제의 해답이 의외로 쉽게 보일 것입니다.',
    '오늘은 배움의 기회가 많습니다. 주변의 모든 것이 당신에게 무언가를 가르쳐주려 하고 있습니다. 호기심을 가지고 새로운 것을 탐구하면, 그 배움이 미래에 소중한 자산이 될 것입니다.'
  ];
  var FORTUNE_WEALTH = [
    '예상치 못한 곳에서 재물이 들어올 수 있습니다. 평소 관심을 두지 않았던 방향에서 뜻밖의 수입이 생길 수 있으니, 주변의 작은 기회도 놓치지 않도록 눈과 귀를 활짝 열어두세요.',
    '불필요한 지출을 줄이면 좋은 결과가 있을 것입니다. 오늘 하루 지갑을 열기 전에 정말 필요한 것인지 한 번 더 생각해 보세요. 작은 절약이 모여 나중에 큰 여유가 될 것입니다.',
    '투자보다는 저축에 집중하는 것이 현명한 날입니다. 공격적인 재테크보다 안전한 곳에 자금을 모아두는 것이 장기적으로 더 큰 안정을 가져다줄 시기입니다. 차분하게 기반을 다지세요.',
    '금전적인 행운이 따르는 날입니다. 재물의 에너지가 당신 쪽으로 흐르고 있으니, 적극적으로 움직여 보세요. 평소 관심 있던 분야에서 수익의 기회를 찾을 수 있을 것입니다.',
    '오늘은 큰 소비를 자제하고 소소한 행복에 집중하세요. 비싼 것이 반드시 좋은 것은 아니며, 작은 것에서 느끼는 만족감이 오히려 더 크고 오래 지속될 것입니다.',
    '주변의 재정 조언에 귀를 기울이면 도움이 됩니다. 돈에 관한 경험이 풍부한 사람의 이야기 속에서 당신에게 꼭 필요한 지혜를 발견할 수 있습니다. 겸손한 자세로 배움을 구하세요.',
    '오랫동안 기다리던 금전적 소식이 도착할 수 있습니다. 밀린 정산이나 기대했던 수입이 마침내 현실이 되는 날이 다가오고 있습니다. 조금만 더 인내하며 기다려 보세요.',
    '새로운 수입원을 탐색하기 좋은 날입니다. 하나의 수입에만 의존하기보다 다양한 가능성을 열어두는 것이 재정적 안정의 열쇠입니다. 관심 있는 분야를 적극적으로 알아보세요.',
    '계획적인 소비가 장기적으로 큰 도움이 되는 시기입니다. 즉흥적인 구매를 줄이고 월간 예산을 세워보세요. 체계적인 관리가 미래의 재정적 자유를 앞당겨줄 것입니다.',
    '작은 투자가 큰 수익으로 이어질 수 있습니다. 다만 성급하게 뛰어들기보다 충분한 정보를 모으고 신중하게 판단하세요. 준비된 투자만이 진정한 결실을 맺을 수 있습니다.',
    '지갑을 열기 전에 한 번 더 생각하면 후회가 없을 것입니다. 충동적인 소비가 나중에 아쉬움으로 남을 수 있는 날입니다. 잠시 멈추고 생각하는 습관이 당신의 재정을 지켜줄 것입니다.',
    '재물운이 상승하는 시기입니다. 이 좋은 에너지를 눈앞의 소비가 아닌 자신의 가치를 높이는 데 투자하세요. 스스로에게 투자한 것은 몇 배의 수익으로 돌아올 것입니다.',
    '오늘은 나눔이 더 큰 재물을 가져다주는 날입니다. 어려운 이웃을 돕거나 주변에 작은 선물을 건네보세요. 베풀수록 더 풍요로워지는 우주의 법칙이 당신에게 작용하고 있습니다.',
    '금전 관련 서류를 꼼꼼히 확인하면 이득이 있을 것입니다. 영수증, 계약서, 청구서 등을 세심하게 살펴보면 미처 몰랐던 절약 포인트나 환급 기회를 발견할 수 있습니다.',
    '안정적인 재정 관리가 마음의 평화로 이어집니다. 돈에 대한 걱정을 줄이는 가장 좋은 방법은 꾸준하고 체계적인 관리입니다. 오늘부터 차근차근 정리해 나가면 마음이 한결 가벼워질 것입니다.',
    '사업 아이디어가 떠오르면 메모해 두세요. 지금 당장은 실현 가능성이 낮아 보일 수 있지만, 미래에 상황이 바뀌면 그 아이디어가 큰 기회가 될 수 있습니다. 영감을 기록하는 습관이 부를 만듭니다.',
    '절약과 검소함이 미래의 풍요로움을 만들어 냅니다. 화려한 소비보다 알뜰한 살림이 결국 더 큰 자산을 만듭니다. 오늘의 작은 절제가 내일의 큰 여유로 돌아올 것입니다.',
    '예기치 않은 경비가 발생할 수 있으니 여유 자금을 확보해 두세요. 갑작스러운 지출에 당황하지 않도록 비상금을 마련해두는 것이 현명합니다. 준비된 사람에게는 위기도 기회가 됩니다.',
    '금전적 결정은 감정보다 이성으로 내리는 것이 좋습니다. 흥분이나 두려움에 이끌려 판단하면 후회할 수 있습니다. 냉정하게 숫자를 따져보고 논리적으로 결정하면 최선의 결과를 얻게 됩니다.',
    '꾸준한 노력이 경제적 안정을 가져다줄 것입니다. 하루아침에 부자가 되는 것보다 매일 조금씩 쌓아가는 것이 더 확실한 길입니다. 당신의 성실한 노력은 반드시 안정적인 재정으로 보답할 것입니다.'
  ];
  var FORTUNE_LOVE = [
    '사랑하는 사람에게 진심을 표현하기 좋은 날입니다. 평소 말로 하지 못했던 감사와 애정의 마음을 오늘은 용기를 내어 전해보세요. 당신의 진심 어린 한마디가 관계를 더욱 따뜻하게 만들 것입니다.',
    '작은 관심과 배려가 관계를 더욱 깊게 만들어 줍니다. 거창한 이벤트가 아니라 소소한 안부 문자, 따뜻한 커피 한 잔이 상대방의 마음을 녹일 수 있습니다. 작은 것에서 시작하는 사랑이 가장 오래갑니다.',
    '오해가 있다면 오늘 풀어보세요. 시간이 지날수록 오해는 더 깊어지기만 합니다. 용기를 내어 솔직한 대화를 나누면 생각보다 쉽게 풀릴 수 있습니다. 대화가 해결의 열쇠입니다.',
    '새로운 인연을 만날 수 있는 기회가 있습니다. 집에만 있지 말고 밖으로 나가보세요. 카페에서, 서점에서, 혹은 산책길에서 운명적인 만남이 기다리고 있을지도 모릅니다.',
    '상대방의 입장에서 생각하면 더 좋은 관계를 만들 수 있습니다. 내 기준으로만 판단하지 말고 상대의 마음과 상황을 헤아려 보세요. 공감의 힘이 관계를 한 단계 더 성장시킬 것입니다.',
    '오늘은 혼자만의 시간이 오히려 관계에 도움이 됩니다. 서로에게 적당한 거리를 두는 것도 건강한 관계의 비결입니다. 자신을 충전하는 시간이 다시 만날 때 더 풍성한 대화를 만들어줍니다.',
    '감사의 마음을 표현하면 사랑이 더 깊어지는 날입니다. 당연하다고 느끼는 상대의 존재와 노력에 "고마워"라는 한마디를 건네보세요. 그 따뜻한 말이 관계에 새로운 생기를 불어넣을 것입니다.',
    '과거의 상처를 내려놓으면 새로운 사랑이 찾아옵니다. 지난 아픔에 마음의 문을 닫고 있다면, 이제는 용기를 내어 조금씩 열어보세요. 과거를 놓아줄 때 비로소 현재의 행복을 받아들일 수 있습니다.',
    '소중한 사람과 특별한 추억을 만들기 좋은 날입니다. 함께 맛있는 음식을 먹거나, 영화를 보거나, 단순히 산책을 하는 것만으로도 오래도록 기억될 아름다운 순간이 만들어질 것입니다.',
    '진정한 소통은 말이 아닌 마음으로 하는 것입니다. 화려한 말보다 진심을 담은 눈빛, 따뜻한 손길이 더 깊은 교감을 만듭니다. 오늘은 말보다 마음으로 상대에게 다가가 보세요.',
    '오랜 친구에게 연락하면 좋은 소식을 들을 수 있습니다. 바쁜 일상에 묻혀 연락하지 못했던 소중한 사람이 있다면 오늘 안부를 건네보세요. 반가운 재회가 당신의 하루를 환하게 밝혀줄 것입니다.',
    '사랑은 완벽함이 아닌 있는 그대로를 받아들이는 것입니다. 상대방의 부족한 점을 바꾸려 하기보다 그 모습 그대로를 존중해 보세요. 진정한 사랑은 조건 없이 받아들이는 데서 시작됩니다.',
    '오늘은 상대의 장점에 집중하면 행복해지는 날입니다. 사람은 누구나 장단점이 있지만, 좋은 점에 눈을 돌리면 관계가 훨씬 풍요로워집니다. 상대의 빛나는 면을 찾아 칭찬해 주세요.',
    '가족과의 시간이 마음의 안정을 가져다줍니다. 세상의 어떤 관계보다 든든한 가족의 품 안에서 오늘 하루 편안하게 쉬어보세요. 함께하는 평범한 일상이 가장 큰 행복임을 느끼게 될 것입니다.',
    '인연은 때가 되면 자연스럽게 찾아옵니다. 억지로 만들려 하거나 조급해하지 마세요. 자신을 가꾸고 성장하는 데 집중하다 보면 가장 아름다운 인연이 가장 완벽한 타이밍에 나타날 것입니다.',
    '따뜻한 한마디가 관계의 온도를 높이는 날입니다. "수고했어", "잘하고 있어", "네 곁에 있어서 좋아"처럼 진심 담긴 말 한마디가 상대의 마음에 깊이 닿을 것입니다.',
    '서로의 다름을 존중하면 더 강한 유대감이 생깁니다. 같아야만 잘 맞는 것이 아니라, 다르기에 서로를 보완할 수 있습니다. 차이를 갈등이 아닌 풍요로움으로 바라보는 시각이 관계를 더 깊게 만듭니다.',
    '오늘은 사랑보다 우정에서 더 큰 힘을 얻을 수 있습니다. 오래된 친구와의 편안한 대화, 함께 웃고 추억을 나누는 시간이 당신의 마음을 따뜻하게 채워줄 것입니다.',
    '진심 어린 미소가 최고의 사랑 표현입니다. 말이 필요 없이 눈을 맞추며 짓는 따뜻한 미소 한 번이 천 마디 말보다 더 깊은 사랑을 전할 수 있습니다. 오늘 하루 많이 웃어보세요.',
    '관계에서 여유를 가지면 더 좋은 방향으로 흘러갑니다. 모든 것을 통제하려 하기보다 물 흐르듯 자연스럽게 두면 관계는 스스로 가장 아름다운 형태를 찾아갑니다. 믿음을 가지고 기다려 보세요.'
  ];
  var FORTUNE_HEALTH = [
    '가벼운 운동이 몸과 마음 모두에 활력을 줄 것입니다. 격렬한 운동보다 산책, 스트레칭 같은 부드러운 움직임이 오늘의 컨디션을 최상으로 만들어줄 것입니다. 몸을 움직이면 마음까지 가벼워지는 것을 느끼게 됩니다.',
    '충분한 수분 섭취가 오늘의 건강 비결입니다. 바쁜 일상 속에서 물 마시는 것을 잊기 쉽지만, 오늘은 의식적으로 물을 자주 마셔보세요. 맑은 물 한 잔이 당신의 몸과 마음을 깨끗하게 정화해줄 것입니다.',
    '스트레스 관리에 신경 쓰면 좋은 날입니다. 쌓여있는 긴장감을 풀어주는 시간이 필요합니다. 깊은 호흡을 천천히 반복하면서 마음의 짐을 하나씩 내려놓아 보세요. 마음이 편안해지면 몸도 따라 편안해집니다.',
    '규칙적인 식사가 오늘의 에너지를 지켜줍니다. 끼니를 거르거나 불규칙하게 먹으면 몸의 리듬이 깨지기 쉽습니다. 세 끼를 정해진 시간에 챙겨 먹으면 하루 종일 안정적인 에너지를 유지할 수 있습니다.',
    '과로를 피하고 적절한 휴식을 취하는 것이 중요합니다. 열심히 일하는 것도 좋지만 쉬어야 할 때 쉬는 것이 진정한 지혜입니다. 몸이 보내는 피로 신호를 무시하지 말고 충분히 회복하는 시간을 가지세요.',
    '산책이나 자연과의 접촉이 치유의 효과를 줍니다. 숲길을 걷거나 공원 벤치에 앉아 바람을 느끼는 것만으로도 놀라운 힐링 효과를 경험할 수 있습니다. 자연은 가장 오래되고 가장 효과적인 치유사입니다.',
    '오늘은 충분한 수면이 내일의 활력을 만들어 줍니다. 잠을 아껴가며 무언가를 하기보다, 오늘만큼은 일찍 잠자리에 들어 몸과 마음을 푹 쉬게 해주세요. 충분히 잔 내일 아침, 새 사람이 된 것 같은 상쾌함을 느낄 것입니다.',
    '명상이나 요가 같은 정적인 활동이 도움이 되는 날입니다. 고요히 눈을 감고 호흡에 집중하는 짧은 시간이 하루의 피로를 녹여줄 것입니다. 마음의 평화가 신체의 건강으로 이어지는 것을 경험하게 됩니다.',
    '좋은 음식이 좋은 기운을 가져다줍니다. 오늘은 영양 균형 잡힌 건강한 식사를 챙겨보세요. 신선한 재료로 만든 따뜻한 한 끼가 당신의 몸에 생기를 불어넣고 면역력을 높여줄 것입니다.',
    '스트레칭으로 하루를 시작하면 에너지가 넘치는 하루가 됩니다. 아침에 일어나 5분만 몸을 부드럽게 풀어주세요. 굳어있던 근육이 이완되면서 혈액 순환이 좋아지고 하루를 활기차게 보낼 수 있습니다.',
    '마음의 건강도 신체 건강만큼 중요합니다. 오늘은 자신의 감정을 살피고, 스스로를 따뜻하게 돌봐주는 시간을 가져보세요. 자기 자신에게 친절한 것이 건강의 시작이며, 내면이 건강해야 외면도 빛납니다.',
    '오늘은 따뜻한 차 한 잔이 최고의 보약입니다. 허브차, 생강차, 녹차 등 몸을 따뜻하게 해주는 차를 천천히 음미하며 마시면 마음까지 편안해지는 것을 느끼게 될 것입니다.',
    '무리한 운동보다 꾸준한 걷기가 더 효과적인 날입니다. 가까운 거리는 차 대신 걸어보세요. 걸으면서 주변 풍경을 감상하고 신선한 공기를 마시면 몸도 마음도 한결 가벼워질 것입니다.',
    '좋은 자세를 유지하면 몸의 피로가 줄어듭니다. 구부정한 자세는 근육 통증과 피로의 원인이 됩니다. 의식적으로 등을 펴고 바른 자세를 유지하면 놀랍도록 컨디션이 개선되는 것을 느낄 수 있습니다.',
    '웃음이 최고의 명약입니다. 오늘 하루 소리 내어 크게 웃어보세요. 웃을 때 분비되는 행복 호르몬이 면역력을 높이고 스트레스를 해소해줍니다. 재미있는 영상을 보거나 유쾌한 친구를 만나보세요.',
    '비타민이 풍부한 과일을 섭취하면 면역력이 올라갑니다. 제철 과일을 챙겨 먹으면 자연이 주는 최고의 영양소를 섭취할 수 있습니다. 달콤하고 상큼한 과일 한 조각이 당신의 건강을 지켜줄 것입니다.',
    '디지털 기기에서 눈을 쉬게 하는 시간이 필요합니다. 한 시간에 한 번씩 화면에서 눈을 떼고 먼 곳을 바라보세요. 잠깐의 휴식이 눈의 피로를 풀어주고 두통을 예방하는 데 큰 도움이 됩니다.',
    '오늘은 일찍 자고 일찍 일어나는 것이 건강의 비결입니다. 생체 리듬에 맞춘 수면 패턴이 몸의 자연 치유력을 극대화해줍니다. 오늘 밤 평소보다 30분만 일찍 잠자리에 들어보세요.',
    '맑은 공기를 마시며 바깥 활동을 하면 기분이 좋아집니다. 실내에만 있으면 몸과 마음이 답답해지기 쉽습니다. 잠깐이라도 밖에 나가 하늘을 올려다보고 신선한 공기를 깊이 들이마셔 보세요.',
    '건강한 습관 하나를 오늘부터 시작해 보세요. 작은 습관의 변화가 큰 건강의 차이를 만듭니다. 계단 오르기, 물 마시기, 자세 바로잡기 등 어렵지 않은 것부터 시작하면 미래의 자신에게 가장 소중한 선물이 됩니다.'
  ];
  var LUCKY_COLORS = [
    {name:'빨강',hex:'#e74c3c'},{name:'파랑',hex:'#3498db'},{name:'초록',hex:'#2ecc71'},
    {name:'노랑',hex:'#f1c40f'},{name:'보라',hex:'#9b59b6'},{name:'분홍',hex:'#e91e8a'},
    {name:'주황',hex:'#e67e22'},{name:'하늘',hex:'#87ceeb'},{name:'금색',hex:'#d4af69'},
    {name:'은색',hex:'#bdc3c7'},{name:'연두',hex:'#a8e06c'},{name:'남색',hex:'#2c3e80'}
  ];

  function getZodiacAnimal(year){ var idx=year%12; return {name:ZODIAC_ANIMALS[idx],emoji:ZODIAC_EMOJIS[idx],idx:idx}; }

  function getConstellationInfo(month,day){
    for(var i=0;i<CONSTELLATIONS_DATA.length;i++){
      var c=CONSTELLATIONS_DATA[i],sm=c.s[0],sd=c.s[1],em=c.e[0],ed=c.e[1];
      if(sm>em){if((month===sm&&day>=sd)||(month===em&&day<=ed)||month>sm||month<em)return{name:c.name,symbol:c.symbol,idx:i};}
      else{if((month===sm&&day>=sd)||(month===em&&day<=ed)||(month>sm&&month<em))return{name:c.name,symbol:c.symbol,idx:i};}
    }
    return{name:CONSTELLATIONS_DATA[0].name,symbol:CONSTELLATIONS_DATA[0].symbol,idx:0};
  }

  function fortuneSeededRandom(seed){var s=seed;return function(){s=(s*9301+49297)%233280;return s/233280;};}

  function lunarToSolar(ly,lm,ld){
    if(typeof LUNAR_DATA==='undefined')return{year:ly,month:lm,day:ld};
    var baseDate=new Date(1900,0,31);var dayOffset=0;
    for(var i=LUNAR_START_YEAR;i<ly;i++)dayOffset+=lunarYearDays(i);
    var leap=leapMonthInLunarYear(ly);
    for(var m=1;m<lm;m++){
      if(leap>0&&m===leap)dayOffset+=leapDaysInLunarYear(ly);
      dayOffset+=lunarMonthDays(ly,m);
    }
    dayOffset+=ld-1;
    var result=new Date(baseDate.getTime()+dayOffset*86400000);
    return{year:result.getFullYear(),month:result.getMonth()+1,day:result.getDate()};
  }

  function generateFortune(userData){
    var by=userData.birthYear,bm=userData.birthMonth,bd=userData.birthDay,bc=userData.birthCalendar;
    var zodiac=getZodiacAnimal(by);
    var solarDate=(bc==='lunar')?lunarToSolar(by,bm,bd):{year:by,month:bm,day:bd};
    var constellation=getConstellationInfo(solarDate.month,solarDate.day);
    var now=new Date();var dateNum=now.getFullYear()*10000+(now.getMonth()+1)*100+now.getDate();
    var seed=dateNum*144+zodiac.idx*12+constellation.idx;
    var rng=fortuneSeededRandom(seed);
    return{
      zodiac:zodiac,constellation:constellation,
      overall:FORTUNE_OVERALL[Math.floor(rng()*FORTUNE_OVERALL.length)],
      wealth:FORTUNE_WEALTH[Math.floor(rng()*FORTUNE_WEALTH.length)],
      love:FORTUNE_LOVE[Math.floor(rng()*FORTUNE_LOVE.length)],
      health:FORTUNE_HEALTH[Math.floor(rng()*FORTUNE_HEALTH.length)],
      luckyNumber:Math.floor(rng()*45)+1,
      luckyColor:LUCKY_COLORS[Math.floor(rng()*LUCKY_COLORS.length)],
      score:Math.floor(rng()*41)+60
    };
  }

  function openFortuneModal(){
    var loggedUser = currentUsername || annivLoggedUser;
    if(!loggedUser){
      document.getElementById('fortuneContent').innerHTML=
        '<div class="fortune-login-msg">운세를 확인하려면<br>로그인이 필요합니다.</div>';
      document.getElementById('fortuneOverlay').classList.add('visible');
      return;
    }
    loadUsersFromCloud().then(function(users){
      if(!users) users = getUsers();
      var ud=users[loggedUser];
      if(!ud||!ud.birthYear){
        document.getElementById('fortuneContent').innerHTML=
          '<div class="fortune-login-msg">생년월일이 등록되지 않은 계정입니다.<br><br>새로 회원가입하면서<br>생년월일을 등록해주세요.</div>';
        document.getElementById('fortuneOverlay').classList.add('visible');
        return;
      }
      var f=generateFortune(ud);
      var now=new Date();
      var dateStr=now.getFullYear()+'년 '+(now.getMonth()+1)+'월 '+now.getDate()+'일';
      var html='<div class="fortune-date">'+dateStr+'</div>';
      html+='<div class="fortune-zodiac-box">';
      html+='<div class="fortune-zodiac-item"><span class="fortune-zodiac-emoji">'+f.zodiac.emoji+'</span>';
      html+='<span class="fortune-zodiac-name">'+f.zodiac.name+'띠</span>';
      html+='<span class="fortune-zodiac-sub">'+ud.birthYear+'년생</span></div>';
      html+='<div class="fortune-zodiac-item"><span class="fortune-zodiac-emoji">'+f.constellation.symbol+'</span>';
      html+='<span class="fortune-zodiac-name">'+f.constellation.name+'</span>';
      html+='<span class="fortune-zodiac-sub">'+ud.birthMonth+'월 '+ud.birthDay+'일</span></div>';
      html+='</div>';
      html+='<div class="fortune-score-wrap"><div class="fortune-score-label">TODAY\'S SCORE</div>';
      html+='<div class="fortune-score-num">'+f.score+'</div>';
      html+='<div class="fortune-score-bar"><div class="fortune-score-fill" style="width:'+f.score+'%"></div></div></div>';
      html+='<div class="fortune-categories">';
      html+='<div class="fortune-cat-card"><div class="fortune-cat-header"><span class="fortune-cat-icon">⭐</span><span class="fortune-cat-title">총운</span></div><div class="fortune-cat-text">'+f.overall+'</div></div>';
      html+='<div class="fortune-cat-card"><div class="fortune-cat-header"><span class="fortune-cat-icon">💰</span><span class="fortune-cat-title">재물운</span></div><div class="fortune-cat-text">'+f.wealth+'</div></div>';
      html+='<div class="fortune-cat-card"><div class="fortune-cat-header"><span class="fortune-cat-icon">💕</span><span class="fortune-cat-title">애정운</span></div><div class="fortune-cat-text">'+f.love+'</div></div>';
      html+='<div class="fortune-cat-card"><div class="fortune-cat-header"><span class="fortune-cat-icon">💪</span><span class="fortune-cat-title">건강운</span></div><div class="fortune-cat-text">'+f.health+'</div></div>';
      html+='</div>';
      html+='<div class="fortune-lucky-row">';
      html+='<div class="fortune-lucky-card"><div class="fortune-lucky-label">LUCKY NUMBER</div><div class="fortune-lucky-value">'+f.luckyNumber+'</div></div>';
      html+='<div class="fortune-lucky-card"><div class="fortune-lucky-label">LUCKY COLOR</div><div class="fortune-lucky-value"><span class="fortune-lucky-color-dot" style="background:'+f.luckyColor.hex+'"></span>'+f.luckyColor.name+'</div></div>';
      html+='</div>';
      document.getElementById('fortuneContent').innerHTML=html;
      document.getElementById('fortuneOverlay').classList.add('visible');
    });
  }

  function closeFortune(){
    document.getElementById('fortuneOverlay').classList.remove('visible');
  }

  // === Tarot Engine ===
  var TAROT_CARDS = [
    {num:0,name:'바보',symbol:'🃏',meaning:'새로운 시작, 순수함, 모험',
     past:['과거에 두려움 없이 새로운 길을 선택한 경험이 지금의 당신을 만들었습니다. 그때의 당신은 아무런 보장도 없이 낯선 세계로 첫 발을 내디뎠지요. 주변에서 만류하는 목소리도 있었지만, 당신의 순수한 열정은 그 어떤 두려움보다 강했습니다. 그 용감한 선택이 지금 당신이 서 있는 이 자리의 든든한 초석이 되었음을 잊지 마세요.','순수한 마음으로 도전했던 과거의 용기가 오늘의 밑거름이 되었습니다. 당신은 세상의 계산법을 따르지 않고 오직 가슴이 시키는 대로 움직였습니다. 그 때문에 때로는 상처도 받았지만, 그 모든 경험이 당신만의 독특한 이야기를 만들어냈습니다. 순수함이란 결코 약함이 아니라, 세상을 있는 그대로 받아들이는 가장 강한 힘이었습니다.','한때 무모해 보였던 선택이 결국 최고의 결정이었음을 기억하세요. 돌이켜보면 그 순간 당신은 누구보다 자유로웠고, 그 자유로움이 예상치 못한 행운을 불러왔습니다. 남들이 가지 않은 길 위에서 당신만이 볼 수 있는 풍경을 만났고, 그 경험은 지금도 당신의 영혼 깊은 곳에서 빛나고 있습니다. 과거의 그 순수한 용기를 다시 한번 떠올려 보세요.'],
     present:['지금은 틀에 박힌 생각을 내려놓고 자유롭게 행동할 때입니다. 머릿속에서 끊임없이 울리는 걱정의 목소리를 잠시 내려놓아 보세요. 당신의 영혼은 이미 어디로 가야 할지 알고 있으며, 그 내면의 나침반은 결코 틀린 적이 없습니다. 직감을 믿고 가볍게 한 발을 내딛는 것만으로도 우주는 당신을 위한 길을 열어줄 것입니다.','계산을 멈추고 마음이 이끄는 대로 움직여 보세요. 너무 많은 분석과 걱정은 오히려 기회의 문을 닫아버리는 빗장이 될 수 있습니다. 때로는 지도 없이 떠나는 여행이 가장 아름다운 목적지로 이끌어줍니다. 지금 이 순간, 당신의 직감이 속삭이는 그 방향으로 가볍게 발걸음을 옮기면 뜻밖의 길이 활짝 열릴 것입니다.','완벽한 준비보다 첫 발걸음이 중요합니다. 모든 조건이 완벽해질 때까지 기다리면 그 순간은 영원히 오지 않을 수도 있습니다. 위대한 여정은 언제나 작고 소박한 한 걸음에서 시작되었습니다. 가벼운 마음으로 시작하세요. 당신에게 필요한 것은 완벽한 계획이 아니라, 시작하겠다는 순수한 의지뿐입니다.'],
     future:['예상치 못한 새로운 기회가 찾아올 것입니다. 그 기회는 당신이 예상했던 모습과는 전혀 다른 형태로 나타날 수 있습니다. 하지만 바로 그 낯선 모습이야말로 진정한 변화의 시작을 알리는 신호입니다. 열린 마음으로 받아들이면 그 너머에 펼쳐진 세계가 당신을 놀라게 할 것입니다.','곧 인생의 새로운 장이 펼쳐질 것입니다. 이전까지의 이야기가 서문이었다면, 지금부터가 본격적인 당신의 이야기입니다. 새로운 장에는 새로운 등장인물, 새로운 무대, 그리고 상상하지 못했던 가능성들이 가득할 것입니다. 모험을 두려워하지 말고 용기를 가지고 페이지를 넘기세요.','미지의 세계가 당신을 기다립니다. 아직 한 번도 가보지 않은 길 위에서 당신은 자신조차 몰랐던 새로운 면모를 발견하게 될 것입니다. 호기심을 따라가면 그 여정에서 만나는 모든 것들이 당신의 영혼을 풍요롭게 채워줄 것입니다. 세상은 넓고, 당신의 놀라운 모험은 이제 막 시작되려 하고 있습니다.']},
    {num:1,name:'마법사',symbol:'🧙',meaning:'창조력, 의지력, 능력',
     past:['당신이 가진 재능과 기술이 과거의 성공을 이끌어왔습니다. 어쩌면 당신은 자신의 능력을 당연한 것으로 여기고 있을지 모르지만, 그것은 오랜 시간 갈고닦아온 소중한 결실입니다. 과거의 당신은 주어진 자원을 활용하여 불가능해 보이는 일도 해냈습니다. 그 마법 같은 능력은 지금도 당신 안에 고스란히 살아 있습니다.','과거에 발휘한 창의력과 집중력이 탄탄한 토대를 만들었습니다. 당신은 남들이 보지 못하는 가능성을 발견하고, 그것을 현실로 만들어내는 특별한 힘을 가지고 있었습니다. 무에서 유를 창조하는 당신의 능력은 주변 사람들에게도 깊은 인상을 남겼지요. 그때 쌓아올린 기반이 지금까지도 당신을 단단하게 받쳐주고 있습니다.','어려운 상황에서도 지혜롭게 해결해온 경험이 쌓여 있습니다. 당신은 마치 연금술사처럼 위기를 기회로 바꾸는 놀라운 능력을 보여왔습니다. 한정된 자원 속에서도 최선의 결과를 만들어낸 과거의 경험들이 당신의 자신감의 원천입니다. 그 지혜로운 문제 해결 능력은 앞으로도 당신의 가장 강력한 무기가 될 것입니다.'],
     present:['지금 가진 자원과 능력을 최대한 활용하세요. 마법사의 테이블 위에는 이미 필요한 모든 것이 놓여 있듯이, 당신에게도 목표를 이루기 위한 모든 요소가 갖춰져 있습니다. 지금 필요한 것은 새로운 도구가 아니라, 이미 가진 것들을 연결하고 조합하는 당신만의 창조적 시선입니다. 자신의 능력을 온전히 신뢰하고 과감하게 행동에 옮기세요.','당신 안에 잠든 잠재력을 깨울 시간입니다. 당신이 가진 재능은 아직 그 전모를 드러내지 않은 거대한 빙산과 같습니다. 표면 위로 보이는 것은 극히 일부에 불과하며, 깊은 곳에서는 엄청난 힘이 깨어나기를 기다리고 있습니다. 자신의 능력을 과소평가하지 말고, 지금이 바로 그 숨겨진 잠재력을 세상에 드러낼 최적의 순간입니다.','창조적 에너지가 최고조인 시기입니다. 지금 당신의 머릿속에서 번뜩이는 영감들은 우주가 보내는 소중한 선물입니다. 그 아이디어들을 그냥 흘려보내지 말고 하나씩 현실로 만들어 나가보세요. 아이디어를 행동으로 옮길 때, 당신의 의지와 창조력이 만나 놀라운 마법이 일어날 것입니다.'],
     future:['당신의 의지와 집중력이 원하는 결과를 만들어낼 것입니다. 흩어져 있던 에너지가 하나의 목표를 향해 강력하게 모이는 시기가 다가오고 있습니다. 마치 렌즈가 빛을 한 점에 모으듯, 당신의 집중된 의지는 불가능을 가능으로 바꾸는 힘을 발휘할 것입니다. 원하는 것을 명확히 그리고 흔들림 없이 나아가세요.','숙련된 기술이 빛을 발해 목표를 달성하게 될 것입니다. 오랜 시간 갈고닦아온 당신의 전문성이 드디어 세상에 인정받는 순간이 옵니다. 작은 성과들이 모여 하나의 큰 성취로 이어지며, 그 과정에서 당신의 실력은 더욱 빛날 것입니다. 꾸준히 쌓아온 노력의 시간들이 마침내 화려한 결실을 맺습니다.','당신만의 독창적인 방법으로 큰 성과를 이루게 됩니다. 남들과 같은 길을 가지 않는 당신의 독특한 접근법이 오히려 성공의 열쇠가 될 것입니다. 세상에 없던 새로운 가치를 창조하는 당신의 능력이 많은 사람들에게 영감을 줄 것입니다. 당신이 만들어낼 그 마법 같은 성과를 기대하셔도 좋습니다.']},
    {num:2,name:'여사제',symbol:'🌙',meaning:'직관, 지혜, 내면의 목소리',
     past:['과거에 느꼈던 직감이 옳았음을 깨닫게 될 것입니다. 그때 당신은 논리적으로 설명할 수 없었지만, 마음 깊은 곳에서 울려오는 목소리를 들었습니다. 비록 주변에서 이해하지 못했을지라도, 그 직감은 당신을 올바른 방향으로 인도하고 있었습니다. 시간이 지나 돌아보면, 당신의 내면의 지혜가 얼마나 정확했는지 놀라게 될 것입니다.','조용히 관찰하며 쌓아온 통찰력이 지금의 지혜가 되었습니다. 당신은 시끄러운 세상 속에서도 고요한 마음의 눈으로 진실을 꿰뚫어 보는 능력을 키워왔습니다. 겉으로 드러나지 않는 것들의 의미를 읽어내는 당신의 감수성은 오랜 관찰과 성찰의 결과입니다. 그 깊은 통찰력이야말로 당신이 가진 가장 귀한 보물입니다.','감추어진 지식을 탐구했던 과거가 깊은 이해력을 선물했습니다. 당신은 표면 아래 숨겨진 의미를 찾아 끊임없이 탐구해왔으며, 그 여정에서 남들이 모르는 깊은 진리를 발견했습니다. 그 비밀스러운 지식의 세계를 여행했던 경험이 지금 당신에게 남다른 깊이를 부여하고 있습니다. 과거의 탐구 정신이 지금의 지혜로운 당신을 만들어낸 것입니다.'],
     present:['논리보다 직감을 따르세요. 지금 당신을 둘러싼 상황은 이성적인 분석만으로는 전체 그림을 파악하기 어렵습니다. 마음을 열고 깊은 곳에서 올라오는 느낌에 집중해 보세요. 내면의 목소리가 정답을 알고 있으며, 당신의 직관은 수많은 경험과 지혜가 응축된 강력한 안내자입니다.','마음을 고요히 하고 내면의 소리에 집중하세요. 바쁜 일상의 소음 속에서 잠시 벗어나 고요한 시간을 가져보세요. 명상이나 산책, 혹은 단순히 눈을 감고 깊이 숨쉬는 것만으로도 내면의 지혜에 접근할 수 있습니다. 답은 이미 안에 있으며, 외부에서 찾아 헤매던 해답이 마음 가장 깊은 곳에서 조용히 기다리고 있었음을 발견하게 될 것입니다.','겉으로 보이는 것 너머를 살피세요. 현재 당신 앞에 놓인 상황에는 눈에 보이지 않는 층위가 존재합니다. 사람들의 말 이면에 숨겨진 진심, 사건 이면에 감춰진 의도를 읽어내는 것이 중요합니다. 여사제의 달빛처럼 은은하지만 꿰뚫는 시선으로 세상을 바라보면, 숨겨진 의미 속에서 소중한 진실을 발견하게 될 것입니다.'],
     future:['숨겨진 진실이 곧 드러날 것입니다. 지금은 아직 안개 속에 가려져 있지만, 머지않아 모든 것이 선명하게 보이는 순간이 찾아올 것입니다. 인내심을 가지고 성급하게 결론을 내리기보다 자연스러운 흐름을 신뢰하며 기다리세요. 진실이 스스로 모습을 드러낼 때, 당신은 그동안의 인내가 얼마나 현명한 선택이었는지 깨닫게 될 것입니다.','직관이 당신을 올바른 방향으로 이끌 것입니다. 앞으로 중요한 선택의 순간이 찾아올 때, 당신의 직감이 등불이 되어줄 것입니다. 다른 사람들의 의견에 흔들리지 말고 당신 안에 깃든 고요한 확신을 따르세요. 내면의 지혜를 신뢰하면 그 나침반이 당신을 가장 밝은 미래로 안내할 것입니다.','아직 보이지 않는 기회가 서서히 모습을 드러낼 것입니다. 마치 새벽녘에 안개가 걷히듯, 시간이 지나면서 숨겨져 있던 가능성들이 하나둘 나타나기 시작할 것입니다. 지금은 보이지 않더라도 조급해하지 마세요. 달이 차오르듯 자연스러운 리듬에 맡기면, 당신에게 꼭 필요한 기회가 가장 완벽한 타이밍에 찾아올 것입니다.']},
    {num:3,name:'여황제',symbol:'👑',meaning:'풍요, 모성, 자연의 축복',
     past:['사랑과 돌봄을 받았던 경험이 당신의 따뜻한 마음을 키웠습니다. 누군가가 조건 없이 베풀어준 사랑의 기억이 당신의 마음속 깊은 곳에 따스한 불씨로 남아 있습니다. 그 사랑은 당신에게 세상을 신뢰하는 힘을 주었고, 타인에게도 같은 따뜻함을 나눌 수 있는 사람으로 성장시켰습니다. 받았던 사랑의 크기만큼 당신의 마음도 넓고 깊어졌습니다.','풍요로운 환경에서 자란 감성이 삶의 아름다움을 느끼게 해줍니다. 자연의 아름다움, 예술의 감동, 인간관계의 따스함 등 당신은 삶 곳곳에서 풍요로움을 경험해왔습니다. 그 풍성한 경험들이 당신의 감성을 풍부하게 만들어, 작은 것에서도 큰 행복을 발견하는 능력을 갖추게 되었습니다. 당신의 삶을 둘러싼 아름다움은 과거로부터 이어져 온 축복의 연속입니다.','과거에 베풀었던 사랑이 씨앗이 되어 지금 열매를 맺고 있습니다. 당신이 무심코 건넨 따뜻한 말 한마디, 작은 친절이 누군가의 마음에 깊이 뿌리를 내렸습니다. 사랑은 결코 사라지지 않고 순환하며, 당신이 뿌린 선의의 씨앗들이 이제 아름다운 꽃으로 피어나고 있습니다. 그 풍성한 수확의 기쁨을 마음껏 누리실 자격이 당신에게 있습니다.'],
     present:['주변 사람들에게 따뜻함을 나누세요. 지금 당신에게는 나눌 수 있는 사랑의 에너지가 넘쳐흐르고 있습니다. 작은 미소, 진심 어린 칭찬, 따뜻한 포옹 하나가 누군가의 하루를 완전히 바꿀 수 있습니다. 베풀수록 더 많이 돌아오며, 마음에서 마음으로 전해지는 따스함을 나눌 때 당신의 삶도 더욱 풍요로워집니다.','자연과 교감하는 시간을 가지세요. 바쁜 일상에서 벗어나 푸른 나무 아래 서거나, 맑은 바람을 느끼며 산책해 보세요. 자연은 가장 위대한 치유자이며, 당신의 지친 영혼에 새로운 생명력을 불어넣어 줄 것입니다. 흙을 만지고, 꽃향기를 맡고, 새소리에 귀 기울이는 것만으로도 치유와 영감이 샘솟는 것을 느끼게 될 것입니다.','창의적인 프로젝트를 시작하기에 최적의 시기입니다. 여황제의 에너지가 당신을 감싸고 있는 지금, 당신의 창조적 본능이 그 어느 때보다 강하게 깨어나고 있습니다. 글을 쓰든, 그림을 그리든, 요리를 하든, 정원을 가꾸든 당신의 손길이 닿는 곳에 아름다움이 피어날 것입니다. 감성이 꽃피고 있는 이 풍요로운 에너지를 무언가를 창조하는 데 쏟아부으세요.'],
     future:['풍요롭고 안정적인 시기가 다가오고 있습니다. 물질적으로나 정서적으로나 당신의 삶이 한층 더 넉넉해지는 때가 다가오고 있습니다. 이 풍요로움은 당신이 지금까지 쌓아온 선한 에너지의 자연스러운 결과입니다. 감사하는 마음을 잊지 말고, 그 풍요를 주변과 나눌 때 축복은 더욱 커져 돌아올 것입니다.','사랑과 행복이 가득한 시간이 찾아올 것입니다. 당신의 마음을 따뜻하게 채워줄 소중한 인연과의 깊은 교감이 기다리고 있습니다. 가족, 친구, 연인과의 관계가 더욱 깊어지고, 서로의 존재가 주는 기쁨을 새삼 느끼게 되는 시간입니다. 사랑이 넘치는 일상 속에서 당신은 진정한 행복의 의미를 발견하게 될 것입니다.','당신이 가꾸어온 것들이 아름답게 결실을 맺을 것입니다. 오랫동안 정성을 들여 돌봐온 관계, 프로젝트, 꿈들이 드디어 화려한 꽃을 피울 때가 다가오고 있습니다. 마치 봄이 오면 씨앗이 싹트듯, 당신의 노력도 자연의 순리대로 열매를 맺게 될 것입니다. 그 아름다운 수확의 순간을 기대하며 지금의 정성을 이어가세요.']},
    {num:4,name:'황제',symbol:'🏛️',meaning:'권위, 안정, 리더십',
     past:['규율과 질서를 중시했던 경험이 탄탄한 기반을 만들었습니다. 당신은 혼란 속에서도 체계를 세우고 원칙을 지키며 살아왔습니다. 그 일관된 태도가 주변에 신뢰와 안정감을 주었으며, 흔들림 없는 기반을 다지는 데 결정적인 역할을 했습니다. 과거에 세운 그 견고한 질서가 지금의 당신을 떠받치는 든든한 기둥이 되고 있습니다.','과거에 보여준 책임감과 리더십이 주변의 신뢰를 얻었습니다. 어려운 순간마다 앞장서서 길을 열어온 당신의 모습을 사람들은 기억하고 있습니다. 책임을 회피하지 않고 묵묵히 짊어진 그 무거운 어깨가 많은 이들에게 의지가 되어왔지요. 그렇게 쌓아온 신뢰는 어떤 보물보다 귀중한 당신만의 자산입니다.','체계적으로 쌓아온 경험과 실력이 든든한 자산이 되었습니다. 하루아침에 이루어진 것은 아무것도 없으며, 당신의 실력은 수많은 날들의 성실한 노력이 빚어낸 결정체입니다. 한 계단 한 계단 착실히 올라온 당신의 여정은 그 자체로 존경받을 만한 것입니다. 그 탄탄한 경험의 축적이 앞으로도 당신이 어디서든 흔들리지 않게 해줄 것입니다.'],
     present:['지금은 체계적으로 계획하고 실행할 때입니다. 직감보다는 전략이, 충동보다는 계획이 더 나은 결과를 가져오는 시기입니다. 명확한 목표를 세우고 단계별로 실행해 나가는 것이 성공의 열쇠입니다. 당신 안에 있는 황제의 에너지를 깨워 리더십을 발휘하며 주도적으로 상황을 이끌어 나가세요.','확고한 결단력이 필요한 시기입니다. 주변의 다양한 의견과 상황 변화에 이리저리 휘둘리지 않는 것이 중요합니다. 신중하게 판단한 후에는 그 결정을 끝까지 밀고 나가는 강단이 필요합니다. 흔들림 없이 나아가는 당신의 확고한 의지는 주변 사람들에게도 안정감을 주며, 함께 나아갈 수 있는 힘을 만들어냅니다.','주도적으로 상황을 이끌어가세요. 다른 사람의 결정을 기다리거나 상황이 저절로 해결되기를 바라지 마세요. 지금은 당신이 직접 주도권을 잡고 방향을 설정해야 할 때입니다. 당신의 판단을 믿어도 되며, 오랜 경험에서 나온 그 판단력은 충분히 신뢰할 만합니다.'],
     future:['노력의 결실로 안정적인 지위를 얻게 될 것입니다. 꾸준히 쌓아온 실력과 성과가 마침내 공식적인 인정으로 이어지는 시기가 다가오고 있습니다. 당신의 자리가 더욱 견고해지고, 그 위치에서 더 큰 영향력을 발휘할 수 있게 될 것입니다. 안정 속에서 더 큰 도약을 준비하는 지혜를 발휘하세요.','당신의 리더십이 인정받아 더 큰 역할을 맡게 될 것입니다. 그동안 묵묵히 보여온 책임감과 능력이 높이 평가받는 순간이 다가오고 있습니다. 더 넓은 무대, 더 큰 책임이 당신을 기다리고 있으며, 당신은 그것을 감당할 준비가 되어 있습니다. 새로운 역할을 자신감 있게 받아들이세요.','견고한 기반 위에 성공을 쌓아갈 수 있는 때가 옵니다. 지금까지 다져온 토대 위에 드디어 장엄한 건축물을 올릴 수 있는 시기가 열리고 있습니다. 서두르지 않고 하나하나 벽돌을 쌓듯 진행하면, 세월이 지나도 무너지지 않는 견고한 성공을 이루게 될 것입니다. 황제의 지혜로 장기적인 안목을 가지고 나아가세요.']},
    {num:5,name:'교황',symbol:'🙏',meaning:'전통, 가르침, 영적 성장',
     past:['멘토나 스승의 가르침이 당신의 성장에 큰 영향을 주었습니다. 인생의 중요한 시기에 만난 지혜로운 안내자가 당신에게 삶의 방향을 제시해 주었던 것을 기억하실 것입니다. 그분의 말씀 하나하나가 당신의 영혼에 깊이 새겨져, 어려운 순간마다 등불이 되어주었습니다. 그 소중한 가르침은 시간이 지날수록 더 깊은 의미로 다가올 것입니다.','전통과 가치관이 삶의 나침반이 되어왔습니다. 세상이 빠르게 변해도 변하지 않는 것들의 소중함을 당신은 알고 있습니다. 가족에게서, 공동체에서, 문화에서 이어받은 가치관이 당신의 삶에 깊은 뿌리를 내려주었습니다. 그 흔들리지 않는 가치의 뿌리가 당신을 어떤 폭풍 속에서도 지켜주는 닻이 되어왔습니다.','공동체 안에서 배운 교훈이 지혜의 원천이 되었습니다. 함께하는 삶 속에서 당신은 혼자서는 결코 배울 수 없는 소중한 교훈들을 얻어왔습니다. 사람들과의 관계에서 오는 기쁨과 아픔, 화합과 갈등의 경험이 모두 당신의 지혜를 키우는 양분이 되었습니다. 그 공동체적 지혜는 당신을 더 넓은 시야를 가진 사람으로 성장시켰습니다.'],
     present:['배움의 자세를 유지하세요. 아무리 많은 것을 알고 있어도 겸손한 마음으로 새로운 가르침에 열려 있을 때, 예상치 못한 깨달음이 찾아옵니다. 지금 당신의 주변에 지혜로운 목소리가 있을 수 있으니 귀 기울여 보세요. 좋은 조언자를 만날 수 있는 시기이며, 진정한 지혜는 자신이 모르는 것이 있음을 인정하는 데서 시작됩니다.','마음을 열고 주변의 지혜로운 목소리에 귀 기울이세요. 때로는 예상치 못한 곳에서 인생을 바꾸는 한마디를 들을 수 있습니다. 나이 든 어른의 경험담이든, 아이의 순수한 한마디든, 진리는 어디에서나 모습을 드러낼 수 있습니다. 열린 마음으로 세상의 가르침을 받아들일 때, 당신의 영적 성장은 한 단계 더 높이 올라갈 것입니다.','영적인 성장을 추구하면 일상에서도 평화를 찾게 됩니다. 물질적인 것을 넘어선 깊은 차원의 성장이 지금 당신에게 필요한 시기입니다. 명상, 기도, 자기 성찰 등 내면을 가꾸는 시간을 가져보세요. 영혼이 평안해지면 외부의 혼란도 당신을 흔들 수 없으며, 일상의 작은 순간들 속에서도 깊은 평화와 감사를 느끼게 될 것입니다.'],
     future:['정신적 성장과 깨달음이 찾아올 것입니다. 당신의 영혼이 한 단계 더 높은 곳으로 올라가는 시기가 다가오고 있습니다. 삶의 깊은 의미에 대한 통찰이 찾아와 모든 것을 새로운 눈으로 바라보게 될 것입니다. 그 깨달음은 조용하지만 강력하게 당신의 삶 전체를 밝혀줄 것입니다.','당신의 경험이 누군가에게 소중한 가르침이 될 것입니다. 지금까지 살아온 당신의 이야기 속에는 다른 사람들이 배울 수 있는 귀한 지혜가 담겨 있습니다. 머지않아 당신의 경험과 지식을 나눌 기회가 찾아올 것이며, 그 나눔이 누군가의 인생에 빛이 될 것입니다. 가르침을 주는 것은 곧 자신도 더 깊이 배우는 과정임을 기억하세요.','신념을 지켜나가면 삶의 의미를 더 깊이 발견하게 됩니다. 세상의 유혹과 혼란 속에서도 당신이 소중히 여기는 가치를 놓지 마세요. 그 신념의 길 위에서 당신은 점점 더 선명한 삶의 목적을 발견하게 될 것입니다. 흔들리지 않는 믿음이 결국 당신을 가장 의미 있는 곳으로 인도할 것입니다.']},
    {num:6,name:'연인',symbol:'💑',meaning:'사랑, 조화, 선택',
     past:['중요한 선택의 순간이 지금의 관계를 만들어냈습니다. 인생의 갈림길에서 당신은 마음이 이끄는 방향을 선택했고, 그 결정이 지금 당신 곁에 있는 소중한 인연을 만들어주었습니다. 그때의 선택이 쉽지 않았을지라도, 사랑을 향한 당신의 용기가 아름다운 결실을 맺었음을 기억하세요. 모든 진정한 관계는 그러한 용감한 선택의 순간에서 시작됩니다.','과거의 사랑과 유대가 마음 깊은 곳에 아름다운 기억으로 남아있습니다. 함께 웃고 울었던 순간들, 서로의 눈을 바라보며 느꼈던 따뜻한 교감이 당신의 영혼에 깊이 새겨져 있습니다. 그 기억들은 시간이 지나도 빛바래지 않으며, 오히려 세월이 흐를수록 더 깊은 의미를 띠게 됩니다. 과거의 사랑이 당신에게 남긴 선물은 사랑할 줄 아는 따뜻한 마음입니다.','진심을 다해 관계를 맺어온 경험이 깊은 유대감을 형성했습니다. 당신은 관계에서 결코 가벼운 태도를 취하지 않았으며, 항상 온 마음을 다해 상대방을 대해왔습니다. 그 진심이 통했기에 당신의 주변에는 진정한 마음으로 연결된 사람들이 있는 것입니다. 진심으로 맺어진 인연은 어떤 풍파에도 끊어지지 않는 가장 강한 끈입니다.'],
     present:['마음의 소리에 귀 기울이세요. 지금 당신의 가슴은 무언가를 간절히 말하고 있습니다. 머리로만 판단하려 하지 말고, 심장이 두근거리는 방향에 주목해 보세요. 진정한 사랑과 조화를 추구할 때이며, 당신의 마음이 가리키는 곳에 진짜 행복이 기다리고 있습니다.','중요한 선택의 기로에 서 있습니다. 두 갈래 혹은 여러 갈래의 길 앞에서 당신은 지금 결정을 내려야 하는 순간에 와 있습니다. 손익을 따지기보다 가슴이 원하는 방향을 따르세요. 사랑에 관한 결정만큼은 이성보다 감성이 더 정확한 나침반이 되어줄 것입니다.','소중한 사람과 더 깊이 소통하면 관계가 한 단계 성장합니다. 일상에 묻혀 잊고 있었던 진심 어린 대화의 시간을 다시 가져보세요. 서로의 마음속 깊은 이야기를 나눌 때, 관계는 새로운 차원의 친밀함으로 발전합니다. 진정한 소통은 말하는 것뿐만 아니라 상대방의 침묵까지 이해하는 것에서 시작됩니다.'],
     future:['의미 있는 인연이 더욱 깊어지거나 새로운 인연이 찾아올 것입니다. 당신의 삶에 사랑의 에너지가 강하게 흐르고 있으며, 그 에너지는 소중한 관계를 더욱 풍성하게 만들어줄 것입니다. 기존의 인연과는 더 깊은 이해와 공감의 단계로 나아가게 되며, 새로운 만남의 가능성도 활짝 열려 있습니다. 사랑에 대한 열린 마음을 유지하세요.','사랑과 조화가 당신의 삶에 큰 기쁨을 가져다줄 것입니다. 서로 다른 두 마음이 하나로 어우러지는 아름다운 순간이 기다리고 있습니다. 갈등보다는 화합이, 경쟁보다는 협력이 당신의 미래를 밝게 물들일 것입니다. 사랑의 힘이 당신의 삶 모든 영역에 따뜻한 빛을 비추게 될 것입니다.','마음을 열면 운명적인 만남이나 화합의 순간이 찾아옵니다. 우주는 당신을 위해 특별한 인연을 준비하고 있으며, 당신이 마음의 문을 열기만 하면 그 선물이 전해질 것입니다. 과거의 상처 때문에 마음을 닫지 마세요. 가장 아름다운 사랑은 종종 예상치 못한 순간에, 예상치 못한 모습으로 찾아옵니다.']},
    {num:7,name:'전차',symbol:'⚡',meaning:'승리, 전진, 결단력',
     past:['강한 의지로 장애물을 극복해온 당신의 노력이 빛나고 있습니다. 수많은 벽 앞에서도 당신은 멈추지 않았고, 오히려 더 강한 힘으로 돌파해왔습니다. 그 불굴의 의지가 남들은 도달하지 못한 곳까지 당신을 이끌어주었습니다. 과거의 그 전투 하나하나가 지금 당신의 강인한 정신을 만들어낸 소중한 훈련이었습니다.','포기하지 않고 달려온 과거의 추진력이 오늘의 성과를 만들었습니다. 지치고 힘들 때도 멈추지 않고 한 발 한 발 내디딘 당신의 끈기가 결국 차이를 만들어냈습니다. 빠른 속도가 아니라 멈추지 않는 꾸준함이 당신을 여기까지 데려온 진짜 힘이었습니다. 그 굳건한 추진력은 지금도 당신 안에 강렬하게 살아 있습니다.','방향을 정하고 돌진했던 결단력이 큰 변화를 이끌어냈습니다. 다른 사람들이 주저하고 망설일 때, 당신은 목표를 향해 과감하게 전진하는 결단을 내렸습니다. 그 순간의 담대한 결정이 당신의 인생 전체의 궤적을 바꾸어놓았습니다. 결단의 힘이 가져온 변화를 돌아보며 자신의 용기에 자부심을 가지세요.'],
     present:['망설이지 말고 과감하게 전진하세요. 지금은 신중하게 기다릴 때가 아니라, 전력을 다해 앞으로 달려 나갈 때입니다. 당신의 앞길을 막는 장애물들은 당신의 결의 앞에서 무너져 내릴 것입니다. 승리가 가까이 있으며, 마지막 한 걸음을 용기 있게 내딛으면 영광의 순간에 도달하게 됩니다.','지금이 최대한 속도를 내야 할 때입니다. 모든 에너지를 하나의 목표에 집중하고, 잡념을 버리고 전속력으로 달리세요. 전차를 모는 기사처럼 고삐를 단단히 잡고 흔들림 없이 나아가면, 어떤 경쟁에서도 승리할 수 있습니다. 집중력을 발휘하여 지금 이 순간의 기회를 놓치지 마세요.','장애물이 있어도 멈추지 마세요. 눈앞에 보이는 어려움은 당신을 시험하기 위한 것이지, 당신을 멈추게 하기 위한 것이 아닙니다. 당신 안에는 그 어떤 벽도 뚫을 수 있는 강력한 돌파력이 존재합니다. 두려움을 딛고 전진할 때, 길은 반드시 열립니다.'],
     future:['목표를 향한 끈기가 큰 성과로 이어질 것입니다. 지금까지의 노력이 헛되지 않았음을 증명하는 결과가 곧 나타날 것입니다. 마지막까지 포기하지 않는 당신의 끈기가 남들은 얻지 못한 특별한 성과를 안겨줄 것입니다. 승리의 트로피는 끝까지 달린 자에게만 주어집니다.','곧 중요한 승리의 순간이 찾아옵니다. 오랫동안 준비하고 달려온 그 목표에 드디어 도달하는 순간이 눈앞에 있습니다. 이 승리는 당신의 인생에서 중요한 전환점이 될 것이며, 더 큰 도전을 향한 발판이 될 것입니다. 자신감을 잃지 말고 마지막까지 최선을 다하세요.','빠른 진전과 함께 원하는 목적지에 도달하게 될 것입니다. 그동안 더디게 느껴졌던 진행이 갑자기 가속도가 붙으며, 놀라운 속도로 목표에 다가가게 될 것입니다. 전차가 질주하듯 당신의 인생도 빠르게 앞으로 나아가는 시기가 옵니다. 목적지에 도달했을 때 느낄 성취감을 미리 그려보세요.']},
    {num:8,name:'힘',symbol:'🦁',meaning:'용기, 인내, 내면의 강인함',
     past:['어려운 시기를 견뎌낸 경험이 당신을 더 강하게 만들었습니다. 폭풍 같은 시련이 지나간 자리에서 당신은 부러지지 않고 오히려 더 단단해졌습니다. 그 고통의 시간 속에서 당신은 자신도 몰랐던 내면의 강인함을 발견했을 것입니다. 시련은 당신을 파괴하려 했지만, 결국 당신을 더 강한 존재로 만들어주었습니다.','부드럽지만 단단한 의지로 역경을 이겨낸 과거가 있습니다. 당신은 폭력이나 강압이 아닌, 부드러운 인내의 힘으로 어려움을 극복해왔습니다. 물이 바위를 뚫듯, 당신의 꾸준하고 유연한 의지가 결국 가장 단단한 장벽도 넘게 해주었습니다. 그 부드러운 강인함이야말로 당신만이 가진 가장 아름다운 힘입니다.','감정을 다스리며 성숙해온 과정이 내면의 힘을 키웠습니다. 분노, 슬픔, 두려움 같은 격한 감정의 파도를 다스리는 법을 배워온 당신은 그 과정에서 놀라운 내적 성장을 이루었습니다. 감정의 주인이 된다는 것은 자신의 삶의 주인이 된다는 것과 같습니다. 그 성숙한 마음의 힘이 당신의 가장 든든한 방패가 되고 있습니다.'],
     present:['부드러운 힘으로 상황을 다스리세요. 지금 당신 앞에 놓인 도전은 강한 힘으로 억누르기보다 부드럽게 감싸안을 때 더 쉽게 풀립니다. 사자를 길들이는 것은 채찍이 아니라 따뜻한 손길이듯, 인내와 부드러움이 최고의 무기입니다. 조급함을 내려놓고 고요한 강인함으로 상황에 대처하세요.','강압이 아닌 이해와 공감으로 문제를 풀어가세요. 지금 겪고 있는 갈등이나 어려움은 힘으로 밀어붙인다고 해결되지 않습니다. 상대방의 입장에서 생각해보고, 진심 어린 공감으로 다가갈 때 놀라운 변화가 일어날 것입니다. 이해의 힘은 어떤 무력보다 강하며, 진정한 해결책은 그 안에서 탄생합니다.','자신의 감정을 먼저 돌보세요. 다른 사람을 도우려면 먼저 자신이 건강해야 하듯, 내면의 평화를 가꾸는 것이 최우선입니다. 잠시 멈추고 지금 당신이 어떤 감정을 느끼고 있는지 살펴보세요. 내면이 평화로우면 외부의 어떤 소란도 당신을 흔들 수 없으며, 그 안정감이 주변까지 평온하게 만들 것입니다.'],
     future:['내면의 강인함이 외부의 도전을 극복하게 해줄 것입니다. 앞으로 찾아올 시련 앞에서 당신은 놀라울 정도로 침착하고 강인한 자신을 발견하게 될 것입니다. 과거의 경험에서 길러진 내면의 힘이 빛을 발하며, 어떤 도전도 당신을 꺾을 수 없음을 증명하게 됩니다. 당신의 내면에는 이미 모든 것을 이겨낼 수 있는 힘이 준비되어 있습니다.','꾸준한 인내가 결국 가장 큰 힘임을 증명하게 될 것입니다. 빠른 결과를 원하는 세상에서 묵묵히 기다리며 견뎌온 당신의 인내가 마침내 보상받는 때가 옵니다. 급류도 언젠가 잔잔해지듯, 당신의 꾸준한 인내가 만들어낸 결과는 그 어떤 것보다 견고하고 아름다울 것입니다.','어떤 시련이 와도 당신은 충분히 이겨낼 수 있습니다. 미래에 어떤 도전이 기다리고 있든, 당신 안에는 그것을 극복할 수 있는 모든 자원이 이미 갖추어져 있습니다. 두려워하지 마세요. 과거에도 당신은 불가능해 보이는 것들을 해냈고, 앞으로도 그럴 것입니다. 당신의 내면의 사자는 언제나 당신을 지켜줄 것입니다.']},
    {num:9,name:'은둔자',symbol:'🏔️',meaning:'성찰, 내면 탐구, 지혜',
     past:['혼자만의 시간이 깊은 깨달음을 가져다주었습니다. 세상의 소란에서 한 발짝 물러나 고요 속에 머물렀던 그 시간이 당신에게 삶의 본질을 보는 눈을 선물했습니다. 홀로 보낸 시간은 결코 외로움이 아니라, 자신과의 가장 깊은 대화였습니다. 그 시간 속에서 발견한 진리들이 지금 당신의 삶을 밝히는 등불이 되고 있습니다.','고독 속에서 자신을 마주했던 경험이 지혜를 선물했습니다. 아무도 없는 곳에서 거울처럼 맑은 내면을 들여다보았던 당신은 자신의 진짜 모습을 알게 되었습니다. 그 솔직한 자기 대면이 가져다준 깨달음은 어떤 책에서도 배울 수 없는 살아있는 지혜입니다. 자신을 진정으로 아는 사람만이 세상을 진정으로 이해할 수 있습니다.','남들과 다른 길을 걸으며 얻은 통찰이 소중한 자산입니다. 대중이 향하는 방향과 다른 길을 선택하는 것은 용기가 필요한 일이었지만, 당신은 자신만의 길을 묵묵히 걸어왔습니다. 그 외로운 여정에서 만난 풍경과 깨달음은 당신만이 가진 독보적인 통찰이 되었습니다. 혼자 걸은 길이 주는 지혜는 그 어떤 것으로도 대체할 수 없는 가치를 지닙니다.'],
     present:['잠시 멈추고 자신을 돌아보는 시간이 필요합니다. 바쁜 일상의 흐름에서 한 발짝 물러나 내면을 살펴볼 때입니다. 명상이나 조용한 산책이 당신에게 큰 도움이 될 것입니다. 고요 속에서 들려오는 내면의 목소리에 귀 기울이면, 복잡하게 엉켜있던 생각들이 하나씩 실마리를 보여줄 것입니다.','소음에서 벗어나 조용한 공간에서 생각을 정리하세요. 끊임없는 정보와 자극의 홍수 속에서 당신의 마음은 지쳐 있을 수 있습니다. 핸드폰을 내려놓고, 사람들에게서 잠시 떨어져, 오직 자신만을 위한 고요한 시간을 선물하세요. 그 침묵 속에서 당신은 잃어버렸던 내면의 평화와 명료함을 되찾게 될 것입니다.','혼자만의 시간이 지금 가장 필요한 치유입니다. 다른 사람들과 함께하는 것도 좋지만, 지금 당신의 영혼이 원하는 것은 고요한 은둔의 시간입니다. 자신의 내면과 충분히 대화하고, 마음의 상처를 조용히 어루만져 주세요. 혼자만의 시간을 통해 재충전된 당신은 다시 세상으로 나갈 때 한층 더 강하고 지혜로운 모습일 것입니다.'],
     future:['내면의 탐구가 인생의 방향을 밝혀줄 것입니다. 지금 시작하는 자기 성찰의 여정이 당신을 전혀 새로운 삶의 방향으로 이끌 것입니다. 은둔자의 등불처럼 당신의 내면에서 솟아오르는 지혜의 빛이 어두운 길을 환하게 비춰줄 것입니다. 그 빛을 따라가면 진정으로 원하는 삶의 길이 펼쳐질 것입니다.','고요한 성찰 끝에 삶의 진정한 목적을 발견하게 됩니다. 오랫동안 찾아 헤매던 삶의 의미가 깊은 명상과 성찰 끝에 마침내 그 모습을 드러낼 것입니다. 그 발견은 외부가 아닌 당신의 가장 깊은 내면에서 이루어지며, 그 깨달음의 순간은 당신의 삶 전체를 변화시킬 것입니다. 인내심을 가지고 내면의 여정을 계속하세요.','지혜로운 판단이 미래의 중요한 전환점을 만들 것입니다. 깊은 성찰에서 나온 통찰력이 중요한 순간에 당신을 올바른 방향으로 인도할 것입니다. 그 판단은 서두르지 않되 확고하며, 다른 사람들이 미처 보지 못한 것을 꿰뚫는 혜안이 될 것입니다. 은둔자의 지혜가 당신의 미래를 밝혀주는 등대가 될 것입니다.']},
    {num:10,name:'운명의 수레바퀴',symbol:'🎡',meaning:'변화, 순환, 행운',
     past:['인생의 부침을 경험하며 성장해왔습니다. 높은 곳에 올랐다가 다시 내려오고, 어두운 골짜기를 지나 다시 밝은 곳으로 나아온 당신의 여정은 그 자체로 하나의 위대한 이야기입니다. 그 모든 부침이 당신에게 삶의 깊이를 더해주었으며, 어떤 상황에서도 흔들리지 않는 유연함을 가르쳐주었습니다. 인생이란 수레바퀴가 돌듯 끊임없이 변화하며, 당신은 그 순환 속에서 지혜를 얻어왔습니다.','과거의 우연한 사건들이 연결되어 지금의 자리로 이끌었습니다. 돌이켜보면 별것 아닌 것처럼 보였던 만남, 작은 결정, 뜻밖의 사건들이 모두 하나의 큰 그림을 이루고 있었음을 알 수 있습니다. 운명은 보이지 않는 실로 모든 것을 엮어왔으며, 그 실의 끝에 지금의 당신이 서 있습니다. 우연처럼 보였던 모든 것이 사실은 필연이었음을 기억하세요.','좋은 때와 힘든 때를 모두 겪으며 단단해졌습니다. 행복한 시절에는 감사를 배우고, 어려운 시절에는 인내를 배운 당신은 삶의 어떤 국면에도 대비할 수 있는 내공을 갖추게 되었습니다. 빛과 그림자를 모두 경험한 사람만이 가질 수 있는 깊이가 당신에게는 있습니다. 그 풍부한 경험이야말로 당신을 특별하게 만드는 원천입니다.'],
     present:['변화의 흐름에 몸을 맡기세요. 지금 당신의 삶에 불어오는 변화의 바람은 우주가 보내는 축복의 신호입니다. 억지로 흐름을 거스르려 하지 말고, 강물 위의 배처럼 자연스럽게 흘러가 보세요. 운명이 좋은 방향으로 돌아가고 있으며, 이 변화의 물결이 당신을 더 좋은 곳으로 데려다줄 것입니다.','지금 일어나는 변화를 저항하지 말고 자연스럽게 받아들이세요. 변화는 때로 불안하고 두렵지만, 그것은 더 나은 상태로 나아가기 위한 필수적인 과정입니다. 나비가 되기 위해 고치를 벗어야 하듯, 성장을 위해서는 변화를 기꺼이 받아들여야 합니다. 지금의 변화에 유연하게 적응하면, 곧 그 변화가 가져다준 선물을 발견하게 될 것입니다.','예상치 못한 전환점이 다가오고 있습니다. 당신의 일상에 갑작스러운 변화가 찾아올 수 있지만, 그것은 두려워할 일이 아닙니다. 수레바퀴가 돌듯, 삶의 국면이 전환되는 것은 자연스러운 순리입니다. 유연하게 대처하고 열린 마음으로 새로운 국면을 맞이하면, 그 변화 속에 숨겨진 기회를 발견하게 될 것입니다.'],
     future:['행운의 바퀴가 돌아 좋은 기회가 찾아올 것입니다. 지금까지 당신이 인내하며 기다려온 보상이 운명의 수레바퀴를 타고 다가오고 있습니다. 예상하지 못한 곳에서 기회의 문이 열리며, 그 기회를 잡는 것은 오로지 당신의 몫입니다. 행운은 준비된 자에게 찾아오며, 당신은 이미 충분히 준비되어 있습니다.','운명의 흐름이 당신에게 유리하게 바뀌고 있습니다. 한동안 정체되어 있던 것들이 다시 움직이기 시작하며, 모든 상황이 당신에게 유리한 방향으로 전개될 것입니다. 우주의 에너지가 당신의 편에 서서 도와주는 시기가 온 것입니다. 이 순풍을 타고 원하는 곳으로 힘차게 나아가세요.','순환의 법칙대로 힘든 시기가 지나면 풍요로운 때가 옵니다. 겨울이 지나면 반드시 봄이 오듯, 당신이 겪어온 어려운 시간은 이제 마무리되고 풍성한 수확의 계절이 다가오고 있습니다. 이것은 우주의 변함없는 법칙이며, 당신도 그 법칙의 축복을 받게 될 것입니다. 희망을 놓지 마세요, 밝은 시간이 곧 당신의 것이 됩니다.']},
    {num:11,name:'정의',symbol:'⚖️',meaning:'공정, 진실, 균형',
     past:['올바른 판단과 공정한 행동이 신뢰를 쌓아왔습니다. 당신은 언제나 옳고 그름을 분명히 하며, 공정한 태도로 사람들을 대해왔습니다. 그 일관된 정직함이 시간이 지나면서 두터운 신뢰의 벽을 쌓아올렸습니다. 신뢰란 하루아침에 만들어지지 않으며, 당신이 매 순간 보여준 정직함의 결정체입니다.','양심에 따라 행동했던 과거가 오늘의 평판을 만들었습니다. 쉬운 길과 옳은 길 사이에서 당신은 항상 올바른 것을 선택해왔습니다. 때로 그 선택이 손해처럼 보일 때도 있었지만, 장기적으로 그것이 당신에게 가장 큰 자산인 좋은 평판을 선물해주었습니다. 양심을 따른 당신의 결정들은 결코 헛되지 않았습니다.','공과 사를 구분하며 살아온 태도가 존경을 받고 있습니다. 감정에 휘둘리지 않고 객관적이고 공정한 잣대로 판단해온 당신의 태도는 많은 이들에게 본보기가 되어왔습니다. 편견 없이 공정하게 사람을 대하는 당신의 모습에 사람들은 깊은 존경심을 품고 있습니다. 그 균형 잡힌 시각이야말로 당신을 특별하게 만드는 덕목입니다.'],
     present:['어떤 결정이든 진실과 공정함을 기준으로 삼으세요. 지금 당신 앞에 놓인 선택에서 가장 중요한 잣대는 무엇이 진실인가, 무엇이 공정한가입니다. 이해관계나 감정에 휘둘리지 말고 정의의 저울이 가리키는 방향을 따르세요. 진실에 기반한 결정은 비록 당장은 어려울지라도 결국 가장 좋은 결과를 가져다줄 것입니다.','균형 잡힌 시각으로 상황을 판단하면 최선의 답을 찾을 수 있습니다. 한쪽으로 치우치지 않고 모든 면을 고려하는 것이 지금 당신에게 필요한 자세입니다. 양쪽의 이야기를 모두 듣고, 객관적인 사실에 근거하여 판단하세요. 균형의 지혜가 가장 현명한 해결책으로 당신을 인도할 것입니다.','지금은 감정보다 이성적 판단이 더 나은 결과를 가져옵니다. 마음이 흔들리더라도 냉정하게 사실을 직시하고 논리적으로 생각하는 것이 중요한 시기입니다. 감정의 안개를 걷어내고 맑은 눈으로 상황을 바라보세요. 정의의 칼은 감정이 아닌 이성으로 휘둘러야 가장 정확하게 진실을 가를 수 있습니다.'],
     future:['정직한 노력에 대한 정당한 보상이 찾아올 것입니다. 그동안 묵묵히 올바른 길을 걸어온 당신에게 우주가 정의로운 보상을 준비하고 있습니다. 눈에 보이지 않던 당신의 성실함과 정직함이 마침내 빛을 발하는 순간이 다가오고 있습니다. 정의는 때로 느리지만, 반드시 당신의 편에 서게 될 것입니다.','진실은 반드시 밝혀지고, 올바른 것이 승리하게 됩니다. 지금 당장은 진실이 가려져 있거나, 불공정한 상황에 처해 있을 수도 있습니다. 하지만 정의의 저울은 결국 진실의 무게를 정확히 재어줄 것입니다. 당신이 옳다면 두려워하지 마세요, 시간이 모든 것을 바로잡아줄 것입니다.','공정한 결과가 당신에게 유리하게 작용할 것입니다. 그동안의 공정한 행동과 올바른 판단이 카르마의 법칙에 따라 좋은 결과로 돌아올 것입니다. 당신이 세상에 보낸 정의와 공정함의 에너지가 배로 되돌아오는 시기입니다. 올바르게 살아온 당신의 삶이 마침내 그에 걸맞은 보상을 받게 됩니다.']},
    {num:12,name:'매달린 사람',symbol:'🔮',meaning:'인내, 새로운 관점, 희생',
     past:['포기하고 싶었던 순간에도 견딘 것이 현명한 선택이었습니다. 모든 것을 놓아버리고 싶었던 그 순간, 당신은 이를 악물고 버텼습니다. 그때의 인내가 없었다면 지금의 당신은 존재하지 않았을 것입니다. 가장 어두운 밤이 지나야 새벽이 오듯, 당신의 견딤이 결국 빛나는 결과를 가져다주었습니다.','기꺼이 희생했던 과거가 더 큰 가치를 만들어냈습니다. 당신은 자신의 편안함을 내려놓고 더 큰 무언가를 위해 기꺼이 대가를 치렀습니다. 그 희생은 결코 헛되지 않았으며, 시간이 지나면서 그것이 얼마나 소중한 선택이었는지 증명되고 있습니다. 진정한 가치는 희생 없이는 얻을 수 없으며, 당신은 그 진리를 몸소 체험한 사람입니다.','멈춤의 시간이 새로운 시각을 선물해준 경험이 있습니다. 강제로든 자발적으로든 한때 모든 것이 멈추었던 시기가 있었고, 그 정지된 시간 속에서 당신은 세상을 완전히 다른 각도로 바라보게 되었습니다. 거꾸로 매달려 보아야 비로소 보이는 것들이 있듯, 멈춤이 가져다준 새로운 시각은 당신의 삶을 풍요롭게 만들었습니다.'],
     present:['상황을 다른 각도에서 바라보세요. 지금 당신이 직면한 문제는 기존의 방식으로는 풀리지 않을 수 있습니다. 완전히 다른 시각에서, 마치 세상을 거꾸로 보듯이 접근해 보세요. 새로운 관점이 해답을 주며, 그 역발상의 힘이 막혀있던 길을 열어줄 것입니다.','지금은 행동보다 기다림이 더 현명한 시기입니다. 무언가를 하지 않는 것도 하나의 강력한 행동임을 기억하세요. 성급하게 움직이면 오히려 상황이 꼬일 수 있으며, 차분하게 기다리면 최적의 행동 시점이 저절로 찾아올 것입니다. 인내는 쓰지만 그 열매는 달며, 지금의 기다림이 미래의 큰 도약을 위한 준비입니다.','익숙한 방식을 잠시 내려놓으면 전혀 다른 가능성이 보입니다. 당신이 당연하다고 여겨온 것들을 잠시 의심해 보세요. 고정관념의 틀을 벗어나 자유롭게 사고할 때, 지금까지 보이지 않았던 숨겨진 길이 나타날 것입니다. 매달린 사람처럼 기꺼이 불편한 자세를 취해볼 때, 세상은 전혀 다른 모습으로 다가옵니다.'],
     future:['잠시 기다림의 시간이 더 큰 보상으로 이어질 것입니다. 지금 당장 결과가 보이지 않더라도 초조해하지 마세요. 당신이 보내는 이 기다림의 시간은 씨앗이 땅속에서 뿌리를 내리는 것과 같습니다. 보이지 않는 곳에서 성장이 이루어지고 있으며, 때가 되면 놀라운 결실로 보답받게 될 것입니다.','지금의 인내가 미래에 큰 전환점을 만들어줄 것입니다. 현재의 멈춤과 기다림이 지루하게 느껴질 수 있지만, 이 시간은 당신의 인생을 완전히 바꿀 도약을 위한 준비 기간입니다. 활시위를 당기듯 충분히 참고 기다린 후에 놓으면, 화살은 그만큼 더 멀리, 더 정확하게 날아갈 것입니다.','다른 관점에서 본 세상이 새로운 기회를 열어줄 것입니다. 지금 당신이 쌓아가고 있는 새로운 시각과 통찰력이 미래에 예상치 못한 기회를 가져다줄 것입니다. 남들이 보지 못하는 것을 보는 당신의 독특한 관점이 세상에 꼭 필요한 가치를 만들어낼 것입니다. 지금의 불편한 자세가 미래의 놀라운 발견으로 이어질 것입니다.']},
    {num:13,name:'죽음',symbol:'🦋',meaning:'변환, 끝과 시작, 재탄생',
     past:['과거의 한 장이 끝나면서 새로운 시작이 열렸습니다. 당신의 인생에서 어떤 시기가 완전히 막을 내렸던 경험이 있습니다. 그 당시에는 모든 것이 끝난 것 같았지만, 사실 그것은 더 아름다운 이야기의 시작이었습니다. 하나의 문이 닫힐 때 다른 문이 열리는 것이 삶의 신비이며, 당신은 그 진리를 직접 체험해왔습니다.','큰 변화를 겪으며 완전히 새로운 사람으로 성장했습니다. 과거의 당신과 지금의 당신은 마치 다른 사람처럼 달라졌을 것입니다. 그 변화의 과정은 고통스러웠지만, 그것을 통해 당신은 더 깊고, 더 넓고, 더 강한 존재로 다시 태어났습니다. 애벌레가 나비가 되듯, 당신의 변화는 가장 아름다운 진화였습니다.','과거를 보내준 용기가 지금의 자유를 선물했습니다. 익숙하고 편안했지만 더 이상 당신에게 맞지 않는 것들을 놓아준 결단이 있었습니다. 그 이별은 쉽지 않았지만, 당신은 미련 대신 용기를 선택했습니다. 그렇게 과거를 떠나보낸 빈자리에 새로운 가능성과 자유가 찾아왔습니다.'],
     present:['낡은 것을 과감히 놓아주세요. 지금 당신이 붙잡고 있는 것 중에 이미 수명을 다한 것이 있습니다. 그것이 관계든, 습관이든, 생각이든, 더 이상 당신에게 도움이 되지 않는 것은 감사히 보내줄 때입니다. 끝은 곧 새로운 시작이며, 놓아주는 순간 당신의 손에는 새로운 것을 받을 수 있는 공간이 생깁니다.','변화를 받아들이세요. 지금 당신의 삶에서 무언가가 끝나가고 있다면, 그것을 억지로 붙잡으려 하지 마세요. 나비가 되려면 고치를 벗어야 하듯, 새로운 자신으로 태어나려면 이전의 자신을 기꺼이 내려놓아야 합니다. 이 변화가 두렵게 느껴지더라도 그것은 당신을 더 아름다운 존재로 만들어줄 것입니다.','지금 무언가를 끝내야 할 시점입니다. 마음속으로는 이미 알고 있지만 차마 실행하지 못하고 있는 결단이 있을 수 있습니다. 미련을 내려놓고 깨끗하게 마무리하세요. 끝맺음의 용기가 있어야 새로운 시작의 에너지가 찾아오며, 그 새로운 시작은 지금 끝내는 것보다 훨씬 더 빛나는 것이 될 것입니다.'],
     future:['큰 변화가 찾아오지만 그것은 더 나은 미래를 위한 것입니다. 두려워하지 마세요. 앞으로 찾아올 변화는 파괴가 아니라 재건을 위한 것이며, 끝이 아니라 시작을 위한 것입니다. 겉으로는 혼란스러워 보일 수 있지만, 그 변화의 끝에서 당신은 전보다 훨씬 더 나은 상황에 서게 될 것입니다.','끝이라 생각했던 곳에서 전혀 새로운 시작이 펼쳐질 것입니다. 마지막이라 여겼던 그 순간이 사실은 새로운 이야기의 첫 페이지였음을 깨닫게 되는 날이 올 것입니다. 죽음 카드가 두려움이 아닌 희망의 메시지를 담고 있듯, 당신의 끝은 동시에 가장 아름다운 시작이 될 것입니다.','재탄생의 에너지가 당신의 삶을 완전히 새롭게 바꿀 것입니다. 마치 불사조가 잿더미에서 다시 솟아오르듯, 당신도 지금까지의 모든 경험을 양분 삼아 완전히 새로운 존재로 거듭나게 될 것입니다. 그 재탄생은 외면뿐 아니라 내면까지 변화시키며, 당신을 더 높은 차원의 삶으로 이끌 것입니다.']},
    {num:14,name:'절제',symbol:'🌊',meaning:'균형, 조화, 절도',
     past:['균형 잡힌 삶의 태도가 안정을 가져다주었습니다. 당신은 극단으로 치닫지 않고 언제나 중심을 잡으며 살아왔습니다. 일과 휴식, 열정과 이성, 자기 자신과 타인 사이에서 적절한 균형점을 찾는 당신의 지혜가 안정적인 삶의 토대를 만들어주었습니다. 그 균형의 감각이야말로 당신이 가진 가장 소중한 능력 중 하나입니다.','과하지도 부족하지도 않게 조절해온 지혜가 빛납니다. 당신은 본능적으로 어디서 멈추어야 하는지, 어디서 더 나아가야 하는지를 알고 있었습니다. 그 절제의 미덕이 당신을 수많은 위험에서 보호해주었으며, 꾸준하고 안정적인 성장을 가능하게 했습니다. 물이 두 잔 사이를 오가며 완벽한 배합을 만들어내듯, 당신의 조절 능력이 삶의 황금비율을 만들어왔습니다.','서로 다른 것을 조화시키는 능력이 많은 문제를 해결해왔습니다. 대립하는 의견들 사이에서 합의점을 찾고, 상충하는 요소들을 하나로 엮어내는 당신의 능력은 놀라울 정도입니다. 물과 불처럼 양립할 수 없어 보이는 것들도 당신의 손을 거치면 아름다운 조화를 이루었습니다. 그 조화의 능력이 주변에 평화와 안정을 가져다주었습니다.'],
     present:['극단을 피하고 중용의 길을 걸으세요. 어느 한쪽으로 지나치게 기울어지면 결국 무너지게 되어 있습니다. 열정도 좋지만 번아웃을 조심하고, 신중함도 좋지만 지나친 망설임은 피하세요. 조화가 답이며, 모든 것에서 적절한 중간 지점을 찾는 것이 지금 당신에게 가장 필요한 지혜입니다.','급하지 않게 한 걸음씩 나아가세요. 조급함은 실수를 부르고, 서두를수록 오히려 목표에서 멀어지게 됩니다. 물이 낮은 곳으로 자연스럽게 흘러가듯, 당신도 자연의 리듬에 맞춰 차분하게 걸어가세요. 느리더라도 꾸준한 걸음이 결국 가장 빠른 길임을 잊지 마세요.','다양한 요소들의 균형을 맞추면 최고의 결과가 나옵니다. 지금 당신이 다루고 있는 여러 가지 일들 사이에서 하나에만 집중하기보다 전체의 조화를 살피세요. 요리에서 양념의 균형이 맛을 결정하듯, 삶의 여러 요소들을 적절히 배합하면 최상의 결과를 만들어낼 수 있습니다.'],
     future:['인내와 절제가 원하는 결과를 이끌어낼 것입니다. 한순간의 충동이 아닌 꾸준한 절제와 인내가 당신을 원하는 목표에 도달하게 해줄 것입니다. 매일 조금씩, 과하지 않게, 그러나 멈추지 않고 나아가는 당신의 태도가 마침내 큰 성과로 결실을 맺게 됩니다. 절제의 힘을 믿고 묵묵히 걸어가세요.','조화로운 접근이 모든 일을 순조롭게 풀어줄 것입니다. 대립과 갈등 대신 화합과 조화를 선택하는 당신의 자세가 복잡하게 엉킨 문제들을 하나씩 풀어줄 것입니다. 부드러운 물이 단단한 바위를 뚫듯, 당신의 온화하고 균형 잡힌 접근법이 모든 장애물을 넘게 해줄 것입니다.','균형을 유지하면 안정적이고 지속적인 성장을 이루게 됩니다. 급격한 성장보다는 꾸준하고 안정적인 발전이 당신의 미래를 더욱 밝게 만들어줄 것입니다. 절제와 균형을 유지하는 한, 당신의 성장에는 끝이 없으며, 세월이 흘러도 무너지지 않는 견고한 성공을 이루게 될 것입니다.']},
    {num:15,name:'악마',symbol:'⛓️',meaning:'유혹, 집착, 해방',
     past:['한때 집착했던 것에서 벗어난 경험이 성장의 계기가 되었습니다. 당신을 옭아매고 있던 것이 무엇이었든, 그 사슬을 끊어낸 순간 당신은 완전히 새로운 사람이 되었습니다. 집착의 늪에서 빠져나오는 과정은 고통스러웠지만, 그 경험이 당신에게 진정한 자유의 가치를 알게 해주었습니다. 어둠을 경험한 사람만이 빛의 소중함을 진정으로 이해할 수 있습니다.','과거의 유혹에 빠졌던 경험이 지금의 분별력을 키워주었습니다. 한때 달콤한 유혹에 이끌려 위험한 길로 들어섰던 경험이 있었을 것입니다. 그때의 실수와 후회가 지금 당신에게 무엇이 진짜이고 무엇이 환상인지를 구별하는 날카로운 안목을 선물했습니다. 넘어져 본 사람만이 어디서 넘어지지 않아야 하는지를 알게 됩니다.','억눌려 있던 감정을 인정했을 때 비로소 자유를 얻었습니다. 오랫동안 외면하고 숨겨왔던 내면의 어두운 부분을 직면하는 것은 큰 용기가 필요한 일이었습니다. 하지만 그 그림자를 인정하고 받아들인 순간, 역설적으로 그것으로부터 자유로워졌습니다. 자신의 어둠을 인정할 수 있는 사람만이 진정한 빛을 향해 나아갈 수 있습니다.'],
     present:['자신을 묶고 있는 것이 무엇인지 직면하세요. 지금 당신의 삶에서 보이지 않는 사슬이 되어 당신을 옭아매고 있는 것이 있을 수 있습니다. 그것이 나쁜 습관이든, 독이 되는 관계든, 부정적인 사고방식이든 먼저 그 존재를 인정하는 것이 해방의 첫걸음입니다. 직면하는 용기를 가지면 사슬은 이미 반쯤 끊어진 것입니다.','두려움이나 집착이 당신을 가두고 있지 않은지 점검하세요. 때로 우리는 자신이 감옥에 갇혀 있다는 사실조차 모른 채 살아가기도 합니다. 편안함이라는 이름의 감옥, 두려움이라는 이름의 족쇄를 인식하는 것이 중요합니다. 지금 잠시 멈추고 당신의 삶을 객관적으로 돌아보세요. 진정으로 원하는 삶을 살고 있는지 스스로에게 물어보세요.','사슬은 생각보다 느슨합니다. 당신을 묶고 있다고 느끼는 것들은 실제보다 훨씬 약할 수 있습니다. 벗어나려는 의지만 있으면 놀라울 정도로 쉽게 풀릴 수 있습니다. 악마 카드의 사슬이 실제로는 언제든 벗을 수 있는 것이듯, 당신의 한계도 대부분은 스스로 만든 환상에 불과합니다.'],
     future:['집착을 내려놓으면 진정한 자유를 얻게 될 것입니다. 당신이 꽉 쥐고 있던 것을 놓는 순간, 그 빈 손에 훨씬 더 소중한 것이 채워질 것입니다. 집착은 가짜 안정감을 주지만 동시에 새로운 가능성을 차단합니다. 용기를 내어 놓아주면 상상하지 못했던 자유로운 삶이 당신 앞에 펼쳐질 것입니다.','속박에서 벗어나 더 넓은 세상을 경험하게 될 것입니다. 지금까지 당신의 시야를 가리고 있던 장막이 걷히면서 세상이 얼마나 넓고 아름다운지를 새롭게 발견하게 될 것입니다. 좁은 세계에 갇혀 있던 당신이 마침내 자유의 날개를 펴는 그 순간, 모든 것이 다르게 보일 것입니다.','내면의 그림자를 받아들이면 더 온전한 자신이 될 수 있습니다. 누구에게나 빛과 그림자가 공존하며, 그림자를 부정하면 오히려 그것에 지배당하게 됩니다. 자신의 모든 면을 있는 그대로 받아들일 때, 당신은 비로소 완전하고 자유로운 존재가 됩니다. 그 통합의 순간이 당신에게 전에 없던 평화를 가져다줄 것입니다.']},
    {num:16,name:'탑',symbol:'🌩️',meaning:'급변, 각성, 진실의 드러남',
     past:['예상치 못한 사건이 삶의 전환점이 되었습니다. 하늘에서 번개가 내리치듯 갑작스럽게 찾아온 변화가 당신의 삶을 완전히 뒤흔들어 놓았던 기억이 있을 것입니다. 그 순간에는 세상이 무너지는 것 같았지만, 돌이켜보면 그것은 낡은 것을 허물고 새것을 세우기 위한 필수적인 과정이었습니다. 가장 충격적인 변화가 가장 의미 있는 전환점이었음을 지금은 알 수 있습니다.','무너졌던 경험이 더 강한 기반을 세우는 계기가 되었습니다. 한때 당신이 의지하던 것들이 한꺼번에 무너져내렸을 때, 그 잔해 위에서 당신은 더 단단하고 진실된 것들을 다시 세워올렸습니다. 허울뿐인 탑이 무너진 자리에 진짜 기반이 만들어진 것입니다. 파괴 없이는 진정한 건설도 없다는 삶의 역설을 당신은 몸소 체험했습니다.','충격적인 변화가 결국 필요한 각성을 가져다주었습니다. 편안한 일상에 안주하고 있을 때, 갑작스러운 사건이 당신의 눈을 번쩍 뜨이게 해주었습니다. 그 충격이 없었다면 당신은 잘못된 길 위에서 계속 걸어갔을지도 모릅니다. 때로는 벼락 같은 각성이 인생을 올바른 방향으로 돌려놓는 가장 효과적인 방법입니다.'],
     present:['변화를 두려워하지 마세요. 지금 당신의 삶에서 흔들리고 있는 것이 있다면, 그것은 원래 불안정했던 것이 드러나는 과정일 뿐입니다. 허물어져야 새로 세울 수 있으며, 진짜가 아닌 것은 무너져야 진짜만 남게 됩니다. 파괴를 두려워하지 말고 그것을 재건의 기회로 받아들이세요.','불안정한 것은 무너져야 진짜가 남습니다. 거짓 위에 세워진 것, 허울뿐인 관계, 자기기만의 벽들이 지금 금이 가고 있을 수 있습니다. 그것이 무너지는 것을 막으려 하지 마세요. 진실을 마주하는 것이 고통스럽더라도, 그 진실 위에 다시 세우는 것만이 영원히 지속될 수 있습니다.','지금의 혼란은 더 나은 것을 세우기 위한 과정입니다. 주변이 어수선하고 혼란스럽게 느껴진다면, 그것은 우주가 당신의 삶을 재배치하고 있다는 신호입니다. 이 혼돈의 시기를 잘 견디면, 그 너머에서 전보다 훨씬 더 진실되고 안정적인 새로운 구조가 세워질 것입니다.'],
     future:['갑작스러운 변화가 오지만 결국 더 나은 상황으로 이끌 것입니다. 앞으로 예상치 못한 사건이 찾아올 수 있지만, 두려워하지 마세요. 그 변화는 겉보기에는 파괴적일 수 있지만, 실제로는 더 나은 미래를 위해 낡은 것을 치워내는 우주의 정리 작업입니다. 혼란이 지나면 더 맑고 선명한 세상이 기다리고 있습니다.','파괴 속에서 새로운 가능성이 싹틀 것입니다. 무너진 탑의 잔해 사이로 새로운 생명이 돋아나듯, 지금의 변화 속에서 전에는 상상하지 못했던 가능성이 모습을 드러낼 것입니다. 가장 큰 혁신은 종종 가장 큰 파괴 이후에 찾아오며, 당신도 그 혁신의 주인공이 될 것입니다.','예상 밖의 사건이 진정으로 중요한 것을 깨닫게 해줄 것입니다. 번개처럼 찾아오는 각성의 순간이 당신의 삶에서 무엇이 진짜 중요한지를 선명하게 보여줄 것입니다. 그 깨달음은 충격적일 수 있지만, 그것이야말로 당신의 인생을 진정으로 의미 있는 방향으로 이끌어줄 나침반이 될 것입니다.']},
    {num:17,name:'별',symbol:'⭐',meaning:'희망, 영감, 치유',
     past:['어둠 속에서도 희망을 잃지 않았던 것이 당신의 강점입니다. 모든 것이 캄캄하게 느껴졌던 그 시절에도 당신은 마음 한구석에 작은 빛을 간직하고 있었습니다. 그 꺼지지 않는 희망의 불꽃이 당신을 가장 어두운 밤을 지나 새벽까지 이끌어주었습니다. 절망 속에서도 희망을 놓지 않는 것, 그것이 당신이 가진 가장 빛나는 능력입니다.','과거에 품었던 꿈이 지금도 내면에서 빛나고 있습니다. 어린 시절 혹은 젊은 날에 간절히 품었던 꿈이 세월의 먼지 아래 묻혀 있지만 결코 사라지지 않았습니다. 그 꿈은 밤하늘의 별처럼 조용히 당신의 마음속에서 빛나고 있으며, 다시 올려다볼 용기만 있다면 그 빛이 당신의 길을 밝혀줄 것입니다.','힘든 시기를 지나며 스스로를 치유해온 회복력이 대단합니다. 깊은 상처를 입고도 다시 일어서는 당신의 회복력은 놀라운 것입니다. 폭풍이 지나간 후 다시 맑은 하늘이 펼쳐지듯, 당신은 매번 고통 속에서 스스로를 치유하며 더 강한 모습으로 돌아왔습니다. 그 치유의 힘은 당신 안에 영원히 살아 있습니다.'],
     present:['꿈과 희망을 품으세요. 지금 당신의 머리 위에 별이 빛나고 있습니다. 그 별빛은 우주가 당신에게 보내는 사랑과 축복의 신호입니다. 당신의 소원을 속삭이세요, 우주가 당신의 소원을 듣고 있습니다. 희망을 품는 것 자체가 이미 그 희망을 현실로 만드는 첫 번째 단계입니다.','영감이 샘솟는 시기입니다. 당신의 창조적 에너지가 별빛처럼 빛나고 있으며, 무엇이든 만들어낼 수 있는 영감의 시기를 맞이하고 있습니다. 글을 쓰거나, 그림을 그리거나, 음악을 만들거나, 어떤 형태든 당신의 내면을 표현해 보세요. 창작과 표현에 집중하면 영혼이 충만해지는 것을 느끼게 될 것입니다.','상처가 치유되고 있습니다. 오랫동안 당신의 마음을 아프게 했던 상처가 이제 서서히 아물기 시작하고 있습니다. 치유는 하루아침에 일어나지 않지만, 지금 당신의 내면에서는 분명히 회복의 과정이 진행되고 있습니다. 자신에게 시간을 허락하고, 별빛 아래서 조용히 치유의 에너지를 받아들이세요.'],
     future:['밝은 미래가 기다리고 있습니다. 지금은 어둡게 느껴지더라도 곧 밝아질 것입니다. 동이 트기 직전이 가장 어두운 법이며, 당신의 새벽은 이제 코앞에 와 있습니다. 희망의 빛이 가까이 있으며, 그 빛이 당신의 삶 전체를 따스하게 감싸줄 것입니다.','꿈꿔왔던 것이 현실이 되는 아름다운 시간이 올 것입니다. 오랫동안 마음속에 간직해온 꿈이 마침내 구체적인 형태를 갖추기 시작하는 시기가 다가오고 있습니다. 별에게 빌었던 소원이 응답받는 그 놀라운 순간을 기대하셔도 좋습니다. 우주는 당신의 진심 어린 꿈을 결코 외면하지 않습니다.','영감과 평화가 가득한 시기가 곧 찾아옵니다. 마음의 고요함과 창조적 에너지가 조화를 이루는 아름다운 시간이 기다리고 있습니다. 별빛처럼 은은하지만 확실한 행복이 당신의 일상을 채우게 될 것이며, 그 평화로운 시기에 당신은 삶의 진정한 아름다움을 재발견하게 될 것입니다.']},
    {num:18,name:'달',symbol:'🌕',meaning:'환상, 불안, 잠재의식',
     past:['불확실한 시기를 지나오면서 직관력이 강해졌습니다. 안개 낀 길을 걸어온 경험이 당신에게 보이지 않는 것을 감지하는 능력을 키워주었습니다. 불확실성 속에서도 방향을 잃지 않았던 것은 당신의 직관이 조용히 길을 안내해주었기 때문입니다. 그 시련의 시간이 당신의 영적 감각을 한층 더 예리하게 만들어주었습니다.','과거의 불안했던 경험이 오히려 세심한 감수성을 키워주었습니다. 불안과 두려움을 겪어본 사람만이 가질 수 있는 깊은 감수성이 당신에게 있습니다. 그 예민한 감각은 때로 고통스럽지만, 동시에 세상의 미세한 아름다움까지 감지할 수 있는 선물이기도 합니다. 어둠을 겪어본 눈이 더 작은 빛도 발견할 수 있습니다.','꿈과 상상의 세계에서 얻은 영감이 창의력의 원천이 되었습니다. 당신의 풍부한 상상력과 꿈의 세계는 현실에서는 찾을 수 없는 깊은 영감의 보고입니다. 잠재의식이 보여준 이미지들과 직감들이 당신의 창조적 작업에 독특한 깊이를 더해주었습니다. 달빛 아래 펼쳐지는 신비로운 내면의 세계가 당신만의 예술적 세계를 만들어왔습니다.'],
     present:['모든 것이 보이는 그대로가 아닐 수 있습니다. 지금 당신 앞에 펼쳐진 상황은 달빛 아래의 풍경처럼 실제와는 다르게 보일 수 있습니다. 환상과 현실을 구분하는 것이 중요하며, 성급한 판단을 내리기보다 안개가 걷힐 때까지 신중하게 기다리는 것이 현명합니다. 눈에 보이는 것 너머의 진실을 찾으려 노력하세요.','불안한 마음이 들더라도 흔들리지 마세요. 달의 에너지가 감정의 파도를 일으키고 있지만, 파도는 반드시 지나갑니다. 바다 깊은 곳은 언제나 고요하듯, 표면의 불안 아래 당신의 본질은 평화롭고 안정되어 있습니다. 감정의 물결에 떠밀리지 말고 내면의 고요한 중심을 붙잡으세요.','잠재의식이 보내는 신호에 주의를 기울이세요. 최근 반복적으로 꾸는 꿈이나, 이유 없이 떠오르는 이미지, 설명할 수 없는 느낌들은 모두 당신의 깊은 내면이 보내는 메시지입니다. 꿈이 힌트를 주며, 그 신비로운 신호들을 해독할 수 있다면 현재 상황에 대한 중요한 통찰을 얻게 될 것입니다.'],
     future:['안개가 걷히면 진실이 드러날 것입니다. 지금은 불분명하고 혼란스러운 것들이 시간이 지나면서 하나씩 선명해질 것입니다. 조금만 더 기다리면 달빛에 가려져 있던 진실이 햇빛 아래 모습을 드러낼 것입니다. 인내심을 가지고 안개가 자연스럽게 걷히기를 기다리세요.','혼란스러운 시기가 지나면 더욱 선명한 길이 보일 것입니다. 지금의 불확실함은 영원하지 않으며, 이 시기를 지나면 전보다 훨씬 더 명확한 방향성을 갖게 될 것입니다. 어둠 속을 헤매는 경험이 결국 당신에게 더 선명한 비전을 선물할 것입니다. 혼란은 더 큰 명료함을 위한 준비 과정입니다.','직관이 점점 강해져 올바른 방향을 찾게 될 것입니다. 지금 발달하고 있는 당신의 직관력이 앞으로 더욱 강해져, 어떤 복잡한 상황에서도 올바른 판단을 내릴 수 있게 될 것입니다. 달의 신비로운 에너지가 당신의 내면의 눈을 열어주며, 남들이 보지 못하는 진실을 꿰뚫어 보는 능력을 선물할 것입니다.']},
    {num:19,name:'태양',symbol:'☀️',meaning:'성공, 활력, 행복',
     past:['밝고 긍정적인 에너지가 좋은 결과를 가져다주었습니다. 당신은 태양처럼 밝은 에너지로 주변을 환하게 비추며 살아왔습니다. 그 긍정적인 마음가짐이 어려운 상황에서도 최선의 결과를 이끌어냈으며, 당신의 밝은 미소가 많은 문을 열어주었습니다. 태양의 따뜻함처럼 당신의 긍정 에너지는 닿는 곳마다 생명력을 불어넣어 왔습니다.','행복했던 순간들이 마음속에 따뜻한 빛으로 남아있습니다. 햇살 가득한 오후의 웃음소리, 사랑하는 사람과 함께한 즐거운 시간, 순수한 기쁨으로 가득했던 순간들이 당신의 마음속에 소중한 보물처럼 간직되어 있습니다. 그 따뜻한 기억들은 힘든 날에도 당신에게 힘을 주는 내면의 햇빛이 됩니다.','낙천적인 태도로 어려움을 이겨낸 경험이 빛나고 있습니다. 절망적인 상황에서도 "괜찮아질 거야"라고 말할 수 있었던 당신의 낙천성은 단순한 성격이 아니라 삶의 지혜입니다. 어둠 속에서도 빛을 찾는 당신의 태도가 실제로 빛을 불러왔으며, 그 긍정의 힘이 불가능해 보이는 상황도 가능하게 만들어왔습니다.'],
     present:['자신감을 가지세요. 지금 당신의 머리 위에 태양이 밝게 빛나고 있습니다. 모든 것이 순조롭게 흘러가고 있으며, 당신의 노력이 빛을 발하는 시기입니다. 자신의 능력을 의심하지 말고 당당하게 앞으로 나아가세요. 태양 아래 그림자가 사라지듯, 지금은 걱정과 불안을 내려놓아도 되는 시기입니다.','활력이 넘치는 시기입니다. 당신의 에너지 레벨이 최고조에 달해 있으며, 무엇이든 해낼 수 있는 힘이 충만합니다. 이 활력을 긍정적인 곳에 쏟으세요. 새로운 프로젝트를 시작하든, 운동을 하든, 사람들을 만나든 지금의 에너지는 모든 것을 성공으로 이끌 것입니다.','당신의 밝은 에너지가 주변 사람들에게도 행복을 전파하고 있습니다. 태양이 만물을 비추듯, 당신의 따뜻한 미소와 긍정적인 태도가 주변 사람들의 마음까지 밝게 만들고 있습니다. 당신이 있는 곳에 웃음이 있고, 당신이 건네는 말에 힘이 실립니다. 그 빛나는 존재감을 마음껏 발휘하세요.'],
     future:['큰 성공과 행복이 찾아올 것입니다. 오랫동안 기다려온 밝은 날이 드디어 다가오고 있습니다. 당신의 노력과 인내에 대한 보상이 태양빛처럼 화려하고 따뜻하게 찾아올 것입니다. 성공의 기쁨을 마음껏 누리고, 그 행복을 사랑하는 사람들과 함께 나누세요.','기쁨과 축복이 가득한 시기가 곧 열릴 것입니다. 우주가 당신을 위해 준비한 선물이 곧 전해질 것이며, 그 선물은 당신의 예상을 뛰어넘는 것이 될 것입니다. 감사와 기쁨으로 가득한 나날이 기다리고 있으니, 열린 마음으로 그 축복을 받아들일 준비를 하세요.','모든 노력이 빛나는 결과로 돌아오는 화려한 시간이 옵니다. 그동안 묵묵히 쌓아온 모든 것들이 태양빛 아래 찬란하게 빛나는 순간이 다가오고 있습니다. 마치 해바라기가 태양을 향해 활짝 피어나듯, 당신의 삶도 가장 아름다운 순간을 향해 열리고 있습니다. 그 빛나는 미래를 자신 있게 맞이하세요.']},
    {num:20,name:'심판',symbol:'📯',meaning:'각성, 부활, 결단',
     past:['인생의 중요한 교훈을 배우며 성장해왔습니다. 삶이 던져준 시험들 속에서 당신은 단순히 살아남은 것이 아니라, 매 순간 소중한 교훈을 얻으며 한 단계씩 성장해왔습니다. 기쁜 일에서는 감사를, 슬픈 일에서는 인내를, 실패에서는 지혜를 배운 당신은 삶의 진정한 학생이었습니다. 그 모든 교훈이 지금의 성숙한 당신을 만들어낸 소중한 재료입니다.','과거의 경험을 돌아보며 새로운 깨달음을 얻었습니다. 지나간 일들을 단순한 기억이 아닌 교훈의 관점에서 바라볼 때, 이전에는 보이지 않았던 의미와 패턴이 드러났습니다. 과거를 성찰하는 것은 후회하기 위해서가 아니라, 그 속에서 보석 같은 깨달음을 캐내기 위해서입니다. 당신은 그 성찰을 통해 더 깊은 이해에 도달해왔습니다.','결정적 순간마다 내린 결단이 지금의 당신을 형성했습니다. 인생의 갈림길에서 당신은 때로는 고통스럽지만 필요한 결단을 내려왔습니다. 그 결단들이 모여 지금 당신이라는 사람의 형태를 만들어냈습니다. 심판의 나팔 소리처럼 분명하고 되돌릴 수 없었던 그 결정들이 당신의 인생에 방향과 의미를 부여해왔습니다.'],
     present:['과거를 돌아보고 새로운 결심을 할 때입니다. 심판의 나팔이 울리고 있으며, 지금은 지나온 길을 되돌아보고 앞으로의 방향을 다시 설정하는 중요한 시점입니다. 진정으로 원하는 삶이 무엇인지, 진정한 소명이 무엇인지 자신에게 솔직하게 물어보세요. 그 대답이 당신의 새로운 출발점이 될 것입니다.','지난 일을 정리하고 새 출발을 준비하세요. 과거에 매여 있는 미완의 일들, 정리하지 못한 감정들, 끝내지 못한 관계들을 깔끔하게 마무리할 때입니다. 부활의 시간이 가까이 왔으며, 새로운 시작을 위해서는 먼저 과거의 짐을 내려놓아야 합니다. 깨끗한 마음으로 새 장을 열 준비를 하세요.','중요한 결단의 순간입니다. 더 이상 미룰 수 없는 결정이 당신 앞에 놓여 있을 수 있습니다. 머리가 아닌 영혼에게 물어보세요, 진심으로 원하는 것이 무엇인지를. 심판 카드는 진실된 자기 자신으로 돌아가라는 메시지를 담고 있으며, 그 진정한 자아의 목소리를 따르는 결단이 필요한 때입니다.'],
     future:['새로운 기회가 찾아와 인생의 새 장이 열릴 것입니다. 심판의 나팔 소리와 함께 당신의 삶에 완전히 새로운 국면이 찾아올 것입니다. 과거의 모든 경험이 이 새로운 시작을 위한 준비였음을 깨닫게 되며, 그 기회를 통해 당신은 전혀 다른 차원의 삶을 경험하게 될 것입니다.','과거의 경험이 모여 인생의 전환점을 만들게 될 것입니다. 지금까지 살아온 모든 날들이 하나의 큰 그림으로 연결되는 순간이 다가오고 있습니다. 퍼즐의 마지막 조각이 맞춰지듯, 모든 경험이 의미를 가지게 되는 위대한 전환점이 당신의 미래에 기다리고 있습니다.','각성의 순간이 오면 삶의 목적이 뚜렷해질 것입니다. 마치 깊은 잠에서 깨어나듯, 당신의 의식이 한 단계 높아지는 순간이 찾아올 것입니다. 그 각성의 순간에 삶의 진정한 목적이 번개처럼 선명하게 드러나며, 그때부터 당신은 흔들림 없는 확신 속에서 살아가게 될 것입니다.']},
    {num:21,name:'세계',symbol:'🌍',meaning:'완성, 성취, 통합',
     past:['오랜 여정의 결과가 하나의 완성으로 이어져왔습니다. 당신이 걸어온 길을 되돌아보면, 구불구불하고 때로는 막다른 골목처럼 보였던 그 길이 결국 하나의 아름다운 원을 그리며 완성되어왔음을 알 수 있습니다. 모든 경험, 모든 만남, 모든 도전이 이 완성을 위한 필수적인 조각이었습니다. 당신의 여정은 그 자체로 하나의 완벽한 작품입니다.','다양한 경험이 통합되어 풍요로운 내면을 만들어왔습니다. 기쁨과 슬픔, 성공과 실패, 사랑과 이별 등 삶의 다양한 색깔들이 당신 안에서 하나의 아름다운 무지개로 통합되어왔습니다. 어떤 경험도 헛되지 않았으며, 그 모든 것이 조화를 이루어 지금의 풍요롭고 깊이 있는 당신을 만들어냈습니다.','끊임없는 노력이 하나의 큰 성취로 모아져왔습니다. 매일매일의 작은 노력들이 눈에 띄지 않게 쌓여왔지만, 돌이켜보면 그것은 거대한 산을 이루고 있습니다. 한 걸음 한 걸음의 발자국이 모여 위대한 여정이 되었으며, 당신의 꾸준한 노력은 이제 하나의 의미 있는 성취로 결실을 맺고 있습니다.'],
     present:['모든 것이 제자리를 찾아가고 있습니다. 지금 당신의 삶에서 흩어져 있던 조각들이 하나씩 맞춰지며 완성된 그림이 나타나고 있습니다. 오랫동안 노력해온 것들이 결실을 맺고, 혼란스러웠던 것들이 질서를 찾아가고 있습니다. 성취의 기쁨을 누리세요, 당신은 그럴 자격이 있습니다.','하나의 순환이 완성되고 있습니다. 시작이 있으면 끝이 있고, 끝은 곧 새로운 시작이 됩니다. 지금 당신은 인생의 한 사이클을 마무리하는 아름다운 지점에 서 있습니다. 이 순간을 축하하세요, 그리고 다음 순환을 위한 새로운 에너지를 충전하세요.','모든 조각이 맞춰지고 있습니다. 퍼즐의 마지막 조각이 제자리를 찾듯, 당신의 삶에서도 모든 요소들이 조화를 이루며 완전한 그림을 만들어가고 있습니다. 큰 그림을 바라보세요. 가까이서는 보이지 않았던 아름다운 전체상이 한 발 물러서면 선명하게 보일 것입니다.'],
     future:['목표의 완성과 함께 더 큰 세계가 펼쳐질 것입니다. 당신이 오랫동안 추구해온 목표가 마침내 완성되는 순간이 다가오고 있습니다. 그리고 그 완성은 끝이 아니라 더 넓고 큰 세계로 나아가는 문이 될 것입니다. 하나의 산을 정복하면 더 높은 산이 보이듯, 새로운 지평이 당신 앞에 펼쳐질 것입니다.','대단원의 성취 이후 새로운 차원의 여정이 시작될 것입니다. 지금까지의 모든 노력과 경험이 하나의 위대한 성취로 결실을 맺으며, 그 성취를 발판으로 전혀 새로운 차원의 모험이 시작될 것입니다. 세계 카드는 완성인 동시에 새로운 시작이며, 당신의 가장 빛나는 순간이 아직 오지 않았음을 말해주고 있습니다.','꿈꿔왔던 완성의 순간이 다가오고 있습니다. 긴 여정의 끝에서 당신은 마침내 목표에 도달하는 감격의 순간을 맞이하게 될 것입니다. 곧 결실을 봅니다. 그 성취의 기쁨은 혼자만의 것이 아니라, 당신과 함께 걸어온 모든 이들과 나눌 수 있는 풍성한 축복이 될 것입니다.']}
  ];

  function generateTarot(userData){
    var now=new Date();var dateNum=now.getFullYear()*10000+(now.getMonth()+1)*100+now.getDate();
    var userSeed=0;
    if(userData&&userData.birthYear) userSeed=userData.birthYear*100+userData.birthMonth;
    var seed=dateNum*997+userSeed*31+7;
    var rng=fortuneSeededRandom(seed);

    var deck=[]; for(var i=0;i<22;i++) deck.push(i);
    var cards=[];
    var posFields=['past','present','future'];
    for(var j=0;j<3;j++){
      var idx=Math.floor(rng()*deck.length);
      var card=TAROT_CARDS[deck[idx]];
      var vi=Math.floor(rng()*3);
      cards.push({num:card.num,name:card.name,symbol:card.symbol,meaning:card.meaning,
        reading:card[posFields[j]][vi]});
      deck.splice(idx,1);
    }
    return cards;
  }

  function openTarotModal(){
    var loggedUser=currentUsername||annivLoggedUser;
    if(!loggedUser){
      document.getElementById('tarotContent').innerHTML=
        '<div class="tarot-login-msg">타로를 보려면<br>로그인이 필요합니다.</div>';
      document.getElementById('tarotOverlay').classList.add('visible');
      return;
    }
    var users=getUsers();
    var ud=users[loggedUser]||{};
    var cards=generateTarot(ud);
    var positions=['PAST','PRESENT','FUTURE'];
    var posKor=['과거','현재','미래'];
    var now=new Date();
    var dateStr=now.getFullYear()+'년 '+(now.getMonth()+1)+'월 '+now.getDate()+'일';

    var html='<div class="tarot-date">'+dateStr+'</div>';
    html+='<div class="tarot-spread">';
    for(var i=0;i<3;i++){
      html+='<div class="tarot-card-slot">';
      html+='<div class="tarot-card">';
      html+='<div class="tarot-card-num">'+positions[i]+'</div>';
      html+='<div class="tarot-card-symbol">'+cards[i].symbol+'</div>';
      html+='<div class="tarot-card-name">'+cards[i].name+'</div>';
      html+='</div>';
      html+='<div class="tarot-card-position">'+posKor[i]+'</div>';
      html+='</div>';
    }
    html+='</div>';
    html+='<div class="tarot-readings">';
    for(var k=0;k<3;k++){
      html+='<div class="tarot-reading-card">';
      html+='<div class="tarot-reading-header">';
      html+='<span class="tarot-reading-pos">'+posKor[k]+'</span>';
      html+='<span class="tarot-reading-name">'+cards[k].symbol+' '+cards[k].name+' — '+cards[k].meaning+'</span>';
      html+='</div>';
      html+='<div class="tarot-reading-text">'+cards[k].reading+'</div>';
      html+='</div>';
    }
    html+='</div>';
    document.getElementById('tarotContent').innerHTML=html;
    document.getElementById('tarotOverlay').classList.add('visible');
  }

  function closeTarot(){
    document.getElementById('tarotOverlay').classList.remove('visible');
  }

  function selectStation(id){
    if(!isPowered){isPowered=true;document.getElementById('powerBtn').classList.add('on');}
    var station=STATIONS.find(function(s){return s.id===id;});
    if(!station||station.empty)return;
    if(station.isFortune){openFortuneModal();return;}
    if(station.isTarot){openTarotModal();return;}
    currentStation=station;
    document.querySelectorAll('.preset-btn').forEach(function(b){b.classList.toggle('active',b.dataset.id===id);});
    document.getElementById('lcdIdle').classList.add('hidden');
    document.getElementById('lcdActive').classList.add('visible');
    document.getElementById('lcdProvider').textContent=station.provider;
    document.getElementById('lcdName').textContent=station.name;
    document.getElementById('lcdFreq').textContent=station.freq;
    document.getElementById('lcdStatusText').innerHTML='LOADING...';
    document.getElementById('antenna').classList.add('active');
    var pos=((station.freqNum-88)/20)*90+5;
    document.getElementById('tuningNeedle').style.left=pos+'%';
    updateSignalBars(true);
    resolveAndLoadStream(station);
  }

  function updateSignalBars(active){
    document.querySelectorAll('.lcd-signal-bar').forEach(function(bar,i){
      if(active) setTimeout(function(){bar.classList.add('active');},i*150);
      else bar.classList.remove('active');
    });
  }

  // === Resolve & Load Stream ===
  function resolveAndLoadStream(station){
    if(station.apiUrl){
      fetch(station.apiUrl).then(function(r){return r.json();}).then(function(data){
        if(data.channel_item&&data.channel_item[0]&&data.channel_item[0].service_url){
          station.url=data.channel_item[0].service_url;
          loadStream(station.url);
        } else { setError('스트림 URL을 가져올 수 없습니다'); setLoadingState(false); }
      }).catch(function(){setError('API 연결 실패');setLoadingState(false);});
    } else {
      loadStream(station.url);
    }
  }

  // === Audio ===
  function loadStream(url){
    setError(null); setLoadingState(true);
    if(hlsInstance){hlsInstance.destroy();hlsInstance=null;}
    if(!audio) audio=new Audio();
    initAudioContext();
    connectAudioSource();
    if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
    audio.pause(); audio.src=''; audio.volume=volume;
    if(Hls.isSupported()&&url.includes('.m3u8')){
      hlsInstance=new Hls(); hlsInstance.loadSource(url); hlsInstance.attachMedia(audio);
      hlsInstance.on(Hls.Events.MANIFEST_PARSED,function(){
        audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
        setPlayState(true);setLoadingState(false);
        document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
      });
      hlsInstance.on(Hls.Events.ERROR,function(_,data){
        if(data.fatal){setError('방송을 불러올 수 없습니다');setLoadingState(false);setPlayState(false);
        document.getElementById('lcdStatusText').innerHTML='ERROR';updateSignalBars(false);}
      });
    } else if(audio.canPlayType&&audio.canPlayType('application/vnd.apple.mpegurl')&&url.includes('.m3u8')){
      audio.src=url;
      audio.addEventListener('loadedmetadata',function h(){audio.removeEventListener('loadedmetadata',h);
        audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
        setPlayState(true);setLoadingState(false);
        document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
      });
    } else {
      audio.src=url;
      audio.addEventListener('canplay',function cp(){audio.removeEventListener('canplay',cp);
        audio.play().catch(function(e){console.error('Playback failed:',e);setPlayState(false);});
        setPlayState(true);setLoadingState(false);
        document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';
      });
      audio.addEventListener('error',function er(){audio.removeEventListener('error',er);
        setError('방송을 불러올 수 없습니다');setLoadingState(false);setPlayState(false);
        document.getElementById('lcdStatusText').innerHTML='ERROR';updateSignalBars(false);
      });
      audio.load();
    }
  }

  function togglePlay(){
    if(!audio||!currentStation)return;
    if(isPlaying){audio.pause();setPlayState(false);document.getElementById('lcdStatusText').innerHTML='PAUSED';}
    else{audio.play().catch(console.error);setPlayState(true);document.getElementById('lcdStatusText').innerHTML='<span class=\"on-air-dot\"></span>ON AIR';}
  }

  function setPlayState(playing){
    isPlaying=playing;
    document.getElementById('playIcon').style.display=(!playing&&!isLoading)?'block':'none';
    document.getElementById('pauseIcon').style.display=(playing&&!isLoading)?'block':'none';
    document.getElementById('loaderIcon').style.display=isLoading?'block':'none';
    document.getElementById('playBtn').classList.toggle('playing',playing);
    document.querySelectorAll('.eq-bar').forEach(function(b){b.classList.toggle('playing',playing);});
  }

  function setLoadingState(loading){
    isLoading=loading;
    document.getElementById('playIcon').style.display=(!isPlaying&&!loading)?'block':'none';
    document.getElementById('pauseIcon').style.display=(isPlaying&&!loading)?'block':'none';
    document.getElementById('loaderIcon').style.display=loading?'block':'none';
    document.getElementById('playBtn').disabled=loading;
  }

  function setError(msg){
    var el=document.getElementById('errorMsg');
    if(msg){el.textContent=msg;el.classList.add('visible');}
    else{el.textContent='';el.classList.remove('visible');}
  }

  // === Web Audio API - EQ / Woofer / Virtualizer ===
  var audioCtx = null;
  var sourceNode = null;
  var eqFilters = [];
  var bassBoostFilter = null;
  var virtualizerGain = null;
  var virtualizerDelay = null;
  var masterGain = null;
  var EQ_FREQS = [60, 230, 910, 3600, 14000];
  var eqValues = [0,0,0,0,0];
  var wooferValue = 0;
  var virtualizerValue = 0;

  function initAudioContext(){
    if(audioCtx) return;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // Create 5-band EQ filters
    EQ_FREQS.forEach(function(freq, i){
      var filter = audioCtx.createBiquadFilter();
      filter.type = 'peaking';
      filter.frequency.value = freq;
      filter.Q.value = 1.4;
      filter.gain.value = 0;
      eqFilters.push(filter);
    });

    // Bass boost (lowshelf)
    bassBoostFilter = audioCtx.createBiquadFilter();
    bassBoostFilter.type = 'lowshelf';
    bassBoostFilter.frequency.value = 100;
    bassBoostFilter.gain.value = 0;

    // Virtualizer (delay-based stereo widening)
    virtualizerDelay = audioCtx.createDelay(0.05);
    virtualizerDelay.delayTime.value = 0;
    virtualizerGain = audioCtx.createGain();
    virtualizerGain.gain.value = 0;

    // Master gain
    masterGain = audioCtx.createGain();
    masterGain.gain.value = 1;

    // Chain: EQ[0] → EQ[1] → ... → EQ[4] → bassBoost → masterGain → destination
    for(var i=0; i<eqFilters.length-1; i++){
      eqFilters[i].connect(eqFilters[i+1]);
    }
    eqFilters[eqFilters.length-1].connect(bassBoostFilter);
    bassBoostFilter.connect(masterGain);

    // Virtualizer: parallel path with delay
    bassBoostFilter.connect(virtualizerDelay);
    virtualizerDelay.connect(virtualizerGain);
    virtualizerGain.connect(masterGain);

    masterGain.connect(audioCtx.destination);

    // Restore saved settings
    restoreEQSettings();
  }

  function connectAudioSource(){
    if(!audio || !audioCtx || sourceNode) return;
    try {
      sourceNode = audioCtx.createMediaElementSource(audio);
      sourceNode.connect(eqFilters[0]);
    } catch(e) { console.log('Audio source already connected'); }
  }

  function updateEQ(band, val){
    val = parseFloat(val);
    eqValues[band] = val;
    if(eqFilters[band]) eqFilters[band].gain.value = val;
    var label = document.getElementById('eqDb'+band);
    if(label) label.textContent = (val>0?'+':'')+val;
    saveEQSettings();
  }

  function updateWoofer(val){
    wooferValue = parseFloat(val);
    if(bassBoostFilter) bassBoostFilter.gain.value = wooferValue;
    document.getElementById('wooferValue').textContent = val;
    saveEQSettings();
  }

  function updateVirtualizer(val){
    virtualizerValue = parseFloat(val);
    if(virtualizerDelay) virtualizerDelay.delayTime.value = (virtualizerValue / 100) * 0.025;
    if(virtualizerGain) virtualizerGain.gain.value = virtualizerValue / 100 * 0.6;
    document.getElementById('virtualizerValue').textContent = val;
    saveEQSettings();
  }

  function resetEQ(){
    eqValues = [0,0,0,0,0];
    wooferValue = 0; virtualizerValue = 0;
    eqFilters.forEach(function(f,i){ f.gain.value = 0; });
    if(bassBoostFilter) bassBoostFilter.gain.value = 0;
    if(virtualizerDelay) virtualizerDelay.delayTime.value = 0;
    if(virtualizerGain) virtualizerGain.gain.value = 0;
    // Reset UI
    document.querySelectorAll('.eq-slider-wrap input').forEach(function(s){ s.value = 0; });
    for(var i=0;i<5;i++){ var l=document.getElementById('eqDb'+i); if(l) l.textContent='0'; }
    document.getElementById('wooferSlider').value = 0;
    document.getElementById('wooferValue').textContent = '0';
    document.getElementById('virtualizerSlider').value = 0;
    document.getElementById('virtualizerValue').textContent = '0';
    saveEQSettings();
  }

  function toggleEqPanel(){
    var panel = document.getElementById('eqPanel');
    var btn = document.getElementById('eqToggleBtn');
    var visible = panel.style.display !== 'none';
    panel.style.display = visible ? 'none' : 'block';
    btn.classList.toggle('active', !visible);
  }

  function saveEQSettings(){
    try {
      localStorage.setItem('radio-eq', JSON.stringify({
        eq: eqValues, woofer: wooferValue, virtualizer: virtualizerValue
      }));
    } catch(e){}
  }

  function restoreEQSettings(){
    try {
      var saved = JSON.parse(localStorage.getItem('radio-eq'));
      if(!saved) return;
      if(saved.eq){
        saved.eq.forEach(function(v,i){
          eqValues[i] = v;
          if(eqFilters[i]) eqFilters[i].gain.value = v;
          var slider = document.querySelector('.eq-slider-wrap input[data-eq="'+i+'"]');
          if(slider) slider.value = v;
          var label = document.getElementById('eqDb'+i);
          if(label) label.textContent = (v>0?'+':'')+v;
        });
      }
      if(saved.woofer !== undefined){
        wooferValue = saved.woofer;
        if(bassBoostFilter) bassBoostFilter.gain.value = wooferValue;
        document.getElementById('wooferSlider').value = wooferValue;
        document.getElementById('wooferValue').textContent = wooferValue;
      }
      if(saved.virtualizer !== undefined){
        virtualizerValue = saved.virtualizer;
        updateVirtualizer(virtualizerValue);
        document.getElementById('virtualizerSlider').value = virtualizerValue;
      }
    } catch(e){}
  }

  // === Photo Selection Screen & Placement ===
  var DEFAULT_PHOTOS = ['maltese.jpg','photo1.jpg','photo2.jpg','photo5.jpg','photo3.jpg','photo4.jpg'];
  var slotPhotos = [null,null,null,null,null,null];
  var activeSlotIdx = -1;

  function pickSlotPhoto(idx){
    activeSlotIdx = idx;
    var inp = document.getElementById('slotFileInput');
    inp.value = '';
    inp.onchange = function(){
      if(!this.files||!this.files[0]) return;
      var reader = new FileReader();
      reader.onload = function(e){
        slotPhotos[activeSlotIdx] = e.target.result;
        updateSlotUI(activeSlotIdx);
        updatePhotoCount();
      };
      reader.readAsDataURL(this.files[0]);
    };
    inp.click();
  }

  function removeSlotPhoto(idx, evt){
    evt.stopPropagation();
    slotPhotos[idx] = null;
    updateSlotUI(idx);
    updatePhotoCount();
  }

  function updateSlotUI(idx){
    var slot = document.querySelectorAll('.photo-slot')[idx];
    if(!slot) return;
    if(slotPhotos[idx]){
      slot.classList.add('filled');
      var labels = ['상단 1','상단 2','상단 3','상단 4','하단 좌','하단 우'];
      slot.innerHTML = '<img src="'+slotPhotos[idx]+'" alt="사진'+(idx+1)+'">' +
        '<button class="remove-photo" onclick="removeSlotPhoto('+idx+',event)">&times;</button>' +
        '<div class="slot-label">'+labels[idx]+'</div>';
    } else {
      slot.classList.remove('filled');
      var labels = ['상단 1','상단 2','상단 3','상단 4','하단 좌','하단 우'];
      slot.innerHTML = '<span class="slot-icon">+</span><div class="slot-label">'+labels[idx]+'</div>';
    }
  }

  function pickAllPhotos(){
    var inp = document.getElementById('batchFileInput');
    inp.value = '';
    inp.onchange = function(){
      if(!this.files||this.files.length===0) return;
      var files = Array.from(this.files).slice(0,6);
      var loaded = 0;
      files.forEach(function(file, i){
        var reader = new FileReader();
        reader.onload = function(e){
          slotPhotos[i] = e.target.result;
          updateSlotUI(i);
          loaded++;
          if(loaded === files.length){
            // 6장 미만이면 나머지 슬롯 비움
            for(var j=files.length; j<6; j++){
              slotPhotos[j] = null;
              updateSlotUI(j);
            }
            updatePhotoCount();
          }
        };
        reader.readAsDataURL(file);
      });
    };
    inp.click();
  }

  function resetPhotos(){
    for(var i=0; i<6; i++){
      slotPhotos[i] = null;
      updateSlotUI(i);
    }
    updatePhotoCount();
  }

  function updatePhotoCount(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    document.getElementById('photoCount').textContent = count + ' / 6';
    var modeRow = document.getElementById('modeSelectRow');
    var saveBtn = document.getElementById('photoSaveBtn');
    if(count === 6) {
      modeRow.classList.add('ready');
      saveBtn.classList.add('ready');
    } else {
      modeRow.classList.remove('ready');
      saveBtn.classList.remove('ready');
    }
  }

  // === 사용자 로그인 ===
  var currentUsername = '';
  var selectedUser = '';

  // === About Modal ===
  function showAbout(e){
    if(e) e.preventDefault();
    document.getElementById('aboutModal').classList.add('visible');
  }
  function hideAbout(e){
    if(e && e.target !== document.getElementById('aboutModal')) return;
    document.getElementById('aboutModal').classList.remove('visible');
  }

  var cachedUsers = null;

  function getUsers(){
    if(cachedUsers) return cachedUsers;
    return {};
  }

  async function loadUsersFromCloud(){
    try {
      var { data, error } = await supabase.storage.from(BUCKET_NAME).download('_system/users.json');
      if(data){
        var text = await data.text();
        var users = JSON.parse(text);
        cachedUsers = users;
        return users;
      }
    } catch(e){ console.log('클라우드 사용자 로드 실패:', e); }
    cachedUsers = {};
    return {};
  }

  async function saveUsersToCloud(users){
    try {
      var blob = new Blob([JSON.stringify(users)], {type: 'application/json'});
      await supabase.storage.from(BUCKET_NAME).upload('_system/users.json', blob, { upsert: true });
    } catch(e){ console.log('클라우드 사용자 저장 실패:', e); }
  }

  function renderUserList(filter){
    var users = getUsers();
    var userNames = Object.keys(users);
    var listEl = document.getElementById('userList');

    // 필터 적용
    if(filter && filter.trim()){
      var keyword = filter.trim().toLowerCase();
      userNames = userNames.filter(function(name){
        return name.toLowerCase().indexOf(keyword) !== -1;
      });
    }

    if(userNames.length === 0){
      var msg = filter ? '검색 결과가 없습니다' : '등록된 사용자가 없습니다';
      listEl.innerHTML = '<div class="no-users">' + msg + '</div>';
    } else {
      listEl.innerHTML = '';
      userNames.forEach(function(name){
        var item = document.createElement('div');
        item.className = 'user-item';
        item.innerHTML = '<span class="user-item-icon">👤</span><span class="user-item-name">' + name + '</span>';
        item.onclick = function(){ selectUser(name); };
        listEl.appendChild(item);
      });
    }
  }

  function filterUsers(){
    var searchInput = document.getElementById('userSearchInput');
    renderUserList(searchInput.value);
  }

  function selectUser(name){
    selectedUser = name;
    document.getElementById('selectedUserName').textContent = name;
    document.getElementById('userSelectBox').classList.add('hidden');
    document.getElementById('passwordBox').classList.remove('hidden');
    document.getElementById('passwordInput').value = '';
    document.getElementById('passwordInput').focus();
  }

  function showUserSelect(){
    document.getElementById('userSelectBox').classList.remove('hidden');
    document.getElementById('passwordBox').classList.add('hidden');
    document.getElementById('newUserBox').classList.add('hidden');
    document.getElementById('userSearchInput').value = '';
    renderUserList();
  }

  function showNewUserForm(){
    document.getElementById('userSelectBox').classList.add('hidden');
    document.getElementById('newUserBox').classList.remove('hidden');
    document.getElementById('newUsernameInput').value = '';
    document.getElementById('newEmailInput').value = '';
    document.getElementById('newPasswordInput').value = '';
    document.getElementById('newUsernameInput').focus();
  }

  function getUserPassword(userData){
    if(typeof userData === 'string') return userData;
    if(userData && userData.password) return userData.password;
    return '';
  }

  function submitPassword(){
    var passInput = document.getElementById('passwordInput');
    var pass = passInput.value.trim();

    if(!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)){
      alert('비밀번호 4자리 숫자를 입력해주세요.');
      passInput.focus();
      return;
    }

    var users = getUsers();
    if(getUserPassword(users[selectedUser]) !== pass){
      alert('비밀번호가 일치하지 않습니다.');
      passInput.value = '';
      passInput.focus();
      return;
    }

    currentUsername = selectedUser;
    localStorage.setItem('radioUsername', selectedUser);

    document.getElementById('userLoginScreen').classList.add('hidden');
    document.getElementById('photoSelectScreen').classList.remove('hidden');
  }

  async function registerNewUser(){
    var nameInput = document.getElementById('newUsernameInput');
    var emailInput = document.getElementById('newEmailInput');
    var passInput = document.getElementById('newPasswordInput');
    var birthYearInput = document.getElementById('newBirthYear');
    var birthMonthInput = document.getElementById('newBirthMonth');
    var birthDayInput = document.getElementById('newBirthDay');
    var name = nameInput.value.trim();
    var email = emailInput.value.trim();
    var pass = passInput.value.trim();
    var birthYear = parseInt(birthYearInput.value);
    var birthMonth = parseInt(birthMonthInput.value);
    var birthDay = parseInt(birthDayInput.value);
    var birthCalendar = document.querySelector('input[name="birthCalendar"]:checked').value;
    var gender = document.querySelector('input[name="userGender"]:checked').value;

    if(!name){
      alert('닉네임을 입력해주세요.');
      nameInput.focus();
      return;
    }
    if(!email){
      alert('이메일을 입력해주세요.');
      emailInput.focus();
      return;
    }
    if(!birthYear || birthYear < 1920 || birthYear > 2010){
      alert('출생연도를 정확히 입력해주세요. (1920~2010)');
      birthYearInput.focus();
      return;
    }
    if(!birthMonth || birthMonth < 1 || birthMonth > 12){
      alert('출생월을 정확히 입력해주세요. (1~12)');
      birthMonthInput.focus();
      return;
    }
    if(!birthDay || birthDay < 1 || birthDay > 31){
      alert('출생일을 정확히 입력해주세요. (1~31)');
      birthDayInput.focus();
      return;
    }
    if(!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)){
      alert('비밀번호 4자리 숫자를 입력해주세요.');
      passInput.focus();
      return;
    }

    var users = getUsers();
    if(users[name]){
      alert('이미 등록된 사용자입니다.');
      return;
    }

    users[name] = { password: pass, email: email, birthYear: birthYear, birthMonth: birthMonth, birthDay: birthDay, birthCalendar: birthCalendar, gender: gender };
    cachedUsers = users;
    await saveUsersToCloud(users);

    currentUsername = name;
    localStorage.setItem('radioUsername', name);

    document.getElementById('userLoginScreen').classList.add('hidden');
    document.getElementById('photoSelectScreen').classList.remove('hidden');
  }

  // Enter 키로 제출 및 숫자만 입력
  document.addEventListener('DOMContentLoaded', function(){
    var passInput = document.getElementById('passwordInput');
    var newPassInput = document.getElementById('newPasswordInput');

    [passInput, newPassInput].forEach(function(input){
      if(input){
        input.addEventListener('input', function(){
          this.value = this.value.replace(/[^0-9]/g, '');
        });
      }
    });

    if(passInput){
      passInput.addEventListener('keypress', function(e){
        if(e.key === 'Enter') submitPassword();
      });
    }
    if(newPassInput){
      newPassInput.addEventListener('keypress', function(e){
        if(e.key === 'Enter') registerNewUser();
      });
    }

    // 오래된 localStorage 사용자 캐시 정리
    try { localStorage.removeItem('radioUsers'); } catch(e){}

    // 아날로그→디지털 전환 또는 리프레시(F5)인 경우 자동 복원
    var urlParams = new URLSearchParams(location.search);
    var modeDigital = urlParams.get('mode') === 'digital';
    var dashboardUser = urlParams.get('dashboard');
    var navEntries = performance.getEntriesByType && performance.getEntriesByType('navigation');
    var isReload = (navEntries && navEntries[0] && navEntries[0].type === 'reload') ||
                   (performance.navigation && performance.navigation.type === 1);
    if(modeDigital || dashboardUser || isReload){
      var savedUser = dashboardUser || localStorage.getItem('radioUsername');
      var savedPhotos = null;
      try { savedPhotos = JSON.parse(localStorage.getItem('radioUserPhotos')); } catch(e){}

      if(savedUser && savedPhotos && Array.isArray(savedPhotos) && savedPhotos.filter(function(p){return p!==null;}).length >= 6){
        currentUsername = savedUser;
        slotPhotos = savedPhotos;
        document.getElementById('userLoginScreen').classList.add('hidden');
        showRadioScreen(savedPhotos);
      } else if(savedUser){
        currentUsername = savedUser;
        document.getElementById('userLoginScreen').classList.add('hidden');
        document.getElementById('photoSelectScreen').classList.remove('hidden');
      }

      // 관리자에서 사용자 대시보드 열기
      if(dashboardUser){
        annivLoggedUser = dashboardUser;
        var waitDash = setInterval(function(){
          if(supabase){
            clearInterval(waitDash);
            openDashboard();
          }
        }, 200);
      }
    }

    // Supabase 초기화 대기 후 사용자 목록 로드
    var waitInit = setInterval(function(){
      if(supabase){
        clearInterval(waitInit);
        loadUsersFromCloud().then(function(){
          renderUserList();
        });
      }
    }, 100);
  });

  // === 한글을 안전한 경로로 변환 ===
  function toSafePath(str){
    return str.split('').map(function(c){
      var code = c.charCodeAt(0);
      if((code >= 48 && code <= 57) || (code >= 65 && code <= 90) || (code >= 97 && code <= 122) || c === '-' || c === '_'){
        return c;
      }
      return '_' + code.toString(16) + '_';
    }).join('');
  }
  function fromSafePath(str){
    return str.replace(/_([0-9a-f]+)_/gi, function(m, hex){
      return String.fromCharCode(parseInt(hex, 16));
    });
  }

  // === Supabase 설정 ===
  var SUPABASE_URL = 'https://haxcktfnuudlqciyljtp.supabase.co';
  var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhheGNrdGZudXVkbHFjaXlsanRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDUwNDAsImV4cCI6MjA4NDg4MTA0MH0.suN7BeaHx3MjaNlMDQa0940P-rMl2XPyk4ksoQEU3YM';
  var supabase;
  var BUCKET_NAME = 'photo-albums';

  // base64를 Blob으로 변환
  function dataURLtoBlob(dataURL) {
    var arr = dataURL.split(',');
    var mime = arr[0].match(/:(.*?);/)[1];
    var bstr = atob(arr[1]);
    var n = bstr.length;
    var u8arr = new Uint8Array(n);
    while(n--) u8arr[n] = bstr.charCodeAt(n);
    return new Blob([u8arr], {type: mime});
  }

  // === 사진첩 API (Supabase) ===
  async function savePhotosToAlbum(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    if(count < 6) {
      alert('6장의 사진을 모두 선택해주세요.');
      return;
    }

    var albumName = prompt('사진첩 이름을 입력하세요:', '');
    if(!albumName || !albumName.trim()) return;
    albumName = albumName.trim();

    try {
      for(var i = 0; i < 6; i++){
        var dataUrl = slotPhotos[i];
        var mimeMatch = dataUrl.match(/data:(image\/\w+);/);
        var ext = 'jpg';
        if(mimeMatch && mimeMatch[1]){
          var mime = mimeMatch[1];
          if(mime === 'image/png') ext = 'png';
          else if(mime === 'image/gif') ext = 'gif';
          else if(mime === 'image/webp') ext = 'webp';
        }
        var fileName = toSafePath(currentUsername) + '/' + toSafePath(albumName) + '/photo_' + (i + 1) + '.' + ext;
        var blob = dataURLtoBlob(dataUrl);

        var { error } = await supabase.storage
          .from(BUCKET_NAME)
          .upload(fileName, blob, { upsert: true });

        if(error) throw error;
      }

      alert('사진첩 "' + albumName + '"에 6장의 사진이 저장되었습니다!');
    } catch(e) {
      console.error(e);
      alert('저장 중 오류가 발생했습니다: ' + e.message);
    }
  }

  async function showAlbumList(){
    try {
      // 현재 사용자의 폴더에서 사진첩 목록 가져오기
      var encodedUser = toSafePath(currentUsername);
      var { data, error } = await supabase.storage
        .from(BUCKET_NAME)
        .list(encodedUser, { limit: 100 });

      if(error) throw error;

      // 폴더(사진첩) 목록 추출
      var albumMap = {};
      for(var i = 0; i < data.length; i++){
        var item = data[i];
        if(item.name && !item.id) {
          // 폴더인 경우 - 디코딩해서 표시
          var decodedName = fromSafePath(item.name);
          albumMap[item.name] = { name: item.name, displayName: decodedName, count: 0 };
        }
      }

      // 각 폴더의 파일 개수 확인
      var albumNames = Object.keys(albumMap);
      for(var j = 0; j < albumNames.length; j++){
        var name = albumNames[j];
        var { data: files } = await supabase.storage
          .from(BUCKET_NAME)
          .list(encodedUser + '/' + name, { limit: 10 });
        if(files) albumMap[name].count = files.length;
      }

      var albums = Object.values(albumMap).filter(function(a){ return a.count > 0; });

      var popup = document.getElementById('albumListPopup');
      var content = document.getElementById('albumListContent');

      if(albums.length === 0){
        content.innerHTML = '<div class="album-list-empty">저장된 사진첩이 없습니다.<br>먼저 사진을 저장해주세요.</div>';
      } else {
        content.innerHTML = '';
        albums.forEach(function(album){
          var item = document.createElement('div');
          item.className = 'album-item';
          item.innerHTML = '<span class="album-item-icon">📁</span>' +
            '<span class="album-item-name">' + album.displayName + '</span>' +
            '<span class="album-item-count">' + album.count + '장</span>';
          item.onclick = function(){ loadAlbum(album.name); };

          var delBtn = document.createElement('button');
          delBtn.className = 'album-item-delete';
          delBtn.innerHTML = '&times;';
          delBtn.title = '삭제';
          delBtn.onclick = function(e){
            e.stopPropagation();
            deleteAlbum(album.name, album.displayName);
          };
          item.appendChild(delBtn);

          content.appendChild(item);
        });
      }

      popup.classList.add('visible');
    } catch(e) {
      console.error(e);
      alert('사진첩 목록을 불러오는 중 오류가 발생했습니다: ' + e.message);
    }
  }

  function hideAlbumList(){
    document.getElementById('albumListPopup').classList.remove('visible');
  }

  async function deleteAlbum(albumName, displayName){
    if(!confirm('"' + displayName + '" 사진첩을 삭제하시겠습니까?')) return;
    try {
      var userAlbumPath = toSafePath(currentUsername) + '/' + albumName;
      var { data: files, error } = await supabase.storage
        .from(BUCKET_NAME)
        .list(userAlbumPath, { limit: 100 });
      if(error) throw error;
      if(files && files.length > 0){
        var filePaths = files.map(function(f){ return userAlbumPath + '/' + f.name; });
        var { error: removeError } = await supabase.storage
          .from(BUCKET_NAME)
          .remove(filePaths);
        if(removeError) throw removeError;
      }
      alert('"' + displayName + '" 사진첩이 삭제되었습니다.');
      showAlbumList();
    } catch(e) {
      console.error(e);
      alert('삭제 중 오류가 발생했습니다: ' + e.message);
    }
  }

  async function loadAlbum(albumName){
    try {
      var userAlbumPath = toSafePath(currentUsername) + '/' + albumName;
      var { data: files, error } = await supabase.storage
        .from(BUCKET_NAME)
        .list(userAlbumPath, { limit: 10 });

      if(error) throw error;

      // photo_1, photo_2 순으로 정렬
      files.sort(function(a, b){
        var matchA = a.name.match(/photo_(\d+)/i);
        var matchB = b.name.match(/photo_(\d+)/i);
        if(matchA && matchB) return parseInt(matchA[1]) - parseInt(matchB[1]);
        return a.name.localeCompare(b.name);
      });

      var imageFiles = files.filter(function(f){
        return /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name);
      }).slice(0, 6);

      if(imageFiles.length === 0){
        alert('사진첩에 이미지 파일이 없습니다.');
        return;
      }

      // 슬롯 초기화
      slotPhotos = [null, null, null, null, null, null];

      // 파일 로드
      for(var i = 0; i < imageFiles.length; i++){
        var filePath = userAlbumPath + '/' + imageFiles[i].name;
        var { data } = supabase.storage
          .from(BUCKET_NAME)
          .getPublicUrl(filePath);

        // 이미지를 dataURL로 변환
        var response = await fetch(data.publicUrl);
        var blob = await response.blob();
        var dataUrl = await new Promise(function(resolve){
          var reader = new FileReader();
          reader.onload = function(e){ resolve(e.target.result); };
          reader.readAsDataURL(blob);
        });

        slotPhotos[i] = dataUrl;
        updateSlotUI(i);
      }

      // 나머지 슬롯 초기화
      for(var j = imageFiles.length; j < 6; j++){
        updateSlotUI(j);
      }

      updatePhotoCount();
      hideAlbumList();
      alert('사진첩 "' + albumName + '"에서 ' + imageFiles.length + '장을 불러왔습니다!');
    } catch(e) {
      console.error(e);
      alert('불러오기 중 오류가 발생했습니다: ' + e.message);
    }
  }

  function completePhotoSelect(){
    var count = slotPhotos.filter(function(p){return p!==null;}).length;
    if(count < 6) return;
    try{ localStorage.setItem('radioUserPhotos', JSON.stringify(slotPhotos)); }catch(e){}
    showRadioScreen(slotPhotos);
  }


  function showRadioScreen(photos){
    var screen = document.getElementById('photoSelectScreen');
    screen.classList.add('hiding');
    setTimeout(function(){
      screen.classList.add('hidden');
    }, 500);
    // 디지털 화면 보이기
    document.getElementById('radioBody').style.display='';
    document.getElementById('themeName').style.display='';
    renderUserPhotos(photos);
    // [+] 버튼 표시
    document.getElementById('photoUploadBtn').classList.add('has-photos');
    // 기념일 자동 로그인: 메인 로그인 사용자 자동 연결
    if (currentUsername) {
      annivLoggedUser = currentUsername;
      var localAnniv = [];
      try {
        var saved = JSON.parse(localStorage.getItem('radio-anniversaries'));
        if (saved && Array.isArray(saved)) localAnniv = saved;
      } catch(e) {}

      // 클라우드에서 직접 로드 (localStorage 폴백 없이)
      (async function(){
        var cloudData = [];
        try {
          var r = await supabase.storage.from(BUCKET_NAME).download(
            '_system/anniversaries/' + toSafePath(currentUsername) + '.json'
          );
          if (r.data) {
            var arr = JSON.parse(await r.data.text());
            if (Array.isArray(arr) && arr.length > 0) cloudData = arr;
          }
        } catch(e) {}

        if (cloudData.length > 0) {
          anniversaries = cloudData;
        } else if (localAnniv.length > 0) {
          anniversaries = localAnniv;
          await saveAnniversariesToCloud();
        }
        try { localStorage.setItem('radio-anniversaries', JSON.stringify(anniversaries)); } catch(e) {}
        updateAnnivUI();
        renderAnniversaries();
      })();
    }
  }

  function reopenPhotoSelect(){
    // 사진 선택 화면 다시 열기
    slotPhotos = [null,null,null,null,null,null];
    var screen = document.getElementById('photoSelectScreen');
    screen.classList.remove('hidden','hiding');
    // 슬롯 UI 초기화
    for(var i=0;i<6;i++) updateSlotUI(i);
    updatePhotoCount();
  }

  function renderUserPhotos(photos){
    var bp=document.getElementById('brandPhotos');
    bp.innerHTML='';
    for(var i=0;i<4&&i<photos.length;i++){
      var img=document.createElement('img');
      img.className='brand-mascot';
      img.style.display='block';
      img.src=photos[i]; img.alt='사진'+(i+1);
      img.width=34; img.height=34;
      img.style.cursor='pointer';
      img.onclick=(function(s){return function(){openLightbox(s)}})(photos[i]);
      bp.appendChild(img);
    }
    var cl=document.getElementById('ctrlPhotoLeft');
    cl.innerHTML='';
    if(photos.length>4){
      var il=document.createElement('img');
      il.className='ctrl-mascot';
      il.style.display='block';
      il.src=photos[4]; il.alt='사진5';
      il.style.cursor='pointer';
      il.onclick=(function(s){return function(){openLightbox(s)}})(photos[4]);
      cl.appendChild(il);
    }
    var cr=document.getElementById('ctrlPhotoRight');
    cr.innerHTML='';
    if(photos.length>5){
      var ir=document.createElement('img');
      ir.className='ctrl-mascot';
      ir.style.display='block';
      ir.src=photos[5]; ir.alt='사진6';
      ir.style.cursor='pointer';
      ir.onclick=(function(s){return function(){openLightbox(s)}})(photos[5]);
      cr.appendChild(ir);
    }
  }

  function loadSavedPhotos(){
    // 항상 사진 선택 화면을 먼저 표시
    // 저장된 사진이 있으면 슬롯에 미리 채워둠
    try{
      var saved=localStorage.getItem('radioUserPhotos');
      if(saved){
        var photos = JSON.parse(saved);
        slotPhotos = photos.slice();
        for(var i=0;i<6;i++) updateSlotUI(i);
        updatePhotoCount();
      }
    }catch(e){}
    renderUserPhotos(DEFAULT_PHOTOS);
    document.getElementById('photoUploadBtn').classList.add('has-photos');
  }

  // === Photo Lightbox ===
  function openLightbox(src){
    var lb=document.getElementById('photoLightbox');
    document.getElementById('lightboxImg').src=src;
    lb.classList.add('visible');
  }
  function closeLightbox(){
    document.getElementById('photoLightbox').classList.remove('visible');
  }

  // === Volume Knob ===
  function setupKnobDrag(){
    var knob=document.getElementById('volumeKnob');
    var container=document.getElementById('knobContainer');
    var isDragging=false;
    function getAngle(e){
      var r=container.getBoundingClientRect();
      var cx=r.left+r.width/2, cy=r.top+r.height/2;
      var x=e.touches?e.touches[0].clientX:e.clientX;
      var y=e.touches?e.touches[0].clientY:e.clientY;
      return Math.atan2(y-cy,x-cx)*(180/Math.PI)+90;
    }
    function handleMove(e){
      if(!isDragging)return; e.preventDefault();
      var a=getAngle(e); if(a>180)a-=360;
      knobAngle=Math.max(-135,Math.min(135,a));
      volume=(knobAngle+135)/270;
      if(audio)audio.volume=volume;
      updateKnobVisual();
    }
    knob.addEventListener('mousedown',function(e){isDragging=true;e.preventDefault();});
    knob.addEventListener('touchstart',function(){isDragging=true;},{passive:true});
    document.addEventListener('mousemove',handleMove);
    document.addEventListener('touchmove',handleMove,{passive:false});
    document.addEventListener('mouseup',function(){isDragging=false;});
    document.addEventListener('touchend',function(){isDragging=false;});
    container.addEventListener('wheel',function(e){
      e.preventDefault();
      volume=Math.max(0,Math.min(1,volume+(e.deltaY>0?-0.05:0.05)));
      knobAngle=-135+(volume*270);
      if(audio)audio.volume=volume;
      updateKnobVisual();
    },{passive:false});
  }

  function updateKnobVisual(){
    document.getElementById('volumeKnob').style.transform='rotate('+knobAngle+'deg)';
  }

  // === Anniversary ===
  var anniversaries = [];
  var annivLoggedUser = null;
  var annivUsersCache = null;

  async function loadAnnivUsers() {
    if (annivUsersCache) return annivUsersCache;
    try {
      var r = await supabase.storage.from(BUCKET_NAME).download('_system/users.json');
      if (r.data) {
        annivUsersCache = JSON.parse(await r.data.text());
        return annivUsersCache;
      }
    } catch(e) {}
    return {};
  }

  async function saveAnniversariesToCloud() {
    if (!annivLoggedUser) return;
    try {
      var blob = new Blob([JSON.stringify(anniversaries)], { type: 'application/json' });
      var result = await supabase.storage.from(BUCKET_NAME).upload(
        '_system/anniversaries/' + toSafePath(annivLoggedUser) + '.json', blob, { upsert: true }
      );
      if(result.error) console.log('기념일 클라우드 저장 실패:', result.error.message);
    } catch(e) { console.log('기념일 클라우드 저장 예외:', e); }
  }

  async function loadAnniversariesFromCloud(nickname) {
    try {
      var r = await supabase.storage.from(BUCKET_NAME).download(
        '_system/anniversaries/' + toSafePath(nickname) + '.json'
      );
      if (r.data) {
        var arr = JSON.parse(await r.data.text());
        if (Array.isArray(arr) && arr.length > 0) return arr;
      }
    } catch(e) {}
    // 클라우드 데이터가 없으면 로컬 데이터 확인
    try {
      var local = JSON.parse(localStorage.getItem('radio-anniversaries'));
      if (local && Array.isArray(local) && local.length > 0) {
        return local;
      }
    } catch(e) {}
    return [];
  }

  async function loginAnniversary() {
    var nickEl = document.getElementById('annivNickInput');
    var passEl = document.getElementById('annivPassInput');
    var nick = nickEl.value.trim();
    var pass = passEl.value.trim();
    if (!nick) { alert('닉네임을 입력하세요.'); nickEl.focus(); return; }
    if (!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)) {
      alert('비밀번호 4자리 숫자를 입력하세요.'); passEl.focus(); return;
    }
    var users = await loadAnnivUsers();
    var userData = users[nick];
    if (!userData) { alert('등록되지 않은 사용자입니다.'); nickEl.focus(); return; }
    var storedPass = typeof userData === 'string' ? userData : (userData.password || '');
    if (storedPass !== pass) { alert('비밀번호가 일치하지 않습니다.'); passEl.value = ''; passEl.focus(); return; }
    annivLoggedUser = nick;
    anniversaries = await loadAnniversariesFromCloud(nick);
    try { localStorage.setItem('radio-anniversaries', JSON.stringify(anniversaries)); } catch(e) {}
    updateAnnivUI();
    renderAnniversaries();
    openDashboard();
  }

  function logoutAnniversary() {
    annivLoggedUser = null;
    anniversaries = [];
    try { var saved = JSON.parse(localStorage.getItem('radio-anniversaries'));
      if (saved && Array.isArray(saved)) anniversaries = saved; } catch(e) {}
    updateAnnivUI();
    renderAnniversaries();
  }

  function updateAnnivUI() {
    var userRow = document.getElementById('annivUserRow');
    var bdayInfo = document.getElementById('annivBirthdayInfo');
    if (annivLoggedUser) {
      if(userRow) userRow.classList.remove('hidden');
      var nameEl = document.getElementById('annivUserName');
      if(nameEl) nameEl.textContent = annivLoggedUser + '님';
      renderBirthdayInfo();
    } else {
      if(userRow) userRow.classList.add('hidden');
      if(bdayInfo) bdayInfo.classList.remove('visible');
    }
  }

  function renderBirthdayInfo(){
    var loggedUser = currentUsername || annivLoggedUser;
    if(!loggedUser) return;
    var users = getUsers();
    var ud = users[loggedUser];
    if(!ud || !ud.birthYear) return;

    var by=ud.birthYear, bm=ud.birthMonth, bd=ud.birthDay, bc=ud.birthCalendar;
    var now=new Date(); var today=new Date(now.getFullYear(),now.getMonth(),now.getDate());

    // 올해 생일 양력 날짜 계산
    var thisYearBday;
    var bdayLabel;
    if(bc==='lunar'){
      var solar=lunarToSolar(now.getFullYear(),bm,bd);
      thisYearBday=new Date(solar.year,solar.month-1,solar.day);
      bdayLabel=now.getFullYear()+'년 '+solar.month+'월 '+solar.day+'일 (음력 '+bm+'월 '+bd+'일)';
    } else {
      thisYearBday=new Date(now.getFullYear(),bm-1,bd);
      bdayLabel=now.getFullYear()+'년 '+bm+'월 '+bd+'일';
    }

    // 올해 생일이 지났으면 내년 생일로
    var nextBday=thisYearBday;
    if(thisYearBday<today){
      if(bc==='lunar'){
        var solarNext=lunarToSolar(now.getFullYear()+1,bm,bd);
        nextBday=new Date(solarNext.year,solarNext.month-1,solarNext.day);
        bdayLabel=(now.getFullYear()+1)+'년 '+solarNext.month+'월 '+solarNext.day+'일 (음력 '+bm+'월 '+bd+'일)';
      } else {
        nextBday=new Date(now.getFullYear()+1,bm-1,bd);
        bdayLabel=(now.getFullYear()+1)+'년 '+bm+'월 '+bd+'일';
      }
    }

    // D-day 계산
    var diffMs=nextBday.getTime()-today.getTime();
    var daysLeft=Math.round(diffMs/86400000);
    var ddayText, isToday=false;
    if(daysLeft===0){ ddayText='TODAY'; isToday=true; }
    else { ddayText='D-'+daysLeft; }

    // 태어난 이후 살아온 일수
    var birthSolar;
    if(bc==='lunar'){
      var bs=lunarToSolar(by,bm,bd);
      birthSolar=new Date(bs.year,bs.month-1,bs.day);
    } else {
      birthSolar=new Date(by,bm-1,bd);
    }
    var livedDays=Math.floor((today.getTime()-birthSolar.getTime())/86400000);

    var html='<span class="anniv-bday-icon">🎂</span>';
    html+='<span class="anniv-bday-date">'+bdayLabel+'</span>';
    html+='<span class="anniv-bday-sep">|</span>';
    html+='<span class="anniv-bday-dday'+(isToday?' today':'')+'">'+ddayText+'</span>';
    html+='<span class="anniv-bday-sep">|</span>';
    html+='<span class="anniv-bday-lived">태어난 지 '+livedDays.toLocaleString()+'일</span>';

    var bdayInfo=document.getElementById('annivBirthdayInfo');
    if(bdayInfo){ bdayInfo.innerHTML=html; bdayInfo.classList.add('visible'); }
  }

  function loadAnniversaries() {
    // 먼저 localStorage에서 임시 로드
    var localData = [];
    try {
      var saved = JSON.parse(localStorage.getItem('radio-anniversaries'));
      if (saved && Array.isArray(saved)) { anniversaries = saved; localData = saved; }
    } catch(e) {}
    renderAnniversaries();
    // 로그인 사용자가 있으면 클라우드에서도 로드 시도
    var username = currentUsername || localStorage.getItem('radioUsername');
    if (username) {
      annivLoggedUser = username;
      // 클라우드에서 직접 다운로드 시도 (localStorage 폴백 없이)
      (async function(){
        var cloudData = [];
        try {
          var r = await supabase.storage.from(BUCKET_NAME).download(
            '_system/anniversaries/' + toSafePath(username) + '.json'
          );
          if (r.data) {
            var arr = JSON.parse(await r.data.text());
            if (Array.isArray(arr) && arr.length > 0) cloudData = arr;
          }
        } catch(e) {}

        if (cloudData.length > 0) {
          // 클라우드 데이터 우선 사용
          anniversaries = cloudData;
        } else if (localData.length > 0) {
          // 클라우드에 없고 로컬에 있으면 로컬 데이터를 클라우드에 업로드
          anniversaries = localData;
          saveAnniversariesToCloud();
        }
        try { localStorage.setItem('radio-anniversaries', JSON.stringify(anniversaries)); } catch(e) {}
        updateAnnivUI();
        renderAnniversaries();
      })();
    }
  }

  function saveAnniversaries() {
    try { localStorage.setItem('radio-anniversaries', JSON.stringify(anniversaries)); } catch(e) {}
    saveAnniversariesToCloud();
  }

  function addAnniversary() {
    if (anniversaries.length >= 5) return;
    var nameEl = document.getElementById('annivNameInput');
    var typeEl = document.getElementById('annivTypeSelect');
    var yEl = document.getElementById('annivYearInput');
    var mEl = document.getElementById('annivMonthInput');
    var dEl = document.getElementById('annivDayInput');
    var calEl = document.getElementById('annivCalSelect');
    var name = nameEl.value.trim();
    var type = typeEl ? typeEl.value : 'birthday';
    var y = parseInt(yEl.value), m = parseInt(mEl.value), d = parseInt(dEl.value);
    var cal = calEl ? calEl.value : 'solar';
    if (!name || !y || !m || !d || m<1||m>12||d<1||d>31) return;
    var date = y+'-'+String(m).padStart(2,'0')+'-'+String(d).padStart(2,'0');
    anniversaries.push({ name: name, type: type, date: date, calendar: cal });
    saveAnniversaries();
    renderAnniversaries();
    nameEl.value=''; yEl.value=''; mEl.value=''; dEl.value='';
    if(typeEl) typeEl.value='birthday';
    if(calEl) calEl.value='solar';
  }

  var editingAnnivIdx = -1;

  function editAnniversary(idx) {
    var a = anniversaries[idx];
    if (!a) return;
    var parts = a.date.split('-');
    document.getElementById('annivNameInput').value = a.name;
    document.getElementById('annivTypeSelect').value = a.type || 'birthday';
    document.getElementById('annivYearInput').value = parseInt(parts[0]);
    document.getElementById('annivMonthInput').value = parseInt(parts[1]);
    document.getElementById('annivDayInput').value = parseInt(parts[2]);
    document.getElementById('annivCalSelect').value = a.calendar || 'solar';
    editingAnnivIdx = idx;
    var addRow = document.getElementById('anniversaryAddRow');
    addRow.classList.remove('hidden');
    var btn = addRow.querySelector('button');
    btn.textContent = '✓';
    btn.onclick = function(){ saveEditedAnniversary(); };
    document.getElementById('annivNameInput').focus();
  }

  function saveEditedAnniversary() {
    var nameEl = document.getElementById('annivNameInput');
    var typeEl = document.getElementById('annivTypeSelect');
    var yEl = document.getElementById('annivYearInput');
    var mEl = document.getElementById('annivMonthInput');
    var dEl = document.getElementById('annivDayInput');
    var calEl = document.getElementById('annivCalSelect');
    var name = nameEl.value.trim();
    var type = typeEl ? typeEl.value : 'birthday';
    var y = parseInt(yEl.value), m = parseInt(mEl.value), d = parseInt(dEl.value);
    var cal = calEl ? calEl.value : 'solar';
    if (!name || !y || !m || !d || m<1||m>12||d<1||d>31) return;
    var date = y+'-'+String(m).padStart(2,'0')+'-'+String(d).padStart(2,'0');
    anniversaries[editingAnnivIdx] = { name: name, type: type, date: date, calendar: cal };
    saveAnniversaries();
    renderAnniversaries();
    nameEl.value=''; yEl.value=''; mEl.value=''; dEl.value='';
    if(typeEl) typeEl.value='birthday';
    if(calEl) calEl.value='solar';
    editingAnnivIdx = -1;
    var btn = document.getElementById('anniversaryAddRow').querySelector('button');
    btn.textContent = '+';
    btn.onclick = function(){ addAnniversary(); };
  }

  function removeAnniversary(idx) {
    anniversaries.splice(idx, 1);
    saveAnniversaries();
    renderAnniversaries();
  }

  function calcDday(dateStr) {
    var today = new Date(); today.setHours(0,0,0,0);
    var target = new Date(dateStr + 'T00:00:00');
    var diff = Math.round((target - today) / 86400000);
    var text, cls;
    if (diff > 0) { text = 'D-' + diff; cls = 'future'; }
    else if (diff === 0) { text = 'D-DAY'; cls = 'today'; }
    else { text = 'D+' + Math.abs(diff); cls = 'past'; }
    return { text: text, cls: cls, diff: diff };
  }

  function getAnnivSolarDate(a) {
    if (a.calendar === 'lunar') {
      var parts = a.date.split('-');
      var y = parseInt(parts[0]), m = parseInt(parts[1]), d = parseInt(parts[2]);
      var solar = lunarToSolar(y, m, d);
      if (solar) return solar.year + '-' + String(solar.month).padStart(2,'0') + '-' + String(solar.day).padStart(2,'0');
    }
    return a.date;
  }

  var ANNIV_TYPE_ICONS = {birthday:'🎂', wedding:'💍', meeting:'💑'};
  var ANNIV_LIVED_LABELS = {birthday:'태어난 지', wedding:'결혼한 지', meeting:'만난 지'};

  function getBirthdayDisplayInfo(a) {
    var parts = a.date.split('-');
    var by = parseInt(parts[0]), bm = parseInt(parts[1]), bd = parseInt(parts[2]);
    var bc = a.calendar;
    var now = new Date(); var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    var thisYearBday, bdayLabel;
    if (bc === 'lunar') {
      var solar = lunarToSolar(now.getFullYear(), bm, bd);
      thisYearBday = new Date(solar.year, solar.month - 1, solar.day);
      bdayLabel = now.getFullYear() + '년 ' + solar.month + '월 ' + solar.day + '일 (음력 ' + bm + '월 ' + bd + '일)';
    } else {
      thisYearBday = new Date(now.getFullYear(), bm - 1, bd);
      bdayLabel = now.getFullYear() + '년 ' + bm + '월 ' + bd + '일';
    }
    var nextBday = thisYearBday;
    if (thisYearBday < today) {
      if (bc === 'lunar') {
        var solarNext = lunarToSolar(now.getFullYear() + 1, bm, bd);
        nextBday = new Date(solarNext.year, solarNext.month - 1, solarNext.day);
        bdayLabel = (now.getFullYear() + 1) + '년 ' + solarNext.month + '월 ' + solarNext.day + '일 (음력 ' + bm + '월 ' + bd + '일)';
      } else {
        nextBday = new Date(now.getFullYear() + 1, bm - 1, bd);
        bdayLabel = (now.getFullYear() + 1) + '년 ' + bm + '월 ' + bd + '일';
      }
    }
    var diffMs = nextBday.getTime() - today.getTime();
    var daysLeft = Math.round(diffMs / 86400000);
    var ddayText, ddayCls;
    if (daysLeft === 0) { ddayText = 'D-DAY'; ddayCls = 'today'; }
    else { ddayText = 'D-' + daysLeft; ddayCls = 'future'; }
    var birthSolar;
    if (bc === 'lunar') {
      var bs = lunarToSolar(by, bm, bd);
      birthSolar = new Date(bs.year, bs.month - 1, bs.day);
    } else {
      birthSolar = new Date(by, bm - 1, bd);
    }
    var livedDays = Math.floor((today.getTime() - birthSolar.getTime()) / 86400000);
    return { bdayLabel: bdayLabel, ddayText: ddayText, ddayCls: ddayCls, livedDays: livedDays, daysLeft: daysLeft };
  }

  function renderAnniversaries() {
    var list = document.getElementById('anniversaryList');
    var addRow = document.getElementById('anniversaryAddRow');
    var html;
    if (anniversaries.length === 0) {
      html = '<div class="anniversary-empty">' +
        (annivLoggedUser ? 'DASHBOARD에서 기념일을 추가하세요' : '로그인 후 기념일을 관리하세요') + '</div>';
    } else {
      html = anniversaries.map(function(a, i) {
        var bInfo = getBirthdayDisplayInfo(a);
        var icon = (a.type && ANNIV_TYPE_ICONS[a.type]) ? ANNIV_TYPE_ICONS[a.type] : '📅';
        var livedLabel = (a.type && ANNIV_LIVED_LABELS[a.type]) ? ANNIV_LIVED_LABELS[a.type] : '기념일로부터';
        return '<div class="anniversary-item bday-anniv">' +
          '<span class="anniv-type-icon">' + icon + '</span>' +
          '<span class="anniv-name">' + a.name.replace(/</g,'&lt;') + '</span>' +
          '<span class="anniv-bday-date">' + bInfo.bdayLabel + '</span>' +
          '<span class="anniv-bday-sep">|</span>' +
          '<span class="anniv-dday ' + bInfo.ddayCls + '">' + bInfo.ddayText + '</span>' +
          '<span class="anniv-bday-sep">|</span>' +
          '<span class="anniv-bday-lived">' + livedLabel + ' ' + bInfo.livedDays.toLocaleString() + '일</span>' +
          '</div>';
      }).join('');
    }
    if (list) list.innerHTML = html;
    // 추가/삭제는 대시보드에서만 가능 — addRow 항상 숨김
    if (typeof applyCreamGoldOverride === 'function') applyCreamGoldOverride();
  }

  function renderDashboardList() {
    var dashList = document.getElementById('dashAnnivList');
    var dashAddRow = document.getElementById('dashAddRow');
    if (anniversaries.length === 0) {
      dashList.innerHTML = '<div class="dashboard-empty">기념일을 추가해보세요</div>';
    } else {
      var sorted = anniversaries.map(function(a, i) {
        var bInfo = getBirthdayDisplayInfo(a);
        return { name: a.name, type: a.type, diff: bInfo.daysLeft, idx: i, bInfo: bInfo };
      }).sort(function(a, b) {
        if (a.diff >= 0 && b.diff >= 0) return a.diff - b.diff;
        if (a.diff >= 0) return -1;
        if (b.diff >= 0) return 1;
        return b.diff - a.diff;
      });
      var nearestIdx = sorted[0].idx;
      dashList.innerHTML = sorted.map(function(s) {
        var icon = (s.type && ANNIV_TYPE_ICONS[s.type]) ? ANNIV_TYPE_ICONS[s.type] : '📅';
        var livedLabel = (s.type && ANNIV_LIVED_LABELS[s.type]) ? ANNIV_LIVED_LABELS[s.type] : '기념일로부터';
        var isNearest = (s.idx === nearestIdx && s.diff >= 0) ? ' nearest' : '';
        return '<div class="dashboard-anniv-item bday-anniv' + isNearest + '">' +
          '<span class="anniv-type-icon">' + icon + '</span>' +
          '<span class="dash-name">' + s.name.replace(/</g,'&lt;') + '</span>' +
          '<span class="anniv-bday-date">' + s.bInfo.bdayLabel + '</span>' +
          '<span class="anniv-bday-sep">|</span>' +
          '<span class="dash-dday ' + s.bInfo.ddayCls + '">' + s.bInfo.ddayText + '</span>' +
          '<span class="anniv-bday-sep">|</span>' +
          '<span class="anniv-bday-lived">' + livedLabel + ' ' + s.bInfo.livedDays.toLocaleString() + '일</span>' +
          '<button class="dash-edit" onclick="editAnniversaryFromDash(' + s.idx + ')" title="수정">수정</button>' +
          '<button class="dash-del" onclick="removeAnniversaryFromDash(' + s.idx + ')" title="삭제">&times;</button>' +
          '</div>';
      }).join('');
    }
    if (dashAddRow) dashAddRow.classList.toggle('hidden', anniversaries.length >= 5);
    if (typeof applyCreamGoldOverride === 'function') applyCreamGoldOverride();
  }

  var FEATURE_NAMES = [
    {key:'listen_together', label:'같이듣기 초대'},
    {key:'gift_song', label:'노래 선물하기'},
    {key:'voice_gift', label:'노래+음성 선물하기'},
    {key:'radio_postcard', label:'라디오 엽서'},
    {key:'time_capsule', label:'타임캡슐'},
    {key:'dj_story', label:'DJ 사연'},
    {key:'music_match', label:'음악 궁합'},
    {key:'photo_album', label:'포토앨범'},
    {key:'diary', label:'일기쓰기'}
  ];

  async function loadFeatureUsage(){
    var listEl = document.getElementById('dashUsageList');
    try {
      var res = await supabase.from('feature_usage')
        .select('feature')
        .eq('user_id', annivLoggedUser);
      var counts = {};
      if(res.data){
        res.data.forEach(function(r){ counts[r.feature] = (counts[r.feature]||0) + 1; });
      }
      var headerHtml = '<div class="dashboard-usage-header">' +
        '<span class="usage-no"></span>' +
        '<span class="usage-name"></span>' +
        '<span class="usage-count">사용</span>' +
        '<span class="usage-received">수신</span>' +
      '</div>';
      var html = headerHtml + FEATURE_NAMES.map(function(f, i){
        var count = counts[f.key] || 0;
        var received = counts[f.key + '_received'] || 0;
        return '<div class="dashboard-usage-item">' +
          '<span class="usage-no">' + (i+1) + '</span>' +
          '<span class="usage-name">' + f.label + '</span>' +
          '<span class="usage-count">' + count + '</span>' +
          '<span class="usage-received">' + received + '</span>' +
        '</div>';
      }).join('');
      listEl.innerHTML = html;
    } catch(e){
      listEl.innerHTML = '<div class="dashboard-empty">로드 실패</div>';
    }
  }

  async function openDashboard() {
    if (!annivLoggedUser) return;
    var users = await loadAnnivUsers();
    var userData = users[annivLoggedUser] || {};
    var email = typeof userData === 'string' ? '' : (userData.email || '');
    document.getElementById('dashUserName').textContent = annivLoggedUser;
    document.getElementById('dashUserEmail').textContent = email || '이메일 미등록';
    // 관리자에서 온 경우 돌아가기 버튼 표시
    var adminBack = document.getElementById('dashAdminBack');
    var urlP = new URLSearchParams(location.search);
    if(urlP.get('dashboard')){
      adminBack.classList.remove('hidden');
    } else {
      adminBack.classList.add('hidden');
    }
    renderDashboardList();
    loadFeatureUsage();
    document.getElementById('dashboardOverlay').classList.add('visible');
  }

  function closeDashboard() {
    document.getElementById('dashboardOverlay').classList.remove('visible');
  }

  function addAnniversaryFromDash() {
    if (anniversaries.length >= 5) return;
    var nameEl = document.getElementById('dashAnnivNameInput');
    var typeEl = document.getElementById('dashAnnivTypeSelect');
    var yEl = document.getElementById('dashAnnivYearInput');
    var mEl = document.getElementById('dashAnnivMonthInput');
    var dEl = document.getElementById('dashAnnivDayInput');
    var calEl = document.getElementById('dashAnnivCalSelect');
    var name = nameEl.value.trim();
    var type = typeEl ? typeEl.value : 'birthday';
    var y = parseInt(yEl.value), m = parseInt(mEl.value), d = parseInt(dEl.value);
    var cal = calEl ? calEl.value : 'solar';
    if (!name || !y || !m || !d || m<1||m>12||d<1||d>31) return;
    var date = y+'-'+String(m).padStart(2,'0')+'-'+String(d).padStart(2,'0');
    anniversaries.push({ name: name, type: type, date: date, calendar: cal });
    saveAnniversaries();
    renderAnniversaries();
    renderDashboardList();
    nameEl.value=''; yEl.value=''; mEl.value=''; dEl.value='';
    if(typeEl) typeEl.value='birthday';
    if(calEl) calEl.value='solar';
  }

  var editingDashAnnivIdx = -1;

  function editAnniversaryFromDash(idx) {
    var a = anniversaries[idx];
    if (!a) return;
    var parts = a.date.split('-');
    document.getElementById('dashAnnivNameInput').value = a.name;
    document.getElementById('dashAnnivTypeSelect').value = a.type || 'birthday';
    document.getElementById('dashAnnivYearInput').value = parseInt(parts[0]);
    document.getElementById('dashAnnivMonthInput').value = parseInt(parts[1]);
    document.getElementById('dashAnnivDayInput').value = parseInt(parts[2]);
    document.getElementById('dashAnnivCalSelect').value = a.calendar || 'solar';
    editingDashAnnivIdx = idx;
    var addRow = document.getElementById('dashAddRow');
    addRow.classList.remove('hidden');
    var btn = addRow.querySelector('button');
    btn.textContent = '✓';
    btn.onclick = function(){ saveEditedAnniversaryFromDash(); };
    document.getElementById('dashAnnivNameInput').focus();
  }

  function saveEditedAnniversaryFromDash() {
    var nameEl = document.getElementById('dashAnnivNameInput');
    var typeEl = document.getElementById('dashAnnivTypeSelect');
    var yEl = document.getElementById('dashAnnivYearInput');
    var mEl = document.getElementById('dashAnnivMonthInput');
    var dEl = document.getElementById('dashAnnivDayInput');
    var calEl = document.getElementById('dashAnnivCalSelect');
    var name = nameEl.value.trim();
    var type = typeEl ? typeEl.value : 'birthday';
    var y = parseInt(yEl.value), m = parseInt(mEl.value), d = parseInt(dEl.value);
    var cal = calEl ? calEl.value : 'solar';
    if (!name || !y || !m || !d || m<1||m>12||d<1||d>31) return;
    var date = y+'-'+String(m).padStart(2,'0')+'-'+String(d).padStart(2,'0');
    anniversaries[editingDashAnnivIdx] = { name: name, type: type, date: date, calendar: cal };
    saveAnniversaries();
    renderAnniversaries();
    renderDashboardList();
    nameEl.value=''; yEl.value=''; mEl.value=''; dEl.value='';
    if(typeEl) typeEl.value='birthday';
    if(calEl) calEl.value='solar';
    editingDashAnnivIdx = -1;
    var btn = document.getElementById('dashAddRow').querySelector('button');
    btn.textContent = '+';
    btn.onclick = function(){ addAnniversaryFromDash(); };
  }

  function removeAnniversaryFromDash(idx) {
    anniversaries.splice(idx, 1);
    saveAnniversaries();
    renderAnniversaries();
    renderDashboardList();
  }

  // === Song Download Screen ===
  var SONG_FOLDER = '_system/songs';

  function openSongDownload() {
    document.getElementById('songDlScreen').classList.remove('hidden');
  }
  function closeSongDownload() {
    document.getElementById('songDlScreen').classList.add('hidden');
  }

  // Upload all 5 Korean + 5 English MP3s to Supabase (one-time, called from console or button)
  async function uploadAllSongsToSupabase() {
    if (!supabase) { alert('Supabase 연결 안됨'); return; }
    var types = ['birthday','wedding','cheer','thanks','love'];
    var langs = ['kr','en'];
    var total = types.length * langs.length, done = 0;
    for (var ti = 0; ti < types.length; ti++) {
      for (var li = 0; li < langs.length; li++) {
        var type = types[ti], lang = langs[li];
        var song = SONGS[type][lang];
        var fileName = SONG_FOLDER + '/' + song.name + '.mp3';
        // Check if already exists
        var { data: existing } = await supabase.storage.from(BUCKET_NAME).list(SONG_FOLDER, { search: song.name + '.mp3' });
        if (existing && existing.length > 0 && existing.some(function(f){ return f.name === song.name + '.mp3'; })) {
          done++;
          console.log('[' + done + '/' + total + '] 이미 존재: ' + song.name);
          continue;
        }
        // Generate MP3 blob
        try {
          var mp3Blob = await generateSongBlob(type, lang);
          var { error } = await supabase.storage.from(BUCKET_NAME).upload(fileName, mp3Blob, {
            contentType: 'audio/mpeg', upsert: true
          });
          done++;
          if (error) {
            console.error('[' + done + '/' + total + '] 업로드 실패: ' + song.name, error);
          } else {
            console.log('[' + done + '/' + total + '] 업로드 완료: ' + song.name);
          }
        } catch(e) {
          done++;
          console.error('[' + done + '/' + total + '] 생성 실패: ' + song.name, e);
        }
      }
    }
    alert('전체 ' + total + '곡 업로드 완료!');
  }

  // Generate a song as MP3 Blob (returns Promise)
  function generateSongBlob(type, lang) {
    return new Promise(function(resolve, reject) {
      var song = SONGS[type] && SONGS[type][lang];
      if (!song) return reject('Song not found');
      var bpm = song.bpm, beatSec = 60 / bpm;
      var totalBeats = 0;
      song.melody.forEach(function(n){ totalBeats += n[1]; });
      var duration = totalBeats * beatSec + 2.5;
      var sr = 44100;
      var ctx = new OfflineAudioContext(2, Math.ceil(sr * duration), sr);
      renderSongToContext(ctx, song, duration);
      ctx.startRendering().then(function(buffer) {
        try {
          resolve(encodeMP3(buffer));
        } catch(e) {
          resolve(encodeWAV(buffer));
        }
      }).catch(reject);
    });
  }

  // Note frequencies
  var NF = {
    'C2':65.41,'D2':73.42,'E2':82.41,'F2':87.31,'G2':98.00,'A2':110.00,'B2':123.47,
    'C3':130.81,'D3':146.83,'Eb3':155.56,'E3':164.81,'F3':174.61,'Fs3':185.00,'G3':196.00,'Ab3':207.65,'A3':220.00,'Bb3':233.08,'B3':246.94,
    'C4':261.63,'Cs4':277.18,'D4':293.66,'Eb4':311.13,'E4':329.63,'F4':349.23,'Fs4':369.99,
    'G4':392.00,'Ab4':415.30,'A4':440.00,'Bb4':466.16,'B4':493.88,
    'C5':523.25,'Cs5':554.37,'D5':587.33,'Eb5':622.25,'E5':659.25,'F5':698.46,'Fs5':739.99,
    'G5':783.99,'Ab5':830.61,'A5':880.00,'Bb5':932.33,'B5':987.77,'C6':1046.50
  };

  // Rich song data with melody, chords, bass, and style info
  var SONGS = {
    birthday: {
      kr: {
        bpm: 105, name: '생일축하_한글판', style: 'warm',
        melody: [
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['C5',1],['B4',2],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['D5',1],['C5',2],
          ['G4',.75],['G4',.25],['G5',1],['E5',1],['C5',1],['B4',1],['A4',2],
          ['F5',.75],['F5',.25],['E5',1],['C5',1],['D5',1],['C5',2],[0,1],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['C5',1],['B4',2],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['D5',1],['C5',2],
          ['G4',.75],['G4',.25],['G5',1],['E5',1],['C5',1],['B4',1],['A4',2],
          ['F5',.75],['F5',.25],['E5',1],['C5',1],['D5',1],['C5',3]
        ],
        chords: [
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],
          [['C3','E3','G3'],4],[['G3','B3','D4'],4],
          [['C3','E3','G3'],4],[['C3','E3','G3'],2],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],
          [['C3','E3','G3'],4],[['G3','B3','D4'],4],
          [['C3','E3','G3'],6]
        ],
        bass: [
          ['C2',4],['C2',4],['F2',4],['C2',4],['C2',4],['G2',4],['C2',4],['C2',3],
          ['C2',4],['C2',4],['F2',4],['C2',4],['C2',4],['G2',4],['C2',6]
        ]
      },
      en: {
        bpm: 124, name: 'HappyBirthday_English', style: 'bright',
        melody: [
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['C5',1],['B4',2],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['D5',1],['C5',2],
          ['G4',.75],['G4',.25],['G5',1],['E5',1],['C5',1],['B4',1],['A4',2],
          ['F5',.75],['F5',.25],['E5',1],['C5',1],['D5',1],['C5',2],[0,1],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['C5',1],['B4',2],
          ['G4',.75],['G4',.25],['A4',1],['G4',1],['D5',1],['C5',2],
          ['G4',.75],['G4',.25],['G5',1],['E5',1],['C5',1],['B4',1],['A4',2],
          ['F5',.75],['F5',.25],['E5',1],['C5',1],['D5',1],['C5',3]
        ],
        chords: [
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],
          [['C3','E3','G3'],4],[['G3','B3','D4'],4],
          [['C3','E3','G3'],4],[['C3','E3','G3'],2],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],
          [['C3','E3','G3'],4],[['G3','B3','D4'],4],
          [['C3','E3','G3'],6]
        ],
        bass: [
          ['C2',4],['C2',4],['F2',4],['C2',4],['C2',4],['G2',4],['C2',4],['C2',3],
          ['C2',4],['C2',4],['F2',4],['C2',4],['C2',4],['G2',4],['C2',6]
        ]
      }
    },
    wedding: {
      kr: {
        bpm: 88, name: '결혼축하_한글판', style: 'elegant',
        melody: [
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['A4',.5],['G4',.5],['F4',2],
          ['G4',.5],['F4',.5],['G4',.5],['A4',1.5],
          ['F4',1],['D4',.5],['D4',.5],['F4',2],[0,1],
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['A4',.5],['C5',.5],['A4',2],
          ['Bb4',.5],['A4',.5],['G4',.5],['A4',1.5],
          ['F4',1],['G4',1],['F4',3],[0,1],
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['A4',.5],['G4',.5],['F4',2],
          ['G4',.5],['F4',.5],['G4',.5],['A4',1.5],
          ['F4',1],['D4',.5],['D4',.5],['F4',3]
        ],
        chords: [
          [['F3','A3','C4'],4],[['F3','A3','C4'],4],
          [['C3','E3','G3'],3],[['F3','A3','C4'],4],
          [['Bb3','D4','F4'],3],[['F3','A3','C4'],3],[0,1],
          [['F3','A3','C4'],4],[['F3','A3','C4'],4],
          [['C3','E3','G3'],3],[['F3','A3','C4'],4],
          [['C3','E3','G3'],3],[['F3','A3','C4'],4],[0,1],
          [['F3','A3','C4'],4],[['F3','A3','C4'],4],
          [['C3','E3','G3'],3],[['F3','A3','C4'],4],
          [['Bb3','D4','F4'],3],[['F3','A3','C4'],4]
        ],
        bass: [
          ['F2',4],['F2',4],['C2',3],['F2',4],['Bb2',3],['F2',4],
          ['F2',4],['F2',4],['C2',3],['F2',4],['C2',3],['F2',5],
          ['F2',4],['F2',4],['C2',3],['F2',4],['Bb2',3],['F2',4]
        ]
      },
      en: {
        bpm: 96, name: 'Wedding_English', style: 'elegant',
        melody: [
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['Ab4',.5],['G4',.5],['F4',2],
          ['G4',.5],['F4',.5],['G4',.5],['Ab4',1.5],
          ['F4',1],['D4',.5],['D4',.5],['F4',2],[0,1],
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['Ab4',.5],['C5',.5],['Ab4',2],
          ['Bb4',.5],['Ab4',.5],['G4',.5],['Ab4',1.5],
          ['F4',1],['G4',1],['F4',3],[0,1],
          ['C5',2],['F4',1.5],['F4',.5],['F4',2],[0,.5],
          ['F4',.5],['Ab4',.5],['G4',.5],['F4',2],
          ['G4',.5],['F4',.5],['G4',.5],['Ab4',1.5],
          ['F4',1],['D4',.5],['D4',.5],['F4',3]
        ],
        chords: [
          [['F3','Ab3','C4'],4],[['F3','Ab3','C4'],4],
          [['C3','Eb3','G3'],3],[['F3','Ab3','C4'],4],
          [['Bb3','D4','F4'],3],[['F3','Ab3','C4'],3],[0,1],
          [['F3','Ab3','C4'],4],[['F3','Ab3','C4'],4],
          [['C3','Eb3','G3'],3],[['F3','Ab3','C4'],4],
          [['C3','Eb3','G3'],3],[['F3','Ab3','C4'],4],[0,1],
          [['F3','Ab3','C4'],4],[['F3','Ab3','C4'],4],
          [['C3','Eb3','G3'],3],[['F3','Ab3','C4'],4],
          [['Bb3','D4','F4'],3],[['F3','Ab3','C4'],4]
        ],
        bass: [
          ['F2',4],['F2',4],['C2',3],['F2',4],['Bb2',3],['F2',4],
          ['F2',4],['F2',4],['C2',3],['F2',4],['C2',3],['F2',5],
          ['F2',4],['F2',4],['C2',3],['F2',4],['Bb2',3],['F2',4]
        ]
      }
    },
    cheer: {
      kr: {
        bpm: 132, name: '응원_한글판', style: 'bright',
        melody: [
          ['E4',.5],['E4',.5],['G4',.5],['A4',.5],['B4',1],['B4',1],
          ['A4',.5],['G4',.5],['A4',1],['E4',2],
          ['E4',.5],['E4',.5],['G4',.5],['A4',.5],['B4',1],['D5',1],
          ['B4',.5],['A4',.5],['G4',1],['E4',2],[0,1],
          ['D5',1],['D5',.5],['B4',.5],['D5',1],['E5',1],
          ['D5',.5],['B4',.5],['A4',1],['G4',2],
          ['E4',.5],['G4',.5],['A4',1],['B4',.5],['A4',.5],
          ['G4',.5],['A4',.5],['E4',2],[0,1],
          ['E4',.5],['E4',.5],['G4',.5],['A4',.5],['B4',1],['B4',1],
          ['A4',.5],['G4',.5],['A4',1],['E4',2],
          ['D5',1],['D5',.5],['B4',.5],['D5',1],['E5',1],
          ['D5',.5],['B4',.5],['A4',1],['B4',1],['E4',3]
        ],
        chords: [
          [['E3','G3','B3'],4],[['E3','G3','B3'],4],
          [['A3','C4','E4'],4],[['E3','G3','B3'],4],[0,1],
          [['A3','C4','E4'],4],[['E3','G3','B3'],4],
          [['A3','C4','E4'],4],[['E3','G3','B3'],3],[0,1],
          [['E3','G3','B3'],4],[['E3','G3','B3'],4],
          [['A3','C4','E4'],4],[['B3','D4','Fs4'],4],['E3',4]
        ],
        bass: [
          ['E2',4],['E2',4],['A2',4],['E2',5],
          ['A2',4],['E2',4],['A2',4],['E2',4],
          ['E2',4],['E2',4],['A2',4],['B2',4],['E2',4]
        ]
      },
      en: {
        bpm: 144, name: 'Cheering_English', style: 'bright',
        melody: [
          ['C4',.5],['E4',.5],['G4',1],['G4',.5],['A4',.5],['G4',1],
          ['E4',.5],['G4',.5],['C5',1],['B4',2],
          ['A4',.5],['G4',.5],['A4',1],['G4',.5],['E4',.5],['D4',2],[0,1],
          ['C4',.5],['E4',.5],['G4',1],['A4',.5],['B4',.5],['C5',1],
          ['D5',1],['C5',.5],['B4',.5],['A4',2],
          ['G4',.5],['A4',.5],['G4',.5],['E4',.5],['D4',.5],['E4',.5],['C4',2],[0,1],
          ['C4',.5],['E4',.5],['G4',1],['G4',.5],['A4',.5],['G4',1],
          ['E4',.5],['G4',.5],['C5',1],['B4',2],
          ['D5',1],['C5',.5],['B4',.5],['A4',1],['G4',1],
          ['E4',.5],['G4',.5],['C4',3]
        ],
        chords: [
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['G3','B3','D4'],3],[0,1],
          [['C3','E3','G3'],4],[['F3','A3','C4'],4],
          [['G3','B3','D4'],4],[['C3','E3','G3'],3],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],
          [['F3','A3','C4'],4],[['G3','B3','D4'],4],['C3',4]
        ],
        bass: [
          ['C2',4],['C2',4],['F2',4],['G2',4],
          ['C2',4],['F2',4],['G2',4],['C2',4],
          ['C2',4],['C2',4],['F2',4],['G2',4],['C2',4]
        ]
      }
    },
    thanks: {
      kr: {
        bpm: 84, name: '감사_한글판', style: 'warm',
        melody: [
          ['E4',1],['G4',1],['A4',1.5],['G4',.5],['E4',2],[0,1],
          ['A4',1],['B4',1],['C5',1.5],['B4',.5],['A4',2],[0,1],
          ['E5',1],['D5',1],['C5',1],['B4',1],['A4',1],['G4',1],
          ['A4',2],['E4',2],[0,1],
          ['E4',1],['G4',1],['A4',1.5],['B4',.5],['C5',2],[0,1],
          ['D5',1],['C5',1],['B4',1],['A4',1],
          ['G4',1],['A4',.5],['G4',.5],['E4',2],[0,1],
          ['E4',1],['G4',1],['A4',1.5],['G4',.5],['E4',2],[0,1],
          ['A4',1],['B4',1],['C5',1.5],['B4',.5],['A4',2],[0,1],
          ['D5',1],['C5',1],['B4',1],['A4',1],
          ['G4',1],['A4',.5],['G4',.5],['E4',3]
        ],
        chords: [
          [['A3','C4','E4'],4],[['A3','C4','E4'],4],[0,1],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],[0,1],
          [['A3','C4','E4'],4],[['E3','G3','B3'],4],
          [['A3','C4','E4'],3],[0,1],
          [['A3','C4','E4'],4],[['F3','A3','C4'],4],[0,1],
          [['G3','B3','D4'],4],[['A3','C4','E4'],3],[0,1],
          [['A3','C4','E4'],4],[['A3','C4','E4'],4],[0,1],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],[0,1],
          [['G3','B3','D4'],4],[['A3','C4','E4'],4]
        ],
        bass: [
          ['A2',4],['A2',5],['F2',4],['C2',5],
          ['A2',4],['E2',4],['A2',4],
          ['A2',4],['F2',5],['G2',4],['A2',4],
          ['A2',4],['A2',5],['F2',4],['C2',5],['G2',4],['A2',4]
        ]
      },
      en: {
        bpm: 92, name: 'Gratitude_English', style: 'warm',
        melody: [
          ['C4',1],['E4',1],['G4',1.5],['E4',.5],['C4',2],[0,1],
          ['F4',1],['A4',1],['G4',1.5],['F4',.5],['E4',2],[0,1],
          ['G4',1],['A4',1],['B4',1],['C5',2],['B4',1],
          ['A4',1],['G4',1],['E4',2],[0,1],
          ['C4',1],['E4',1],['G4',1],['A4',1],['G4',2],[0,1],
          ['F4',1],['E4',1],['D4',.5],['E4',.5],['C4',2],[0,1],
          ['C4',1],['E4',1],['G4',1.5],['E4',.5],['C4',2],[0,1],
          ['F4',1],['A4',1],['G4',1.5],['F4',.5],['E4',2],[0,1],
          ['F4',1],['E4',1],['D4',.5],['E4',.5],['C4',3]
        ],
        chords: [
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],[0,1],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],4],
          [['C3','E3','G3'],3],[0,1],
          [['C3','E3','G3'],4],[['F3','A3','C4'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],3],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],[0,1],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],4]
        ],
        bass: [
          ['C2',4],['C2',5],['F2',4],['C2',5],
          ['G2',4],['C2',4],['C2',4],
          ['C2',4],['F2',5],['G2',4],['C2',4],
          ['C2',4],['C2',5],['F2',4],['C2',5],['G2',4],['C2',4]
        ]
      }
    },
    love: {
      kr: {
        bpm: 74, name: '사랑_한글판', style: 'romantic',
        melody: [
          ['E4',1.5],['Fs4',.5],['G4',1],['A4',1],['B4',2],[0,1],
          ['A4',1],['G4',1],['Fs4',.5],['G4',.5],['E4',2],[0,1],
          ['B4',1.5],['A4',.5],['G4',1],['Fs4',1],['E4',2],[0,1],
          ['D4',1],['E4',1],['Fs4',.5],['G4',.5],['A4',2],[0,1],
          ['E4',1.5],['Fs4',.5],['G4',1],['A4',1],['B4',2],[0,1],
          ['D5',1],['C5',1],['B4',1],['A4',1],
          ['G4',.5],['A4',.5],['B4',.5],['A4',.5],['G4',2],[0,1],
          ['E4',1.5],['Fs4',.5],['G4',1],['A4',1],['B4',2],[0,1],
          ['A4',1],['G4',1],['Fs4',.5],['G4',.5],['E4',2],[0,1],
          ['D5',1],['C5',1],['B4',1],['A4',1],
          ['G4',.5],['A4',.5],['B4',.5],['A4',.5],['E4',3]
        ],
        chords: [
          [['E3','G3','B3'],4],[['A3','C4','E4'],4],[0,1],
          [['E3','G3','B3'],4],[['E3','G3','B3'],4],[0,1],
          [['A3','C4','E4'],4],[['E3','G3','B3'],4],[0,1],
          [['D3','Fs3','A3'],4],[['A3','C4','E4'],4],[0,1],
          [['E3','G3','B3'],4],[['A3','C4','E4'],4],[0,1],
          [['D3','Fs3','A3'],4],[['E3','G3','B3'],3],[0,1],
          [['E3','G3','B3'],4],[['A3','C4','E4'],4],[0,1],
          [['E3','G3','B3'],4],[['E3','G3','B3'],4],[0,1],
          [['D3','Fs3','A3'],4],[['E3','G3','B3'],4]
        ],
        bass: [
          ['E2',4],['A2',5],['E2',4],['E2',5],
          ['A2',4],['E2',5],['D2',4],['A2',5],
          ['E2',4],['A2',5],['D2',4],['E2',4],
          ['E2',4],['A2',5],['E2',4],['E2',5],['D2',4],['E2',4]
        ]
      },
      en: {
        bpm: 80, name: 'Love_English', style: 'romantic',
        melody: [
          ['C4',1.5],['D4',.5],['E4',1],['G4',1],['A4',2],[0,1],
          ['G4',1],['E4',1],['D4',.5],['E4',.5],['C4',2],[0,1],
          ['A4',1.5],['G4',.5],['F4',1],['E4',1],['D4',2],[0,1],
          ['E4',1],['F4',1],['G4',.5],['A4',.5],['G4',2],[0,1],
          ['C4',1.5],['D4',.5],['E4',1],['G4',1],['A4',2],[0,1],
          ['C5',1],['B4',1],['A4',1],['G4',1],
          ['F4',.5],['G4',.5],['E4',.5],['D4',.5],['C4',2],[0,1],
          ['C4',1.5],['D4',.5],['E4',1],['G4',1],['A4',2],[0,1],
          ['G4',1],['E4',1],['D4',.5],['E4',.5],['C4',2],[0,1],
          ['C5',1],['B4',1],['A4',1],['G4',1],
          ['F4',.5],['G4',.5],['E4',.5],['D4',.5],['C4',3]
        ],
        chords: [
          [['C3','E3','G3'],4],[['F3','A3','C4'],4],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],[0,1],
          [['F3','A3','C4'],4],[['C3','E3','G3'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],4],[0,1],
          [['C3','E3','G3'],4],[['F3','A3','C4'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],3],[0,1],
          [['C3','E3','G3'],4],[['F3','A3','C4'],4],[0,1],
          [['C3','E3','G3'],4],[['C3','E3','G3'],4],[0,1],
          [['G3','B3','D4'],4],[['C3','E3','G3'],4]
        ],
        bass: [
          ['C2',4],['F2',5],['C2',4],['C2',5],
          ['F2',4],['C2',5],['G2',4],['C2',5],
          ['C2',4],['F2',5],['G2',4],['C2',4],
          ['C2',4],['F2',5],['C2',4],['C2',5],['G2',4],['C2',4]
        ]
      }
    }
  };

  // === Rich Audio Engine ===

  // Render song audio nodes into an OfflineAudioContext
  function renderSongToContext(ctx, song, duration) {
    var bpm = song.bpm, beatSec = 60 / bpm;
    var compressor = ctx.createDynamicsCompressor();
    compressor.threshold.value = -18; compressor.knee.value = 12; compressor.ratio.value = 4;
    compressor.connect(ctx.destination);

    var reverbGain = ctx.createGain(); reverbGain.gain.value = 0.25;
    var delay1 = ctx.createDelay(); delay1.delayTime.value = 0.03;
    var delay2 = ctx.createDelay(); delay2.delayTime.value = 0.07;
    var delay3 = ctx.createDelay(); delay3.delayTime.value = 0.13;
    var dg1 = ctx.createGain(); dg1.gain.value = 0.3;
    var dg2 = ctx.createGain(); dg2.gain.value = 0.2;
    var dg3 = ctx.createGain(); dg3.gain.value = 0.12;
    reverbGain.connect(delay1); delay1.connect(dg1); dg1.connect(compressor);
    reverbGain.connect(delay2); delay2.connect(dg2); dg2.connect(compressor);
    reverbGain.connect(delay3); delay3.connect(dg3); dg3.connect(compressor);

    var isRomantic = song.style === 'romantic';
    var isElegant = song.style === 'elegant';
    var isBright = song.style === 'bright';

    // MELODY
    var t = 0.5;
    song.melody.forEach(function(n) {
      var note = n[0], beats = n[1], dur = beats * beatSec;
      if (note && NF[note]) {
        var freq = NF[note];
        synthNote(ctx, compressor, reverbGain, freq, t, dur * 0.92, 0.22, 'triangle', isRomantic ? 0.06 : 0.03);
        synthNote(ctx, compressor, reverbGain, freq * 2, t, dur * 0.85, 0.08, 'sine', 0.02);
        synthNote(ctx, compressor, reverbGain, freq * 3, t, dur * 0.7, 0.025, 'sine', 0.01);
        synthNote(ctx, compressor, reverbGain, freq * 0.5, t, dur * 0.6, 0.04, 'sine', 0.01);
        synthNote(ctx, compressor, reverbGain, freq * 1.003, t + 0.008, dur * 0.88, 0.06, 'triangle', 0.03);
        synthNote(ctx, compressor, reverbGain, freq * 0.997, t + 0.005, dur * 0.88, 0.06, 'triangle', 0.03);
      }
      t += dur;
    });

    // CHORDS
    var ct = 0.5;
    if (song.chords) {
      song.chords.forEach(function(c) {
        var notes = c[0], beats = c[1], dur = beats * beatSec;
        if (notes && Array.isArray(notes)) {
          notes.forEach(function(cn) {
            if (NF[cn]) {
              var vol = isElegant ? 0.05 : 0.06;
              synthNote(ctx, compressor, reverbGain, NF[cn], ct, dur * 0.95, vol, 'sine', 0.08);
              synthNote(ctx, compressor, reverbGain, NF[cn] * 1.002, ct + 0.01, dur * 0.9, vol * 0.5, 'sine', 0.08);
            }
          });
        }
        ct += dur;
      });
    }

    // BASS
    var bt = 0.5;
    if (song.bass) {
      song.bass.forEach(function(b) {
        var note = b[0], beats = b[1], dur = beats * beatSec;
        if (note && NF[note]) {
          synthNote(ctx, compressor, reverbGain, NF[note], bt, dur * 0.9, 0.12, 'sine', 0.05);
          synthNote(ctx, compressor, reverbGain, NF[note] * 2, bt, dur * 0.7, 0.03, 'triangle', 0.03);
        }
        bt += dur;
      });
    }

    // RHYTHM
    if (isBright) {
      var rhythmT = 0.5, rhythmEnd = duration - 1, beatLen = beatSec;
      while (rhythmT < rhythmEnd) {
        addPercHit(ctx, compressor, rhythmT, 0.04, 0.05);
        if (rhythmT + beatLen * 2 < rhythmEnd)
          addPercHit(ctx, compressor, rhythmT + beatLen * 2, 0.02, 0.04);
        rhythmT += beatLen * 4;
      }
    }
  }

  // Download song: try Supabase first, fallback to local generation + upload
  async function downloadSong(type, lang, btnEl) {
    var song = SONGS[type] && SONGS[type][lang];
    if (!song) return;
    if (btnEl) {
      if (btnEl.classList.contains('generating')) return;
      btnEl.classList.add('generating');
      btnEl.innerHTML = '<span class="dl-icon">&#x23F3;</span> 다운로드중...';
    }
    var isKr = lang === 'kr';
    var resetBtn = function() {
      if (btnEl) {
        btnEl.classList.remove('generating');
        btnEl.innerHTML = '<span class="dl-icon">&#x25B6;</span> ' + (isKr ? '한글판' : 'English');
      }
    };

    try {
      // 1) Try download from Supabase
      if (supabase) {
        var filePath = SONG_FOLDER + '/' + song.name + '.mp3';
        var { data: pubUrl } = supabase.storage.from(BUCKET_NAME).getPublicUrl(filePath);
        if (pubUrl && pubUrl.publicUrl) {
          var resp = await fetch(pubUrl.publicUrl);
          if (resp.ok) {
            var blob = await resp.blob();
            if (blob.size > 1000) {
              triggerDownload(blob, song.name + '.mp3');
              resetBtn();
              return;
            }
          }
        }
      }

      // 2) Generate locally, upload to Supabase, then download
      if (btnEl) btnEl.innerHTML = '<span class="dl-icon">&#x23F3;</span> 생성중...';
      var mp3Blob = await generateSongBlob(type, lang);

      // Upload to Supabase in background
      if (supabase) {
        var uploadPath = SONG_FOLDER + '/' + song.name + '.mp3';
        supabase.storage.from(BUCKET_NAME).upload(uploadPath, mp3Blob, {
          contentType: 'audio/mpeg', upsert: true
        }).then(function(r) {
          if (r.error) console.warn('Song upload failed:', r.error);
          else console.log('Song uploaded to Supabase: ' + song.name);
        });
      }

      var ext = mp3Blob.type === 'audio/mp3' ? '.mp3' : '.wav';
      triggerDownload(mp3Blob, song.name + ext);
      resetBtn();
    } catch(e) {
      console.error('Song download error:', e);
      alert('노래 다운로드 중 오류가 발생했습니다. 다시 시도해주세요.');
      resetBtn();
    }
  }

  function triggerDownload(blob, filename) {
    var url = URL.createObjectURL(blob);
    var a = document.createElement('a');
    a.href = url; a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(function(){ URL.revokeObjectURL(url); }, 5000);
  }

  // Synth note with ADSR envelope
  function synthNote(ctx, dest, reverb, freq, start, dur, vol, wave, attack) {
    var osc = ctx.createOscillator();
    var gain = ctx.createGain();
    osc.type = wave || 'triangle';
    osc.frequency.value = freq;
    var att = attack || 0.03;
    var rel = Math.min(0.3, dur * 0.25);
    var susVol = vol * 0.75;
    gain.gain.setValueAtTime(0, start);
    gain.gain.linearRampToValueAtTime(vol, start + att);
    gain.gain.exponentialRampToValueAtTime(Math.max(susVol, 0.001), start + att + 0.1);
    gain.gain.setValueAtTime(Math.max(susVol, 0.001), start + dur - rel);
    gain.gain.exponentialRampToValueAtTime(0.001, start + dur);
    osc.connect(gain);
    gain.connect(dest);
    if (reverb) gain.connect(reverb);
    osc.start(start);
    osc.stop(start + dur + 0.05);
  }

  // Simple percussion hit (noise burst)
  function addPercHit(ctx, dest, time, vol, dur) {
    var bufSize = Math.ceil(ctx.sampleRate * dur);
    var noiseBuf = ctx.createBuffer(1, bufSize, ctx.sampleRate);
    var data = noiseBuf.getChannelData(0);
    for (var i = 0; i < bufSize; i++) {
      data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufSize * 0.15));
    }
    var src = ctx.createBufferSource();
    src.buffer = noiseBuf;
    var filt = ctx.createBiquadFilter();
    filt.type = 'highpass'; filt.frequency.value = 6000;
    var g = ctx.createGain();
    g.gain.setValueAtTime(vol, time);
    g.gain.exponentialRampToValueAtTime(0.001, time + dur);
    src.connect(filt); filt.connect(g); g.connect(dest);
    src.start(time); src.stop(time + dur);
  }

  // MP3 encoding via lamejs
  function encodeMP3(audioBuffer) {
    if (typeof lamejs === 'undefined') throw new Error('lamejs not loaded');
    var sr = audioBuffer.sampleRate;
    var ch = audioBuffer.numberOfChannels;
    var len = audioBuffer.length;
    var left = audioBuffer.getChannelData(0);
    var right = ch > 1 ? audioBuffer.getChannelData(1) : left;
    var l16 = new Int16Array(len);
    var r16 = new Int16Array(len);
    for (var i = 0; i < len; i++) {
      l16[i] = Math.max(-32768, Math.min(32767, Math.round(left[i] * 32767)));
      r16[i] = Math.max(-32768, Math.min(32767, Math.round(right[i] * 32767)));
    }
    var enc = new lamejs.Mp3Encoder(2, sr, 192);
    var mp3 = [];
    var blockSize = 1152;
    for (var i = 0; i < len; i += blockSize) {
      var lChunk = l16.subarray(i, Math.min(i + blockSize, len));
      var rChunk = r16.subarray(i, Math.min(i + blockSize, len));
      var buf = enc.encodeBuffer(lChunk, rChunk);
      if (buf.length > 0) mp3.push(buf);
    }
    var end = enc.flush();
    if (end.length > 0) mp3.push(end);
    return new Blob(mp3, { type: 'audio/mp3' });
  }

  // WAV fallback
  function encodeWAV(audioBuffer) {
    var numCh = audioBuffer.numberOfChannels;
    var sr = audioBuffer.sampleRate, bits = 16;
    var len = audioBuffer.length;
    var buffer = new ArrayBuffer(44 + len * numCh * 2);
    var v = new DataView(buffer);
    function writeStr(o, s) { for (var i = 0; i < s.length; i++) v.setUint8(o + i, s.charCodeAt(i)); }
    writeStr(0, 'RIFF');
    v.setUint32(4, 36 + len * numCh * 2, true);
    writeStr(8, 'WAVE'); writeStr(12, 'fmt ');
    v.setUint32(16, 16, true);
    v.setUint16(20, 1, true);
    v.setUint16(22, numCh, true);
    v.setUint32(24, sr, true);
    v.setUint32(28, sr * numCh * bits / 8, true);
    v.setUint16(32, numCh * bits / 8, true);
    v.setUint16(34, bits, true);
    writeStr(36, 'data');
    v.setUint32(40, len * numCh * 2, true);
    var offset = 44;
    for (var i = 0; i < len; i++) {
      for (var ch = 0; ch < numCh; ch++) {
        var s = Math.max(-1, Math.min(1, audioBuffer.getChannelData(ch)[i]));
        v.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
        offset += 2;
      }
    }
    return new Blob([buffer], { type: 'audio/wav' });
  }

  document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
